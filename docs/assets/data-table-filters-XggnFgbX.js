import{j as e}from"./jsx-runtime-D_zvdyIk.js";import{r as c}from"./index-CGj_12n1.js";import{F as O}from"./filter-button-CW_fxkub.js";import{B as M}from"./button-YjhY-NsT.js";import{u as _}from"./i18n-BWHuWJtH.js";import{S as C}from"./skeleton-Shk8p_SP.js";import{u as V}from"./api-CTNwT5mI.js";import{g as z,C as D,a as L,b as E,c as P,d as H}from"./command-DNEJ4r_l.js";import{X as I}from"./x-CubKniSv.js";import{S as $}from"./search-DqA1hdnz.js";import{T as U}from"./test-tube-diagonal-U7YTje3f.js";import{c as R}from"./createLucideIcon-8Lr1oLzj.js";import{U as G}from"./user-CZ8KFWeE.js";import{L as W}from"./list-filter-DyVHreeM.js";/**
 * @license lucide-react v0.482.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M3 5v14",key:"1nt18q"}],["path",{d:"M8 5v14",key:"1ybrkv"}],["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"M17 5v14",key:"ycjyhj"}],["path",{d:"M21 5v14",key:"nzette"}]],J=R("Barcode",X);/**
 * @license lucide-react v0.482.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],A=R("FolderOpen",K);function Q(t){return{case_id:A,patient_id:G,mrn:J,request_id:U}[t.toLowerCase()]||A}async function Y(t,a,o){if(!t||t.length<a)return{};const n=await o(t,"10");return!(n!=null&&n.data)||n.data.length===0?{}:n.data.reduce((r,p)=>(r[p.type]||(r[p.type]=[]),r[p.type].push(p),r),{})}function F({onSelect:t,onClear:a,selectedValue:o,placeholder:n,minSearchLength:l=3,api:r}){const{t:p}=_(),[g,d]=c.useState(""),[h,m]=c.useState(""),[S,y]=c.useState(!1);c.useEffect(()=>{d(o||"")},[o]),c.useEffect(()=>{const i=setTimeout(()=>{m(g)},300);return()=>clearTimeout(i)},[g]);const{data:f}=V(h&&h.length>=l?h:null,i=>i?Y(i,l,r):Promise.resolve({}),{revalidateOnFocus:!1,dedupingInterval:300}),v=c.useCallback((i,x)=>{const b=x.trim();t(i,b),d(b),y(!1)},[t]),N=c.useCallback(()=>{d(""),a==null||a()},[a]),k=f&&Object.keys(f).length>0;return e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium text-foreground h-[14px] mb-[8px]",children:p("case_exploration.filters_group.search_by_id")}),e.jsxs(z,{className:"relative h-8 w-[260px] overflow-visible",shouldFilter:!1,children:[e.jsx(D,{className:"px-[6px]",variant:"search",placeholder:n,leftAddon:e.jsx($,{size:16}),rightAddon:g.length>0&&e.jsx(I,{onClick:N,size:16}),value:g,onValueChange:d,onFocus:()=>{y(!0)},onBlur:()=>setTimeout(()=>y(!1),100)}),S&&g.length>0&&e.jsxs(L,{className:"absolute max-h-[240px] left-0 top-full z-50 mt-1 w-full overflow-auto rounded-md border bg-background shadow-lg",onMouseDown:i=>i.preventDefault(),children:[!k&&e.jsx(E,{children:p("common.table.filters.no_values_found")}),k&&Object.keys(f||{}).map(i=>e.jsxs(e.Fragment,{children:[Object.keys(f||{}).indexOf(i)!==0&&e.jsx("hr",{className:"w-full h-px bg-border"}),e.jsx(P,{heading:e.jsx("span",{className:"h-[28px] &:not(:first-child)]:bg-border",children:p(`common.table.filters.search.${i}`,i.toUpperCase())}),children:((f==null?void 0:f[i])||[]).map(x=>{const b=Q(x.type);return e.jsxs(H,{className:"h-[32px]",value:`${x.value}::${i}`,onSelect:s=>{v(x.type,s.split("::")[0])},children:[e.jsx(b,{size:16,className:"text-muted-foreground"}),e.jsx("span",{children:x.value})]},x.value)})},i)]}))]})]})]})}F.__docgenInfo={description:"",methods:[],displayName:"TableFiltersSearch",props:{placeholder:{required:!1,tsType:{name:"string"},description:""},onSelect:{required:!0,tsType:{name:"signature",type:"function",raw:"(type: string, value: string) => void",signature:{arguments:[{type:{name:"string"},name:"type"},{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},onClear:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},selectedValue:{required:!1,tsType:{name:"string"},description:""},minSearchLength:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"3",computed:!1}},api:{required:!0,tsType:{name:"signature",type:"function",raw:`(
  prefix: string,
  limit?: string,
  options?: RawAxiosRequestConfig,
) => Promise<AxiosResponse<AutocompleteResult[]>>`,signature:{arguments:[{type:{name:"string"},name:"prefix"},{type:{name:"string"},name:"limit"},{type:{name:"RawAxiosRequestConfig"},name:"options"}],return:{name:"Promise",elements:[{name:"AxiosResponse",elements:[{name:"Array",elements:[{name:"AutocompleteResult"}],raw:"AutocompleteResult[]"}],raw:"AxiosResponse<AutocompleteResult[]>"}],raw:"Promise<AxiosResponse<AutocompleteResult[]>>"}}},description:""}}};function xe(t){return t.sort((a,o)=>a.label.localeCompare(o.label))}function ge(t){return Object.keys(t).filter(a=>t[a].visible)}function Z(t,a){const o=[],n=Object.keys(a);for(const l in t)if(t[l].length!==0){if(n.includes(l)){o.push({field:a[l].key,value:t[l]});continue}o.push({field:l,value:t[l]})}return o}function T(t,a){const o={};for(const n in t)Object.keys(a).includes(n)&&(o[n]=t[n]);return o}function B(t,a){for(const o in t)if(!Object.keys(a).includes(o)&&t[o].length>0)return t[o][0]}function ee({filterSearch:t,visibleFilters:a}){return e.jsxs("div",{className:"flex flex-col justify-start gap-2 min-w-[400px] h-[48px]",children:[e.jsx(C,{className:"w-[120px] h-[24px]"}),e.jsxs("div",{className:"flex gap-2 h-[32px]",children:[t&&e.jsx(C,{className:"w-[260px] h-full"}),Object.keys(a).map(o=>e.jsx(C,{className:"w-[100px] h-full"},o)),e.jsx(C,{className:"w-[75px] h-full"})]})]})}function te({loading:t=!1,openFilters:a,setOpenFilters:o,filters:n,setFilters:l,changedFilterButtons:r,setChangedFilterButtons:p,setSearchCriteria:g,filterButtons:d,filterSearch:h,criterias:m,defaultFilters:S}){const{t:y}=_(),f=c.useCallback((s,u)=>{l({...n,[s]:u})},[n,l]),v=c.useMemo(()=>d.filter(s=>!s.isVisible),[d]),N=d.some(s=>s.selectedItems.length>0)||r.length>0,k=()=>{l(S),p([]),o({})},i=c.useCallback(s=>{const u=[...r,...s.filter(j=>!r.includes(j))];p(u);const w=s.reduce((j,q)=>(j[q]=!0,j),{});o({...a,...w})},[]),x=c.useCallback((s,u)=>{l({...T(n,m),[s]:[u]})},[n,l]),b=c.useCallback(()=>{l(T(n,m))},[n,l]);return c.useEffect(()=>{g(Z(n,m))},[n,g]),t?e.jsx(ee,{filterSearch:h,visibleFilters:Object.keys(m).filter(s=>m[s].visible)}):e.jsxs("div",{id:"table-filters",className:"py-0 flex flex-2 flex-wrap gap-2 items-button",children:[h&&e.jsx(F,{onSelect:x,onClear:b,selectedValue:B(n,m),placeholder:h.placeholder,minSearchLength:h.minSearchLength,api:h.api}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-end",children:[d.filter(s=>s.isVisible).sort((s,u)=>{const w=Math.max(...Object.keys(m).map(j=>m[j].weight??-1));return(m[s.key].weight??w+r.indexOf(s.key))-(m[u.key].weight??w+r.indexOf(u.key))}).map(s=>e.jsx(O,{popoverSize:s.popoverSize,label:s.label,options:s.options,selected:s.selectedItems,onSelect:u=>f(s.key,u),isOpen:s.isOpen,withTooltip:s.withTooltip},s.key)),v.length>0&&e.jsx(O,{label:y("common.filters.more","More"),options:v,selected:r,onSelect:i,actionMode:!0,icon:e.jsx(W,{size:16}),placeholder:y("common.table.filters.more_placeholder","Filters"),closeOnSelect:!0}),N&&e.jsxs(M,{variant:"link",onClick:k,className:"text-sm py-2 px-3 h-8",children:[e.jsx(I,{size:14}),y("common.actions.clear","Clear")]})]})]})}te.__docgenInfo={description:`Controlled component

His parent component must manage all different filter states, useState`,methods:[],displayName:"DataTableFilters",props:{loading:{defaultValue:{value:"false",computed:!1},required:!1}}};export{te as D,ge as g,xe as s};
