import{j as e}from"./jsx-runtime-D_zvdyIk.js";import{r as w}from"./index-CGj_12n1.js";import{B as q}from"./button-B42oSzKN.js";import{P as G,a as J,b as K}from"./popover-Dw4ngTBa.js";import{u as k}from"./i18n-CwpHJOIe.js";import{A as z,a as O}from"./avatar-Dzz4Q0xp.js";import{c as v}from"./utils-D-KgF5mV.js";import{c as Q,i as T,a as N,g as P,b as F,d as I}from"./avatar.utils-MvOOLP0y.js";import{U as R}from"./user-CZ8KFWeE.js";import{X as W}from"./x-CubKniSv.js";import{C as Y}from"./checkbox-CuLJw5hI.js";function E(t,s){if(!s.trim())return t;const a=s.toLowerCase();return t.filter(i=>{var r;const o=i.name.toLowerCase().includes(a),l=((r=i.organization)==null?void 0:r.toLowerCase().includes(a))||!1;return o||l})}function M({availableUsers:t,searchTerm:s,selectedUsers:a,defaultUser:i,includeNotAssigned:o=!0,notAssignedName:l="Not assigned"}){const r=Q(l),n=s.toLowerCase(),p=t.filter(u=>{const y=E([u],s).length>0,U=!a.some(A=>A.id===u.id),b=!i||u.id!==i.id;return y&&U&&b}),x=o&&r.name.toLowerCase().includes(n)&&!a.some(u=>u.id===r.id),m=i&&E([i],s).length>0&&!a.some(u=>u.id===i.id),g=[];return x&&g.push(r),m&&g.push(i),g.push(...p),g}function Z({selectedUser:t,currentSelectedUsers:s,isNotAssignedUser:a}){return a?[t]:[...s.filter(o=>!T(o)),t]}function $({user:t,isChecked:s,currentSelectedUsers:a}){return T(t)?s?[t]:[]:s?[...a.filter(l=>!T(l)),t]:a.filter(o=>o.id!==t.id)}function V({selectedUsers:t,onRemoveUser:s,readOnly:a=!1}){const i=N({size:"md",variant:"single"}),o=N({size:"sm",variant:"unassigned"}),l=I("sm");return e.jsx(e.Fragment,{children:t.map(r=>{const n=r.id==="not-assign",p=n?"":P(r),x=n?"":F(r.id),m=n?o:i;return e.jsxs("div",{className:"relative inline-flex items-center text-sm flex-shrink-0",children:[e.jsx("div",{className:v("absolute right-0 top-0.5 bottom-0.5 bg-gray-200 rounded-r-md",n?"left-3":"left-3.5")}),e.jsx("div",{className:"flex items-center z-10",children:e.jsx(z,{className:v(m.container(),"z-20",n&&"bg-background"),children:e.jsx(O,{className:v(m.fallback(),m.text(),!n&&x),children:n?e.jsx(R,{className:l}):p})})}),e.jsxs("div",{className:"inline-flex items-center gap-2 px-2 py-1 h-7 z-10 ml-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-medium text-gray-900",children:r.name}),r.organization&&e.jsx("span",{className:"text-gray-500",children:r.organization})]}),!a&&s&&e.jsx("button",{onClick:()=>s(r),className:"text-gray-400 hover:text-gray-600 ml-1 transition-colors",children:e.jsx(W,{className:"h-4 w-4"})})]})]},r.id)})})}function B({selectedUsers:t}){return t.length===0?null:e.jsx("div",{className:"pt-3 pb-1.5",children:e.jsx("div",{className:"flex flex-wrap items-center gap-2 min-h-9 w-full rounded-md border border-input bg-background pl-3 pr-3 py-2 text-sm shadow-xs",children:e.jsx(V,{selectedUsers:t,readOnly:!0})})})}function D({availableUsers:t,selectedUsers:s,onUsersChange:a,defaultUser:i,placeholder:o,isOpen:l=!0}){const{t:r}=k(),[n,p]=w.useState(""),x=o||r("common.user_selection.search_placeholder"),m=M({availableUsers:t,searchTerm:n,selectedUsers:s,defaultUser:i,includeNotAssigned:!0,notAssignedName:r("common.user_selection.not_assigned")}),g=c=>{const f=Z({selectedUser:c,currentSelectedUsers:s,isNotAssignedUser:T(c)});a(f)},u=()=>{a([]),p("")},y=c=>{a(s.filter(f=>f.id!==c.id))},U=N({size:"md",variant:"single"}),b=N({size:"sm",variant:"unassigned"}),A=I("sm");return l?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pt-3 pb-1.5",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2 min-h-9 w-full rounded-md border border-input bg-background pl-3 pr-3 py-2 text-sm shadow-xs ring-offset-background focus-within:outline-none focus-within:ring-1 focus-within:ring-ring focus-within:ring-offset-0",children:[e.jsx(V,{selectedUsers:s,onRemoveUser:y}),e.jsx("input",{type:"text",value:n,onChange:c=>p(c.target.value),placeholder:s.length===0?x:"",className:"flex-1 min-w-32 bg-transparent border-0 outline-none text-sm placeholder:text-muted-foreground"})]})}),e.jsx("div",{className:"pt-1.5 pb-1.5",children:e.jsx("button",{onClick:s.length>0?u:void 0,disabled:s.length===0,className:v("text-sm underline transition-colors",s.length>0?"text-blue-600 hover:text-blue-800 cursor-pointer":"text-gray-400 cursor-not-allowed"),children:r("common.user_selection.remove_assignment")})}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:m.length===0?e.jsx("div",{className:"py-1.5 text-sm text-muted-foreground text-center",children:r(n?"common.user_selection.no_users_found":"common.user_selection.start_typing_to_search")}):m.map(c=>{const f=c.id==="not-assign",S=f?"":P(c),d=f?"":F(c.id),h=f?b:U;return e.jsxs("button",{onClick:()=>g(c),className:"w-full flex items-center gap-1.5 py-1.5 hover:bg-accent transition-colors text-left",children:[e.jsx("div",{className:"flex items-center justify-center w-7 h-7",children:e.jsx(z,{className:h.container(),children:e.jsx(O,{className:v(h.fallback(),h.text(),!f&&d),children:f?e.jsx(R,{className:A}):S})})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-sm truncate",children:c.name}),c.organization&&e.jsx("span",{className:"text-sm text-muted-foreground truncate",children:c.organization})]})})]},c.id)})})]}):null}function H({availableUsers:t,selectedUsers:s,onUsersChange:a,defaultUser:i,placeholder:o,className:l,isOpen:r=!0,readOnly:n=!1}){return e.jsx("div",{className:v("bg-background border border-border rounded-md shadow-sm px-3",l),children:n?e.jsx(B,{selectedUsers:s,className:l}):e.jsx(D,{availableUsers:t,selectedUsers:s,onUsersChange:a,defaultUser:i,placeholder:o,className:l,isOpen:r})})}B.__docgenInfo={description:"",methods:[],displayName:"ReadOnlyUserSelection",props:{selectedUsers:{required:!0,tsType:{name:"Array",elements:[{name:"AvatarUser"}],raw:"AvatarUser[]"},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};D.__docgenInfo={description:"",methods:[],displayName:"EditableUserSelection",props:{availableUsers:{required:!0,tsType:{name:"Array",elements:[{name:"AvatarUser"}],raw:"AvatarUser[]"},description:""},selectedUsers:{required:!0,tsType:{name:"Array",elements:[{name:"AvatarUser"}],raw:"AvatarUser[]"},description:""},onUsersChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(users: AvatarUser[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"AvatarUser"}],raw:"AvatarUser[]"},name:"users"}],return:{name:"void"}}},description:""},defaultUser:{required:!1,tsType:{name:"AvatarUser"},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},className:{required:!1,tsType:{name:"string"},description:""},isOpen:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}}}};H.__docgenInfo={description:"",methods:[],displayName:"UserSelection",props:{availableUsers:{required:!0,tsType:{name:"Array",elements:[{name:"AvatarUser"}],raw:"AvatarUser[]"},description:""},selectedUsers:{required:!0,tsType:{name:"Array",elements:[{name:"AvatarUser"}],raw:"AvatarUser[]"},description:""},onUsersChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(users: AvatarUser[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"AvatarUser"}],raw:"AvatarUser[]"},name:"users"}],return:{name:"void"}}},description:""},defaultUser:{required:!1,tsType:{name:"AvatarUser"},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},className:{required:!1,tsType:{name:"string"},description:""},isOpen:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},readOnly:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}}}};function ee({availableUsers:t,selectedUsers:s,onUsersChange:a,placeholder:i,triggerText:o,className:l}){const{t:r}=k(),[n,p]=w.useState(!1),x=i||r("common.user_selection.search"),m=o||r("common.user_selection.assignment"),g=u=>{a(u)};return e.jsxs(G,{open:n,onOpenChange:p,children:[e.jsx(J,{asChild:!0,children:e.jsx(q,{variant:"outline",className:l,children:m})}),e.jsx(K,{className:"w-96 p-0",align:"start",children:e.jsx(H,{availableUsers:t,selectedUsers:s,onUsersChange:g,placeholder:x,isOpen:!0})})]})}ee.__docgenInfo={description:"",methods:[],displayName:"UserSelectionPopover",props:{availableUsers:{required:!0,tsType:{name:"Array",elements:[{name:"AvatarUser"}],raw:"AvatarUser[]"},description:""},selectedUsers:{required:!0,tsType:{name:"Array",elements:[{name:"AvatarUser"}],raw:"AvatarUser[]"},description:""},onUsersChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(users: AvatarUser[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"AvatarUser"}],raw:"AvatarUser[]"},name:"users"}],return:{name:"void"}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},triggerText:{required:!1,tsType:{name:"string"},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};function se({availableUsers:t,selectedUsers:s,onUsersChange:a,defaultUser:i,placeholder:o,className:l,isOpen:r=!0}){const{t:n}=k(),[p,x]=w.useState(""),[m,g]=w.useState(s),u=o||n("common.user_selection.search_placeholder");w.useEffect(()=>{g(s)},[s]);const y=M({availableUsers:t,searchTerm:p,selectedUsers:m,defaultUser:i,includeNotAssigned:!0,notAssignedName:n("common.user_selection.not_assigned")}),U=(d,h)=>{const _=$({user:d,isChecked:h,currentSelectedUsers:m});g(_)},b=()=>{a(m)},A=()=>{g([]),x("")},c=N({size:"md",variant:"single"}),f=N({size:"sm",variant:"unassigned"}),S=I("sm");return r?e.jsxs("div",{className:v("bg-background border border-border rounded-md shadow-sm",l),children:[e.jsx("div",{className:"px-3 pt-3 pb-1.5",children:e.jsx("input",{type:"text",value:p,onChange:d=>x(d.target.value),placeholder:u,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring"})}),e.jsx("div",{className:"max-h-60 overflow-y-auto px-3",children:y.length===0?e.jsx("div",{className:"py-1.5 text-sm text-muted-foreground text-center",children:n(p?"common.user_selection.no_users_found":"common.user_selection.start_typing_to_search")}):y.map(d=>{const h=T(d),_=h?"":P(d),X=h?"":F(d.id),C=h?f:c,L=m.some(j=>j.id===d.id);return e.jsxs("div",{className:"w-full flex items-center gap-1.5 py-1.5 hover:bg-accent transition-colors cursor-pointer",onClick:()=>U(d,!L),children:[e.jsx(Y,{checked:L,onCheckedChange:j=>U(d,j),className:"flex-shrink-0",onClick:j=>j.stopPropagation()}),e.jsx("div",{className:"flex items-center justify-center w-7 h-7",children:e.jsx(z,{className:C.container(),children:e.jsx(O,{className:v(C.fallback(),C.text(),!h&&X),children:h?e.jsx(R,{className:S}):_})})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-sm truncate",children:d.name}),d.organization&&e.jsx("span",{className:"text-sm text-muted-foreground truncate",children:d.organization})]})})]},d.id)})}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-3 border-t border-border justify-between",children:[e.jsx(q,{variant:"ghost",size:"sm",onClick:A,children:n("common.user_selection.reset")}),e.jsx(q,{size:"sm",onClick:b,children:n("common.user_selection.filter")})]})]}):null}se.__docgenInfo={description:"",methods:[],displayName:"TableHeaderUserFilter",props:{availableUsers:{required:!0,tsType:{name:"Array",elements:[{name:"AvatarUser"}],raw:"AvatarUser[]"},description:""},selectedUsers:{required:!0,tsType:{name:"Array",elements:[{name:"AvatarUser"}],raw:"AvatarUser[]"},description:""},onUsersChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(users: AvatarUser[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"AvatarUser"}],raw:"AvatarUser[]"},name:"users"}],return:{name:"void"}}},description:""},defaultUser:{required:!1,tsType:{name:"AvatarUser"},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},className:{required:!1,tsType:{name:"string"},description:""},isOpen:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}}}};export{B as R,se as T,H as U,ee as a};
