import{a as $t,H as re,O as oe,B as G,I as ie,M as ae,b as ce,C as ue,A as le}from"./api-Cc0Ib07E.js";import{r as T,R as yt}from"./index-DQLiH3RP.js";import{s as fe}from"./index-BjfAAjgr.js";class de{constructor(e={}){var n;this.apiKey=e.apiKey,this.username=e.username,this.password=e.password,this.accessToken=e.accessToken,this.basePath=e.basePath,this.serverIndex=e.serverIndex,this.baseOptions={...e.baseOptions,headers:{...(n=e.baseOptions)==null?void 0:n.headers}},this.formDataCtor=e.formDataCtor}isJsonMime(e){const n=new RegExp("^(application/json|[^;/ 	]+/[^;/ 	]+[+]json)[ 	]*(;.*)?$","i");return e!==null&&(n.test(e)||e.toLowerCase()==="application/json-patch+json")}}const M=$t.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});let tt=null;M.interceptors.response.use(t=>t,async t=>{const e=t.config;if(tt)return await tt,M(e);if(t.response.status===re.Unauthorized&&!e._retry){e._retry=!0;try{return tt=$t.post("/auth/refresh-token").finally(()=>{tt=null}),await tt,M(e)}catch(n){return window.location.href="/auth/logout",Promise.reject(n)}}return Promise.reject(t)});const Y=new de({basePath:"/api"});new ce(Y,G,M);const Be=new oe(Y,G,M),Ke=new ie(Y,G,M),ze=new ae(Y,G,M);new ue(Y,G,M);new le(Y,G,M);const Bt=0,Kt=1,zt=2,Wt=3;var Ut=Object.prototype.hasOwnProperty;function gt(t,e){var n,s;if(t===e)return!0;if(t&&e&&(n=t.constructor)===e.constructor){if(n===Date)return t.getTime()===e.getTime();if(n===RegExp)return t.toString()===e.toString();if(n===Array){if((s=t.length)===e.length)for(;s--&&gt(t[s],e[s]););return s===-1}if(!n||typeof t=="object"){s=0;for(n in t)if(Ut.call(t,n)&&++s&&!Ut.call(e,n)||!(n in e)||!gt(t[n],e[n]))return!1;return Object.keys(e).length===s}}return t!==t&&e!==e}const F=new WeakMap,U=()=>{},_=U(),Ot=Object,i=t=>t===_,N=t=>typeof t=="function",q=(t,e)=>({...t,...e}),Jt=t=>N(t.then),pt={},at={},At="undefined",nt=typeof window!=At,vt=typeof document!=At,pe=nt&&"Deno"in window,he=()=>nt&&typeof window.requestAnimationFrame!=At,Gt=(t,e)=>{const n=F.get(t);return[()=>!i(e)&&t.get(e)||pt,s=>{if(!i(e)){const a=t.get(e);e in at||(at[e]=a),n[5](e,q(a,s),a||pt)}},n[6],()=>!i(e)&&e in at?at[e]:!i(e)&&t.get(e)||pt]};let Tt=!0;const Ee=()=>Tt,[St,Ct]=nt&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[U,U],we=()=>{const t=vt&&document.visibilityState;return i(t)||t!=="hidden"},Re=t=>(vt&&document.addEventListener("visibilitychange",t),St("focus",t),()=>{vt&&document.removeEventListener("visibilitychange",t),Ct("focus",t)}),me=t=>{const e=()=>{Tt=!0,t()},n=()=>{Tt=!1};return St("online",e),St("offline",n),()=>{Ct("online",e),Ct("offline",n)}},ge={isOnline:Ee,isVisible:we},Oe={initFocus:Re,initReconnect:me},qt=!yt.useId,et=!nt||pe,ve=t=>he()?window.requestAnimationFrame(t):setTimeout(t,1),ht=et?T.useEffect:T.useLayoutEffect,Et=typeof navigator<"u"&&navigator.connection,Ht=!et&&Et&&(["slow-2g","2g"].includes(Et.effectiveType)||Et.saveData),ct=new WeakMap,Te=t=>Ot.prototype.toString.call(t),wt=(t,e)=>t===`[object ${e}]`;let Se=0;const Dt=t=>{const e=typeof t,n=Te(t),s=wt(n,"Date"),a=wt(n,"RegExp"),c=wt(n,"Object");let o,u;if(Ot(t)===t&&!s&&!a){if(o=ct.get(t),o)return o;if(o=++Se+"~",ct.set(t,o),Array.isArray(t)){for(o="@",u=0;u<t.length;u++)o+=Dt(t[u])+",";ct.set(t,o)}if(c){o="#";const p=Ot.keys(t).sort();for(;!i(u=p.pop());)i(t[u])||(o+=u+":"+Dt(t[u])+",");ct.set(t,o)}}else o=s?t.toJSON():e=="symbol"?t.toString():e=="string"?JSON.stringify(t):""+t;return o},bt=t=>{if(N(t))try{t=t()}catch{t=""}const e=t;return t=typeof t=="string"?t:(Array.isArray(t)?t.length:t)?Dt(t):"",[t,e]};let Ce=0;const _t=()=>++Ce;async function Yt(...t){const[e,n,s,a]=t,c=q({populateCache:!0,throwOnError:!0},typeof a=="boolean"?{revalidate:a}:a||{});let o=c.populateCache;const u=c.rollbackOnError;let p=c.optimisticData;const A=S=>typeof u=="function"?u(S):u!==!1,g=c.throwOnError;if(N(n)){const S=n,E=[],I=e.keys();for(const w of I)!/^\$(inf|sub)\$/.test(w)&&S(e.get(w)._k)&&E.push(w);return Promise.all(E.map(R))}return R(n);async function R(S){const[E]=bt(S);if(!E)return;const[I,w]=Gt(e,E),[ut,r,st,X]=F.get(e),W=()=>{const C=ut[E];return(N(c.revalidate)?c.revalidate(I().data,S):c.revalidate!==!1)&&(delete st[E],delete X[E],C&&C[0])?C[0](zt).then(()=>I().data):I().data};if(t.length<3)return W();let O=s,P,L=!1;const d=_t();r[E]=[d,0];const $=!i(p),V=I(),B=V.data,rt=V._c,H=i(rt)?B:rt;if($&&(p=N(p)?p(H,B):p,w({data:p,_c:H})),N(O))try{O=O(H)}catch(C){P=C,L=!0}if(O&&Jt(O))if(O=await O.catch(C=>{P=C,L=!0}),d!==r[E][0]){if(L)throw P;return O}else L&&$&&A(P)&&(o=!0,w({data:H,_c:_}));if(o&&!L)if(N(o)){const C=o(O,H);w({data:C,error:_,_c:_})}else w({data:O,error:_,_c:_});if(r[E][1]=_t(),Promise.resolve(W()).then(()=>{w({_c:_})}),L){if(g)throw P;return}return O}}const kt=(t,e)=>{for(const n in t)t[n][0]&&t[n][0](e)},De=(t,e)=>{if(!F.has(t)){const n=q(Oe,e),s=Object.create(null),a=Yt.bind(_,t);let c=U;const o=Object.create(null),u=(g,R)=>{const S=o[g]||[];return o[g]=S,S.push(R),()=>S.splice(S.indexOf(R),1)},p=(g,R,S)=>{t.set(g,R);const E=o[g];if(E)for(const I of E)I(R,S)},A=()=>{if(!F.has(t)&&(F.set(t,[s,Object.create(null),Object.create(null),Object.create(null),a,p,u]),!et)){const g=n.initFocus(setTimeout.bind(_,kt.bind(_,s,Bt))),R=n.initReconnect(setTimeout.bind(_,kt.bind(_,s,Kt)));c=()=>{g&&g(),R&&R(),F.delete(t)}}};return A(),[t,a,A,c]}return[t,F.get(t)[4]]},_e=(t,e,n,s,a)=>{const c=n.errorRetryCount,o=a.retryCount,u=~~((Math.random()+.5)*(1<<(o<8?o:8)))*n.errorRetryInterval;!i(c)&&o>c||setTimeout(s,u,a)},ye=gt,[Xt,Ae]=De(new Map),be=q({onLoadingSlow:U,onSuccess:U,onError:U,onErrorRetry:_e,onDiscarded:U,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:Ht?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:Ht?5e3:3e3,compare:ye,isPaused:()=>!1,cache:Xt,mutate:Ae,fallback:{}},ge),Ie=(t,e)=>{const n=q(t,e);if(e){const{use:s,fallback:a}=t,{use:c,fallback:o}=e;s&&c&&(n.use=s.concat(c)),a&&o&&(n.fallback=q(a,o))}return n},Le=T.createContext({}),Ve="$inf$",Qt=nt&&window.__SWR_DEVTOOLS_USE__,Ne=Qt?window.__SWR_DEVTOOLS_USE__:[],Pe=()=>{Qt&&(window.__SWR_DEVTOOLS_REACT__=yt)},Zt=t=>N(t[1])?[t[0],t[1],t[2]||{}]:[t[0],null,(t[1]===null?t[2]:t[1])||{}],je=()=>q(be,T.useContext(Le)),xe=t=>(e,n,s)=>t(e,n&&((...c)=>{const[o]=bt(e),[,,,u]=F.get(Xt);if(o.startsWith(Ve))return n(...c);const p=u[o];return i(p)?n(...c):(delete u[o],p)}),s),Fe=Ne.concat(xe),Me=t=>function(...n){const s=je(),[a,c,o]=Zt(n),u=Ie(s,o);let p=t;const{use:A}=u,g=(A||[]).concat(Fe);for(let R=g.length;R--;)p=g[R](p);return p(a,c||u.fetcher||null,u)},We=(t,e,n)=>{const s=e[t]||(e[t]=[]);return s.push(n),()=>{const a=s.indexOf(n);a>=0&&(s[a]=s[s.length-1],s.pop())}},Je=(t,e)=>(...n)=>{const[s,a,c]=Zt(n),o=(c.use||[]).concat(e);return t(s,a,{...c,use:o})};Pe();const Rt=yt.use||(t=>{switch(t.status){case"pending":throw t;case"fulfilled":return t.value;case"rejected":throw t.reason;default:throw t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t}}),mt={dedupe:!0},Ue=(t,e,n)=>{const{cache:s,compare:a,suspense:c,fallbackData:o,revalidateOnMount:u,revalidateIfStale:p,refreshInterval:A,refreshWhenHidden:g,refreshWhenOffline:R,keepPreviousData:S}=n,[E,I,w,ut]=F.get(s),[r,st]=bt(t),X=T.useRef(!1),W=T.useRef(!1),O=T.useRef(r),P=T.useRef(e),L=T.useRef(n),d=()=>L.current,$=()=>d().isVisible()&&d().isOnline(),[V,B,rt,H]=Gt(s,r),C=T.useRef({}).current,Q=i(o)?i(n.fallback)?_:n.fallback[r]:o,It=(f,l)=>{for(const v in C){const h=v;if(h==="data"){if(!a(f[h],l[h])&&(!i(f[h])||!a(it,l[h])))return!1}else if(l[h]!==f[h])return!1}return!0},Lt=T.useMemo(()=>{const f=!r||!e?!1:i(u)?d().isPaused()||c?!1:p!==!1:u,l=D=>{const j=q(D);return delete j._k,f?{isValidating:!0,isLoading:!0,...j}:j},v=V(),h=H(),b=l(v),J=v===h?b:l(h);let m=b;return[()=>{const D=l(V());return It(D,m)?(m.data=D.data,m.isLoading=D.isLoading,m.isValidating=D.isValidating,m.error=D.error,m):(m=D,D)},()=>J]},[s,r]),K=fe.useSyncExternalStore(T.useCallback(f=>rt(r,(l,v)=>{It(v,l)||f()}),[s,r]),Lt[0],Lt[1]),Vt=!X.current,te=E[r]&&E[r].length>0,z=K.data,k=i(z)?Q&&Jt(Q)?Rt(Q):Q:z,ot=K.error,lt=T.useRef(k),it=S?i(z)?i(lt.current)?k:lt.current:z:k,Nt=te&&!i(ot)?!1:Vt&&!i(u)?u:d().isPaused()?!1:c?i(k)?!1:p:i(k)||p,Pt=!!(r&&e&&Vt&&Nt),ee=i(K.isValidating)?Pt:K.isValidating,ne=i(K.isLoading)?Pt:K.isLoading,Z=T.useCallback(async f=>{const l=P.current;if(!r||!l||W.current||d().isPaused())return!1;let v,h,b=!0;const J=f||{},m=!w[r]||!J.dedupe,D=()=>qt?!W.current&&r===O.current&&X.current:r===O.current,j={isValidating:!1,isLoading:!1},xt=()=>{B(j)},Ft=()=>{const y=w[r];y&&y[1]===h&&delete w[r]},Mt={isValidating:!0};i(V().data)&&(Mt.isLoading=!0);try{if(m&&(B(Mt),n.loadingTimeout&&i(V().data)&&setTimeout(()=>{b&&D()&&d().onLoadingSlow(r,n)},n.loadingTimeout),w[r]=[l(st),_t()]),[v,h]=w[r],v=await v,m&&setTimeout(Ft,n.dedupingInterval),!w[r]||w[r][1]!==h)return m&&D()&&d().onDiscarded(r),!1;j.error=_;const y=I[r];if(!i(y)&&(h<=y[0]||h<=y[1]||y[1]===0))return xt(),m&&D()&&d().onDiscarded(r),!1;const x=V().data;j.data=a(x,v)?x:v,m&&D()&&d().onSuccess(v,r,n)}catch(y){Ft();const x=d(),{shouldRetryOnError:ft}=x;x.isPaused()||(j.error=y,m&&D()&&(x.onError(y,r,x),(ft===!0||N(ft)&&ft(y))&&(!d().revalidateOnFocus||!d().revalidateOnReconnect||$())&&x.onErrorRetry(y,r,x,se=>{const dt=E[r];dt&&dt[0]&&dt[0](Wt,se)},{retryCount:(J.retryCount||0)+1,dedupe:!0})))}return b=!1,xt(),!0},[r,s]),jt=T.useCallback((...f)=>Yt(s,O.current,...f),[]);if(ht(()=>{P.current=e,L.current=n,i(z)||(lt.current=z)}),ht(()=>{if(!r)return;const f=Z.bind(_,mt);let l=0;d().revalidateOnFocus&&(l=Date.now()+d().focusThrottleInterval);const h=We(r,E,(b,J={})=>{if(b==Bt){const m=Date.now();d().revalidateOnFocus&&m>l&&$()&&(l=m+d().focusThrottleInterval,f())}else if(b==Kt)d().revalidateOnReconnect&&$()&&f();else{if(b==zt)return Z();if(b==Wt)return Z(J)}});return W.current=!1,O.current=r,X.current=!0,B({_k:st}),Nt&&(w[r]||(i(k)||et?f():ve(f))),()=>{W.current=!0,h()}},[r]),ht(()=>{let f;function l(){const h=N(A)?A(V().data):A;h&&f!==-1&&(f=setTimeout(v,h))}function v(){!V().error&&(g||d().isVisible())&&(R||d().isOnline())?Z(mt).then(l):l()}return l(),()=>{f&&(clearTimeout(f),f=-1)}},[A,g,R,r]),T.useDebugValue(it),c&&i(k)&&r){if(!qt&&et)throw new Error("Fallback data is required when using Suspense in SSR.");P.current=e,L.current=n,W.current=!1;const f=ut[r];if(!i(f)){const l=jt(f);Rt(l)}if(i(ot)){const l=Z(mt);i(it)||(l.status="fulfilled",l.value=!0),Rt(l)}else throw ot}return{mutate:jt,get data(){return C.data=!0,it},get error(){return C.error=!0,ot},get isValidating(){return C.isValidating=!0,ee},get isLoading(){return C.isLoading=!0,ne}}},Ge=Me(Ue);export{qt as I,_ as U,je as a,q as b,ht as c,_t as g,Ke as i,ze as m,Be as o,bt as s,Ge as u,Je as w};
