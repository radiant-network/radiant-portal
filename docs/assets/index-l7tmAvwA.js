import{r,a as M}from"./index-CGj_12n1.js";import{b as p,u as x}from"./index-CDVHwwC2.js";import{u as T,P as m,d as U}from"./index-COcwYKbe.js";import{j as b}from"./jsx-runtime-D_zvdyIk.js";import{I as j}from"./index-D8dqFcAi.js";function P(t){const e=r.useRef(t);return r.useEffect(()=>{e.current=t}),r.useMemo(()=>(...n)=>{var s;return(s=e.current)==null?void 0:s.call(e,...n)},[])}function z(t,e=globalThis==null?void 0:globalThis.document){const n=P(t);r.useEffect(()=>{const s=i=>{i.key==="Escape"&&n(i)};return e.addEventListener("keydown",s,{capture:!0}),()=>e.removeEventListener("keydown",s,{capture:!0})},[n,e])}var H="DismissableLayer",h="dismissableLayer.update",K="dismissableLayer.pointerDownOutside",X="dismissableLayer.focusOutside",R,S=r.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Y=r.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:o,onInteractOutside:l,onDismiss:c,...E}=t,u=r.useContext(S),[d,I]=r.useState(null),f=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,A]=r.useState({}),N=T(e,a=>I(a)),L=Array.from(u.layers),[F]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),W=L.indexOf(F),D=d?L.indexOf(d):-1,_=u.layersWithOutsidePointerEventsDisabled.size>0,C=D>=W,k=G(a=>{const v=a.target,g=[...u.branches].some(y=>y.contains(v));!C||g||(i==null||i(a),l==null||l(a),a.defaultPrevented||c==null||c())},f),O=J(a=>{const v=a.target;[...u.branches].some(y=>y.contains(v))||(o==null||o(a),l==null||l(a),a.defaultPrevented||c==null||c())},f);return z(a=>{D===u.layers.size-1&&(s==null||s(a),!a.defaultPrevented&&c&&(a.preventDefault(),c()))},f),r.useEffect(()=>{if(d)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(R=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),w(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=R)}},[d,f,n,u]),r.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),w())},[d,u]),r.useEffect(()=>{const a=()=>A({});return document.addEventListener(h,a),()=>document.removeEventListener(h,a)},[]),b.jsx(m.div,{...E,ref:N,style:{pointerEvents:_?C?"auto":"none":void 0,...t.style},onFocusCapture:p(t.onFocusCapture,O.onFocusCapture),onBlurCapture:p(t.onBlurCapture,O.onBlurCapture),onPointerDownCapture:p(t.onPointerDownCapture,k.onPointerDownCapture)})});Y.displayName=H;var $="DismissableLayerBranch",q=r.forwardRef((t,e)=>{const n=r.useContext(S),s=r.useRef(null),i=T(e,s);return r.useEffect(()=>{const o=s.current;if(o)return n.branches.add(o),()=>{n.branches.delete(o)}},[n.branches]),b.jsx(m.div,{...t,ref:i})});q.displayName=$;function G(t,e=globalThis==null?void 0:globalThis.document){const n=P(t),s=r.useRef(!1),i=r.useRef(()=>{});return r.useEffect(()=>{const o=c=>{if(c.target&&!s.current){let E=function(){B(K,n,u,{discrete:!0})};const u={originalEvent:c};c.pointerType==="touch"?(e.removeEventListener("click",i.current),i.current=E,e.addEventListener("click",i.current,{once:!0})):E()}else e.removeEventListener("click",i.current);s.current=!1},l=window.setTimeout(()=>{e.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(l),e.removeEventListener("pointerdown",o),e.removeEventListener("click",i.current)}},[e,n]),{onPointerDownCapture:()=>s.current=!0}}function J(t,e=globalThis==null?void 0:globalThis.document){const n=P(t),s=r.useRef(!1);return r.useEffect(()=>{const i=o=>{o.target&&!s.current&&B(X,n,{originalEvent:o},{discrete:!1})};return e.addEventListener("focusin",i),()=>e.removeEventListener("focusin",i)},[e,n]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function w(){const t=new CustomEvent(h);document.dispatchEvent(t)}function B(t,e,n,{discrete:s}){const i=n.originalEvent.target,o=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&i.addEventListener(t,e,{once:!0}),s?U(i,o):i.dispatchEvent(o)}var Q=M[" useId ".trim().toString()]||(()=>{}),V=0;function oe(t){const[e,n]=r.useState(Q());return x(()=>{n(s=>s??String(V++))},[t]),t||(e?`radix-${e}`:"")}var Z="Portal",ee=r.forwardRef((t,e)=>{var c;const{container:n,...s}=t,[i,o]=r.useState(!1);x(()=>o(!0),[]);const l=n||i&&((c=globalThis==null?void 0:globalThis.document)==null?void 0:c.body);return l?j.createPortal(b.jsx(m.div,{...s,ref:e}),l):null});ee.displayName=Z;export{Y as D,ee as P,P as a,oe as u};
