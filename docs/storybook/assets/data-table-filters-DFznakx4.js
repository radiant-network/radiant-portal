import{j as t}from"./jsx-runtime-D_zvdyIk.js";import{r as p}from"./index-CBYaBgW8.js";import{F as _}from"./filter-button-7TsQ2haC.js";import{B as q}from"./button-B0Pz0h6o.js";import{S}from"./skeleton-_T1otFf0.js";import{u as F}from"./i18n-HQ9sDiZt.js";import{u as V}from"./api-BDSYu6L5.js";import{g as z,C as D,a as L,b as E,c as P,d as $}from"./command-DmEuOwQM.js";import{X as I}from"./x-4HkHZ1eq.js";import{S as H}from"./search-DKmUqS9g.js";import{T as U}from"./test-tube-diagonal-Dy9u_yEx.js";import{c as O}from"./createLucideIcon-B119WVF5.js";import{U as G}from"./user-3oWHM7_v.js";/**
 * @license lucide-react v0.482.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M3 5v14",key:"1nt18q"}],["path",{d:"M8 5v14",key:"1ybrkv"}],["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"M17 5v14",key:"ycjyhj"}],["path",{d:"M21 5v14",key:"nzette"}]],K=O("Barcode",W);/**
 * @license lucide-react v0.482.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],T=O("FolderOpen",X);/**
 * @license lucide-react v0.482.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M7 12h10",key:"b7w52i"}],["path",{d:"M10 18h4",key:"1ulq68"}]],Q=O("ListFilter",J);function Y(e){return{case_id:T,patient_id:G,submitter_patient_id:K,sequencing_experiment_id:U}[e.toLowerCase()]||T}async function Z(e,a,n){if(!e||e.length<a)return{};const o=await n(e,"10");return!(o!=null&&o.data)||o.data.length===0?{}:o.data.reduce((r,c)=>(r[c.type]||(r[c.type]=[]),r[c.type].push(c),r),{})}function M({onSelect:e,onClear:a,selectedValue:n,placeholder:o,minSearchLength:l=3,api:r}){const{t:c}=F(),[d,m]=p.useState(""),[f,u]=p.useState(""),[C,y]=p.useState(!1);p.useEffect(()=>{m(n||"")},[n]),p.useEffect(()=>{const i=setTimeout(()=>{u(d)},300);return()=>clearTimeout(i)},[d]);const{data:x}=V(f&&f.length>=l?f:null,i=>i?Z(i,l,r):Promise.resolve({}),{revalidateOnFocus:!1,dedupingInterval:300}),k=p.useCallback((i,g)=>{const b=g.trim();e(i,b),m(b),y(!1)},[e]),N=p.useCallback(()=>{m(""),a==null||a()},[a]),v=x&&Object.keys(x).length>0;return t.jsxs("div",{className:"flex flex-col",children:[t.jsx("label",{className:"text-sm font-medium text-foreground h-[14px] mb-2",children:c("case_exploration.filters_group.search_by_id")}),t.jsxs(z,{className:"relative h-8 w-[340px] overflow-visible",shouldFilter:!1,children:[t.jsx(D,{className:"px-1.5",variant:"search",placeholder:o,leftAddon:t.jsx(H,{size:16}),rightAddon:d.length>0&&t.jsx(I,{onClick:N,size:16}),value:d,onValueChange:m,onFocus:()=>{y(!0)},onBlur:()=>setTimeout(()=>y(!1),100)}),C&&d.length>0&&t.jsxs(L,{className:"absolute max-h-[240px] left-0 top-full z-50 mt-1 w-full overflow-auto rounded-md border bg-background shadow-lg",onMouseDown:i=>i.preventDefault(),children:[!v&&t.jsx(E,{children:c("common.table.filters.no_values_found")}),v&&Object.keys(x||{}).map(i=>t.jsxs(t.Fragment,{children:[Object.keys(x||{}).indexOf(i)!==0&&t.jsx("hr",{className:"w-full h-px bg-border"}),t.jsx(P,{heading:t.jsx("span",{className:"h-[28px] &:not(:first-child)]:bg-border",children:c(`common.table.filters.search.${i}`,i.toUpperCase())}),children:((x==null?void 0:x[i])||[]).map(g=>{const b=Y(g.type);return t.jsxs($,{className:"h-[32px]",value:`${g.value}::${i}`,onSelect:s=>{k(g.type,s.split("::")[0])},children:[t.jsx(b,{size:16,className:"text-muted-foreground"}),t.jsx("span",{children:g.value})]},g.value)})},i)]}))]})]})]})}M.__docgenInfo={description:"",methods:[],displayName:"TableFiltersSearch",props:{placeholder:{required:!1,tsType:{name:"string"},description:""},onSelect:{required:!0,tsType:{name:"signature",type:"function",raw:"(type: string, value: string) => void",signature:{arguments:[{type:{name:"string"},name:"type"},{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},onClear:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},selectedValue:{required:!1,tsType:{name:"string"},description:""},minSearchLength:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"3",computed:!1}},api:{required:!0,tsType:{name:"signature",type:"function",raw:`(
  prefix: string,
  limit?: string,
  options?: RawAxiosRequestConfig,
) => Promise<AxiosResponse<AutocompleteResult[]>>`,signature:{arguments:[{type:{name:"string"},name:"prefix"},{type:{name:"string"},name:"limit"},{type:{name:"RawAxiosRequestConfig"},name:"options"}],return:{name:"Promise",elements:[{name:"AxiosResponse",elements:[{name:"Array",elements:[{name:"AutocompleteResult"}],raw:"AutocompleteResult[]"}],raw:"AxiosResponse<AutocompleteResult[]>"}],raw:"Promise<AxiosResponse<AutocompleteResult[]>>"}}},description:""}}};function ge(e){return e.sort((a,n)=>a.label.localeCompare(n.label))}function B(e,a){return(a||Object.keys(e)).sort((o,l)=>{var d,m;const r=((d=e[o])==null?void 0:d.weight)||999,c=((m=e[l])==null?void 0:m.weight)||999;return r-c})}function ye(e){const a=Object.keys(e).filter(n=>e[n].visible);return B(e,a)}function ee(e,a){const n=[],o=Object.keys(a);for(const l in e)if(e[l].length!==0){if(o.includes(l)){n.push({field:a[l].key,value:e[l]});continue}n.push({field:l,value:e[l]})}return n}function A(e,a){const n={};for(const o in e)Object.keys(a).includes(o)&&(n[o]=e[o]);return n}function te(e,a){for(const n in e)if(!Object.keys(a).includes(n)&&e[n].length>0)return e[n][0]}function se({filterSearch:e,visibleFilters:a}){return t.jsxs("div",{className:"flex flex-col justify-start gap-2 min-w-[400px] h-[48px]",children:[t.jsx(S,{className:"w-[120px] h-[24px]"}),t.jsxs("div",{className:"flex gap-2 h-[32px]",children:[e&&t.jsx(S,{className:"w-[260px] h-full"}),Object.keys(a).map(n=>t.jsx(S,{className:"w-[100px] h-full"},n)),t.jsx(S,{className:"w-[75px] h-full"})]})]})}function ne({loading:e=!1,openFilters:a,setOpenFilters:n,filters:o,setFilters:l,changedFilterButtons:r,setChangedFilterButtons:c,setSearchCriteria:d,filterButtons:m,filterSearch:f,criterias:u,defaultFilters:C}){const{t:y}=F(),x=p.useCallback((s,h)=>{l({...o,[s]:h})},[o,l]),k=p.useMemo(()=>m.filter(s=>!s.isVisible),[m]),N=m.some(s=>s.selectedItems.length>0)||r.length>0,v=()=>{l(C),c([]),n({})},i=p.useCallback(s=>{const h=[...r,...s.filter(j=>!r.includes(j))];c(h);const w=s.reduce((j,R)=>(j[R]=!0,j),{});n({...a,...w})},[]),g=p.useCallback((s,h)=>{l({...A(o,u),[s]:[h]})},[o,l]),b=p.useCallback(()=>{l(A(o,u))},[o,l]);return p.useEffect(()=>{d(ee(o,u))},[o,d]),e?t.jsx(se,{filterSearch:f,visibleFilters:Object.keys(u).filter(s=>u[s].visible)}):t.jsxs("div",{id:"table-filters",className:"py-0 flex flex-2 flex-wrap gap-2 items-button",children:[f&&t.jsx(M,{onSelect:g,onClear:b,selectedValue:te(o,u),placeholder:f.placeholder,minSearchLength:f.minSearchLength,api:f.api}),t.jsxs("div",{className:"flex flex-wrap gap-2 items-end",children:[m.filter(s=>s.isVisible).sort((s,h)=>{const w=Math.max(...Object.keys(u).map(j=>u[j].weight??-1));return(u[s.key].weight??w+r.indexOf(s.key))-(u[h.key].weight??w+r.indexOf(h.key))}).map(s=>t.jsx(_,{popoverSize:s.popoverSize,label:s.label,options:s.options,selected:s.selectedItems,onSelect:h=>x(s.key,h),isOpen:s.isOpen,withTooltip:s.withTooltip},s.key)),k.length>0&&t.jsx(_,{label:y("common.filters.more","More"),options:k,selected:r,onSelect:i,actionMode:!0,icon:t.jsx(Q,{size:16}),placeholder:y("common.table.filters.more_placeholder","Filters"),closeOnSelect:!0}),N&&t.jsxs(q,{variant:"link",onClick:v,className:"text-sm py-2 px-3 h-8",children:[t.jsx(I,{size:14}),y("common.actions.clear","Clear")]})]})]})}ne.__docgenInfo={description:`Controlled component

His parent component must manage all different filter states, useState`,methods:[],displayName:"DataTableFilters",props:{loading:{defaultValue:{value:"false",computed:!1},required:!1}}};export{ne as D,ye as a,B as g,ge as s};
