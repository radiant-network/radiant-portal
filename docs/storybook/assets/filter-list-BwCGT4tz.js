import{j as e}from"./jsx-runtime-D_zvdyIk.js";import{R as be,r as a}from"./index-CGj_12n1.js";import{A as Ze,a as et,b as tt,c as st}from"./accordion-DPra3b9Q.js";import{B as C}from"./button-B_6omy5R.js";import{d as _e,e as je,C as nt,a as rt}from"./card-CVaWHAcA.js";import{T as ot,a as at,b as lt}from"./tooltip-anNhU4TT.js";import{A as it}from"./action-button-DglMD9AQ.js";import"./button.variants-Du9eY_ux.js";import{C as ct}from"./checkbox-filter-CLNLTy1D.js";import{I as W}from"./input-Dm5winle.js";import{L as le}from"./label-ymyzYynk.js";import{S as dt}from"./separator-IJKoE26K.js";import{S as K}from"./skeleton-Shk8p_SP.js";import{S as ut}from"./switch-Eyi4i66A.js";import{u as q}from"./i18n-BG1BsVG2.js";import{q as j,D as Se}from"./query-builder-remote-BtE0apCE.js";import{M as L,T as H,R}from"./sqon-roF4SsTV.js";import{A as ie}from"./applications-config-DwuB3Ut-.js";import{u as Ne,o as X}from"./api-Cqt9YNyl.js";import{S as mt}from"./search-DqA1hdnz.js";import{E as pt,L as ft,G as ht,a as xt,b as yt,c as vt}from"./less-than-or-equal-operator-icon-BI5aNTvi.js";import{c as gt}from"./index-C66Dxnp2.js";import{C as kt}from"./checkbox-CuLJw5hI.js";import{d as he,S as xe,a as ye,b as ve,c as ge}from"./select-WOQZTtP8.js";import{a as bt,c as Re,b as ae}from"./index-CcLUv2_A.js";import{P as Z,u as ce}from"./index-B7CJuYpG.js";import{i as we,R as _t,I as jt,C as St}from"./dropdown-menu-CxUCUeqn.js";import{u as Nt}from"./index-C8qycyLa.js";import{u as Rt}from"./index-A6VgBoaw.js";import{u as wt}from"./index-qxuqJ0RB.js";import{P as It}from"./index-CRLeYu_h.js";import{c as Ie}from"./utils-D-KgF5mV.js";const Ee=be.createContext({caseId:"1",seqId:"1"}),Et=t=>{switch(t){case ie.cnv_occurrence:return s=>X.aggregateGermlineCNVOccurrences(s.caseId,s.seqId,s.aggregationBody).then(n=>n.data);default:return s=>X.aggregateGermlineSNVOccurrences(s.caseId,s.seqId,s.aggregationBody,s.withDictionary).then(n=>n.data)}};function At(t,s=30,n=!1,d=!1,u){let r;const{caseId:f,seqId:l}=be.useContext(Ee);n?r={caseId:f,seqId:l,aggregationBody:{field:t,size:s},withDictionary:d}:r=null;const x=j.getResolvedActiveQuery(u);return x&&r&&(r.aggregationBody.sqon={content:x.content,op:x.op}),Ne(r,Et(u),{revalidateOnFocus:!1})}function Ct(t,s){const n=t.toLowerCase().split(/\s+/).filter(Boolean);return s.filter(d=>{const u=d.key.toLowerCase(),r=d.label.toLowerCase();function f(l,x){let k=0;for(const p of x){const c=l.indexOf(p,k);if(c===-1)return!1;k=c+p.length}return!0}return f(u,n)||f(r,n)})}function oe(t,s){return s<t?s:t}function Tt(t,s){return!!(j.getResolvedActiveQuery(t).content.find(d=>d.content.field===s.key)&&s.withDictionary)}function Ae({field:t,maxVisibleItems:s=5}){const{t:n,sanitize:d,lazyTranslate:u}=q(),{appId:r,clearUnappliedFilters:f}=pe(),l=Ke(r),[x,k]=a.useState(Tt(r,t)),{data:p,isLoading:c}=At(t.key,void 0,!0,x,r),g=()=>{try{const b=sessionStorage.getItem(l);if(b){const N=JSON.parse(b);if(Object.prototype.hasOwnProperty.call(N,t.key)){const T=N[t.key];return console.error(`[${t.key}] Found in sessionStorage:`,T),T}}}catch(b){console.warn(`Failed to read filter state from sessionStorage for ${t.key}:`,b)}const o=j.getResolvedActiveQuery(r).content.find(b=>b.content.field===t.key);return(o==null?void 0:o.content.value)||[]},[h,y]=a.useState(p||[]),[m,_]=a.useState(g()),[A,I]=a.useState(oe(h.length,s)),[F,w]=a.useState(!1),[$,V]=a.useState(!1),[S,v]=a.useState(()=>{const o=j.getResolvedActiveQuery(r);return JSON.stringify(o)}),[B,z]=a.useState(()=>{try{const o=sessionStorage.getItem(l);if(o){const i=JSON.parse(o);return Object.prototype.hasOwnProperty.call(i,t.key)}}catch(o){console.warn(`Failed to check sessionStorage state for ${t.key}:`,o)}return!1});a.useEffect(()=>{const o=j.getResolvedActiveQuery(r),i=JSON.stringify(o);if(S&&S!==i){f();const b=j.getResolvedActiveQuery(r).content.find(T=>T.content.field===t.key),N=(b==null?void 0:b.content.value)||[];_(N)}v(i)},[r,t.key,f,S]),a.useEffect(()=>{const o=j.getResolvedActiveQuery(r).content.find(N=>N.content.field===t.key),i=(o==null?void 0:o.content.value)||[],b=JSON.stringify([...m].sort())!==JSON.stringify([...i].sort());w(b),m.length===0&&i.length>0&&!$&&!F&&!B&&_(i),B&&z(!1),m.length>0&&$&&V(!1),p==null||p.sort((N,T)=>{const fe=N.key&&m.includes(N.key),Xe=T.key&&m.includes(T.key);return fe===Xe?T.count-N.count:fe?-1:1}),p==null||p.forEach(N=>{N.label=n(`common.filters.values.${t.key}.${d(N.key)}`,{defaultValue:u(N.key)})}),y(p||[]),I(oe((p==null?void 0:p.length)||0,s))},[p,r,t.key,s,m]),a.useEffect(()=>{try{const o=sessionStorage.getItem(l)||"{}",i=JSON.parse(o);i[t.key]=m,sessionStorage.setItem(l,JSON.stringify(i))}catch(o){console.warn(`Failed to save filter state to sessionStorage for ${t.key}:`,o)}},[m,l,t.key]),a.useEffect(()=>{const o=()=>{sessionStorage.removeItem(l)};return window.addEventListener("beforeunload",o),()=>{window.removeEventListener("beforeunload",o)}},[l]);const G=a.useCallback(o=>{if(!o.trim()){y(p||[]),I(oe((p==null?void 0:p.length)||0,s));return}const i=Ct(o,p);s>i.length?I(i.length):i.length>s&&I(s),y(i)},[p,s]),M=a.useCallback(()=>{I(h.length)},[A,h]),P=a.useCallback(()=>{I(s)},[A]),te=a.useCallback(()=>{m.length!==h.length&&(w(!0),_(h.map(o=>o.key)))},[h,m]),O=a.useCallback(()=>{w(!0),_([]),V(!0);try{const o=sessionStorage.getItem(l);if(o){const i=JSON.parse(o);delete i[t.key],Object.keys(i).length===0?sessionStorage.removeItem(l):sessionStorage.setItem(l,JSON.stringify(i))}}catch(o){console.warn(`Failed to clear filter state from sessionStorage for ${t.key}:`,o)}},[l,t.key]),se=a.useCallback(()=>{m.length!==0&&O()},[m,O]),ne=a.useCallback(o=>{let i=[];m.some(b=>b===o.key)?i=m.filter(b=>b!==o.key):i=[...m,o.key],w(!0),_(i)},[m]),re=a.useCallback(()=>{O()},[O]),E=a.useCallback(o=>{w(!1),V(!1),j.updateActiveQueryField(r,{field:t.key,value:[...m],merge_strategy:L.OVERRIDE_VALUES,operator:o}),f()},[m,r,t.key,f]),U=a.useCallback(()=>{E(H.In)},[E]),D=a.useCallback(()=>{E(H.NotIn)},[E]),Q=a.useCallback(()=>{E(H.All)},[E]),J=a.useCallback(()=>{E(H.In)},[E]);return e.jsxs(e.Fragment,{children:[e.jsxs(_e,{size:"sm",variant:"outline",children:[e.jsx(W,{startIcon:mt,size:"xs",type:"text",placeholder:n("common.filters.search.placeholder"),className:"w-full text-xs py-1.5 px-3 mb-4 border border-border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",onChange:o=>G(o.target.value),autoFocus:!0}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(C,{size:"xs",onClick:()=>te(),variant:"link",className:"px-0",children:n("common.filters.buttons.all")}),e.jsx(dt,{orientation:"vertical",className:"h-4"}),e.jsx(C,{size:"xs",onClick:()=>se(),variant:"link",className:"px-0",children:n("common.filters.buttons.none")}),t.withDictionary&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex-grow"}),e.jsx(le,{htmlFor:"with-dictionary-switch",className:"text-xs",children:n("common.filters.with_dictionary")}),e.jsx(ut,{id:"with-dictionary-switch",checked:x,size:"xs",onCheckedChange:()=>k(!x)})]})]}),e.jsxs("div",{className:"max-h-[250px] overflow-auto",children:[c&&Array.from({length:3},(o,i)=>e.jsxs("div",{className:"flex justify-between items-center py-2 space-x-2",children:[e.jsx(K,{className:"w-full h-6 rounded"}),e.jsx(K,{className:"h-6 w-12 rounded-md"})]},`skeleton-${i}`)),!c&&h.length===0&&e.jsx("div",{className:"text-muted-foreground py-4",children:n("common.filters.no_values_found")}),!c&&h.length>0&&Array.from({length:A},(o,i)=>e.jsx("div",{className:"gap-3 py-1.5",children:e.jsx(ct,{size:"xs",label:n(`common.filters.labels.${t.key}_value.${h[i].key}`,{defaultValue:h[i].label}),checked:m.some(b=>b===h[i].key),count:h[i].count,onCheckedChange:()=>ne(h[i])})},h[i].key))]}),!c&&h.length>A&&e.jsx(C,{className:"mt-2 px-0",onClick:M,size:"xs",variant:"link",children:n("common.filters.buttons.show_more",{count:h.length-s})}),!c&&A>s&&e.jsx(C,{className:"mt-2 px-0",onClick:P,size:"xs",variant:"link",children:n("common.filters.buttons.show_less")})]}),e.jsx(je,{size:"sm",children:e.jsxs("div",{className:"flex align-right justify-end items-center space-x-2",children:[e.jsx(C,{size:"xxs",variant:"ghost",onClick:re,disabled:m.length===0||c,children:n("common.filters.buttons.clear")}),e.jsx("div",{className:"flex space-x-2",children:e.jsx(it,{size:"xxs",variant:"outline",className:"h-7",color:"primary",actions:[{label:n("common.filters.buttons.some_not_in"),onClick:J},{label:n("common.filters.buttons.all"),onClick:Q},{label:n("common.filters.buttons.not_in"),onClick:D}],onDefaultAction:U,disabled:!F||c,children:n("common.filters.buttons.apply")})})]})})]})}Ae.__docgenInfo={description:"",methods:[],displayName:"MultiSelectFilter",props:{field:{required:!0,tsType:{name:"AggregationConfig"},description:""},maxVisibleItems:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"5",computed:!1}}}};const Ft=gt({slots:{base:"text-muted-foreground"},variants:{size:{xs:{base:"text-xs"},sm:{base:"text-sm"}}},defaultVariants:{size:"sm"}});function Ce({className:t,size:s,children:n}){const d=Ft({size:s});return e.jsx("p",{className:d.base({className:t}),children:n})}Ce.__docgenInfo={description:"",methods:[],displayName:"TextMuted"};const Te="integer",Ot=t=>{switch(t){case ie.cnv_occurrence:return s=>X.statisticsGermlineCNVOccurrences(s.seqId,s.statisticsBody).then(n=>n.data);default:return s=>X.statisticsGermlineSNVOccurrences(s.seqId,s.statisticsBody).then(n=>n.data)}};function qt(t,s,n,d=!1){const u={seqId:n,statisticsBody:{field:t}},r=d?Se:j.getResolvedActiveQuery(s);return r&&(u.statisticsBody.sqon={content:r.content,op:r.op}),Ne(u,Ot(s),{revalidateOnFocus:!1})}function ke(t,s,n,d){var y;let u=!1,r=R.LessThan,f="0",l="0",x="",k=!1;const p=(d==null?void 0:d.type)===Te?0:3,c=s.content.find(m=>"content"in m&&"field"in m.content?m.content.field===t:!1),g=s.content.find(m=>"content"in m&&"field"in m.content?m.content.field===`${t}_unit`:!1);if(c){const m=c.content.value;if(console.log("[NumericalFilter] values",m),m.includes("__missing__"))return{hasUnappliedItems:u,selectedRange:r,minValue:f,maxValue:l,numericalValue:x,hasNoData:!0,selectedUnit:void 0};u=!0,m.length===2?(r=R.Between,f=Number(m[0]).toFixed(p),l=Number(m[1]).toFixed(p)):x=m[0],c.op&&(r=c.op)}else console.log("[NumericalFilter else] no filter exists",n),k=!1,(n==null?void 0:n.defaultMin)!==void 0?(f=n.defaultMin.toString(),x=n.defaultMin.toString()):(d==null?void 0:d.min)!==void 0&&(f=Number(d.min.toFixed(p)).toString(),x=Number(d.min.toFixed(p)).toString()),(n==null?void 0:n.defaultMax)!==void 0?l=n.defaultMax.toString():(d==null?void 0:d.max)!==void 0&&(l=Number(d.max.toFixed(p)).toString()),n!=null&&n.defaultOperator&&(r=R[n.defaultOperator]);let h;return g&&g.content.value[0]&&((y=n==null?void 0:n.rangeTypes)!=null&&y.length)&&(h=n.rangeTypes[0].key),{hasUnappliedItems:u,selectedRange:r,minValue:f,maxValue:l,numericalValue:x,hasNoData:k,selectedUnit:h}}function Fe({field:t}){var U,D,Q,J;const{t:s}=q(),{appId:n,aggregations:d}=pe(),{seqId:u}=a.useContext(Ee),r=t.key,f={[R.GreaterThan]:{display:s("common.filters.operators.greater_than"),dropdown:s("common.filters.operators.greater_than"),icon:vt},[R.LessThan]:{display:s("common.filters.operators.less_than"),dropdown:s("common.filters.operators.less_than"),icon:yt},[R.Between]:{display:s("common.filters.operators.between"),dropdown:s("common.filters.operators.between"),icon:xt},[R.GreaterThanOrEqualTo]:{display:s("common.filters.operators.greater_than_or_equal"),dropdown:s("common.filters.operators.greater_than_or_equal"),icon:ht},[R.LessThanOrEqualTo]:{display:s("common.filters.operators.less_than_or_equal"),dropdown:s("common.filters.operators.less_than_or_equal"),icon:ft},[R.In]:{display:s("common.filters.operators.in"),dropdown:s("common.filters.operators.in"),icon:pt}},{data:l,isLoading:x}=qt(r,n,u,!1),k=(l==null?void 0:l.type)===Te?0:3,[p,c]=a.useState(R.GreaterThan),[g,h]=a.useState("0"),[y,m]=a.useState("0"),[_,A]=a.useState("0"),[I,F]=a.useState(!1),[w,$]=a.useState(),[V,S]=a.useState(!1),v=(U=Object.values(d).flatMap(o=>o.items).find(o=>o.key===r))==null?void 0:U.defaults,B=t.type==="numerical"&&(v==null?void 0:v.noDataInputOption),z=(v==null?void 0:v.intervalDecimal)!==void 0&&((v==null?void 0:v.max)!==void 0||(v==null?void 0:v.min)!==void 0)||l&&(l.min!==void 0||l.max!==void 0),G=(v==null?void 0:v.min)??(l==null?void 0:l.min)??0,M=(v==null?void 0:v.max)??(l==null?void 0:l.max)??100,P=a.useCallback(()=>{const o=j.getResolvedActiveQuery(n);if(!(o!=null&&o.content))return;const i=ke(r,o,v,l);F(i.hasNoData),A(i.minValue),m(i.maxValue),S(i.hasUnappliedItems),c(i.selectedRange??R.GreaterThan),h(i.numericalValue)},[n,r,v,l]);a.useEffect(()=>{P()},[P]);const te=a.useCallback(o=>{c(o),S(!0)},[]),O=a.useCallback(o=>{F(o),S(!0)},[]),se=a.useCallback(o=>{$(o),S(!0)},[]),ne=()=>{S(!1);const o=ke(r,Se,v,l);F(o.hasNoData),A(o.minValue),m(o.maxValue),S(o.hasUnappliedItems),c(o.selectedRange),h(o.numericalValue)},re=a.useCallback(()=>{if(S(!1),I){j.updateActiveQueryField(n,{field:r,value:["__missing__"],merge_strategy:L.OVERRIDE_VALUES});return}let o=[];o=p===R.Between?[parseFloat(_.toString()),parseFloat(y.toString())]:[parseFloat(g.toString())],j.updateActiveQueryField(n,{field:r,value:o,merge_strategy:L.OVERRIDE_VALUES,operator:p}),w&&j.updateActiveQueryField(n,{field:`${r}_unit`,value:[w],merge_strategy:L.OVERRIDE_VALUES})},[n,r,p,g,_,y,I,w]),E=Object.entries(R).map(([o,i])=>{if(i in f){const b=f[i].icon;return e.jsx(he,{value:i,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{size:16}),e.jsx("span",{children:f[i].dropdown})]})},i)}return null}).filter(Boolean);return e.jsxs(e.Fragment,{children:[e.jsx(_e,{id:`${r}_container`,size:"sm",variant:"outline",children:e.jsxs("div",{className:"pt-2",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("div",{id:`${r}_operator`,children:e.jsxs(xe,{value:p,onValueChange:te,children:[e.jsx(ye,{size:"sm",children:e.jsx(ve,{placeholder:s("common.filters.operators.select_operator"),children:f[p].display})}),e.jsx(ge,{children:E})]})}),p===R.Between?e.jsxs("div",{className:"flex gap-2 flex-row",children:[e.jsx(W,{size:"xs",className:"w-half",value:_,onChange:o=>{const i=o.target.value;isNaN(Number(i))||(A(i),S(!0))},min:G,max:M,id:`${r}_min`,"data-testid":`${r}_min`}),e.jsx(W,{size:"xs",className:"w-half",value:y,onChange:o=>{const i=o.target.value;isNaN(Number(i))||(m(i),S(!0))},min:G,max:M,id:`${r}_max`,"data-testid":`${r}_max`})]}):e.jsx(W,{size:"xs",className:"w-full",value:g,onChange:o=>{const i=o.target.value;isNaN(Number(i))||(h(i),S(!0))},min:G,max:M,id:`${r}_value`,"data-testid":`${r}_value`}),z&&e.jsx("div",{id:`${r}_interval`,children:e.jsxs(Ce,{size:"xs",children:[s("common.filters.labels.actual_interval")," : ",(D=l==null?void 0:l.min)==null?void 0:D.toFixed(k)," -"," ",(Q=l==null?void 0:l.max)==null?void 0:Q.toFixed(k)]})})]}),(v==null?void 0:v.rangeTypes)&&v.rangeTypes.length>0&&e.jsx("div",{id:`${r}_range_type_container`,children:x?e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"h-5 w-16 mb-1",id:`${r}_unit_label_skeleton`}),e.jsx(K,{className:"h-9 w-full",id:`${r}_select_skeleton`})]}):e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"text-sm",id:`${r}_unit_label`,children:s("common.filters.labels.unit")}),e.jsxs(xe,{defaultValue:w||v.rangeTypes[0].key,onValueChange:se,children:[e.jsx(ye,{children:e.jsx(ve,{placeholder:s("common.filters.labels.select_unit"),children:((J=v.rangeTypes.find(o=>o.key===w))==null?void 0:J.name)||s("common.filters.labels.select_unit")})}),e.jsx(ge,{children:v.rangeTypes.map(o=>e.jsx(he,{value:o.key,children:o.name},o.key))})]})]})}),B&&!z&&e.jsxs("label",{className:"flex items-center space-x-2 overflow-hidden",id:`${r}_no_data_label`,children:[e.jsx(kt,{checked:I,onCheckedChange:O,id:`${r}_no_data`}),e.jsx("span",{children:s("common.filters.labels.no_data")})]})]})}),e.jsx(je,{size:"sm",children:e.jsxs("div",{className:"flex align-right justify-end items-center space-x-2",children:[e.jsx(C,{size:"xxs",variant:"ghost",onClick:ne,disabled:!V,id:`${r}_clear`,children:s("common.filters.buttons.clear")}),e.jsx("div",{className:"flex space-x-2",children:e.jsx(C,{size:"xxs",variant:"outline",onClick:re,id:`${r}_apply`,children:s("common.filters.buttons.apply")})})]})})]})}Fe.__docgenInfo={description:"",methods:[],displayName:"NumericalFilter",props:{field:{required:!0,tsType:{name:"AggregationConfig"},description:""}}};var de="Radio",[Vt,Oe]=Re(de),[Gt,Mt]=Vt(de),qe=a.forwardRef((t,s)=>{const{__scopeRadio:n,name:d,checked:u=!1,required:r,disabled:f,value:l="on",onCheck:x,form:k,...p}=t,[c,g]=a.useState(null),h=ce(s,_=>g(_)),y=a.useRef(!1),m=c?k||!!c.closest("form"):!0;return e.jsxs(Gt,{scope:n,checked:u,disabled:f,children:[e.jsx(Z.button,{type:"button",role:"radio","aria-checked":u,"data-state":Le(u),"data-disabled":f?"":void 0,disabled:f,value:l,...p,ref:h,onClick:ae(t.onClick,_=>{u||x==null||x(),m&&(y.current=_.isPropagationStopped(),y.current||_.stopPropagation())})}),m&&e.jsx(Me,{control:c,bubbles:!y.current,name:d,value:l,checked:u,required:r,disabled:f,form:k,style:{transform:"translateX(-100%)"}})]})});qe.displayName=de;var Ve="RadioIndicator",Ge=a.forwardRef((t,s)=>{const{__scopeRadio:n,forceMount:d,...u}=t,r=Mt(Ve,n);return e.jsx(It,{present:d||r.checked,children:e.jsx(Z.span,{"data-state":Le(r.checked),"data-disabled":r.disabled?"":void 0,...u,ref:s})})});Ge.displayName=Ve;var Lt="RadioBubbleInput",Me=a.forwardRef(({__scopeRadio:t,control:s,checked:n,bubbles:d=!0,...u},r)=>{const f=a.useRef(null),l=ce(f,r),x=wt(n),k=Rt(s);return a.useEffect(()=>{const p=f.current;if(!p)return;const c=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(c,"checked").set;if(x!==n&&h){const y=new Event("click",{bubbles:d});h.call(p,n),p.dispatchEvent(y)}},[x,n,d]),e.jsx(Z.input,{type:"radio","aria-hidden":!0,defaultChecked:n,...u,tabIndex:-1,ref:l,style:{...u.style,...k,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Me.displayName=Lt;function Le(t){return t?"checked":"unchecked"}var $t=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],ee="RadioGroup",[Bt,Ns]=Re(ee,[we,Oe]),$e=we(),Be=Oe(),[zt,Pt]=Bt(ee),ze=a.forwardRef((t,s)=>{const{__scopeRadioGroup:n,name:d,defaultValue:u,value:r,required:f=!1,disabled:l=!1,orientation:x,dir:k,loop:p=!0,onValueChange:c,...g}=t,h=$e(n),y=Nt(k),[m,_]=bt({prop:r,defaultProp:u??null,onChange:c,caller:ee});return e.jsx(zt,{scope:n,name:d,required:f,disabled:l,value:m,onValueChange:_,children:e.jsx(_t,{asChild:!0,...h,orientation:x,dir:y,loop:p,children:e.jsx(Z.div,{role:"radiogroup","aria-required":f,"aria-orientation":x,"data-disabled":l?"":void 0,dir:y,...g,ref:s})})})});ze.displayName=ee;var Pe="RadioGroupItem",Ue=a.forwardRef((t,s)=>{const{__scopeRadioGroup:n,disabled:d,...u}=t,r=Pt(Pe,n),f=r.disabled||d,l=$e(n),x=Be(n),k=a.useRef(null),p=ce(s,k),c=r.value===u.value,g=a.useRef(!1);return a.useEffect(()=>{const h=m=>{$t.includes(m.key)&&(g.current=!0)},y=()=>g.current=!1;return document.addEventListener("keydown",h),document.addEventListener("keyup",y),()=>{document.removeEventListener("keydown",h),document.removeEventListener("keyup",y)}},[]),e.jsx(jt,{asChild:!0,...l,focusable:!f,active:c,children:e.jsx(qe,{disabled:f,required:r.required,checked:c,...x,...u,name:r.name,ref:p,onCheck:()=>r.onValueChange(u.value),onKeyDown:ae(h=>{h.key==="Enter"&&h.preventDefault()}),onFocus:ae(u.onFocus,()=>{var h;g.current&&((h=k.current)==null||h.click())})})})});Ue.displayName=Pe;var Ut="RadioGroupIndicator",De=a.forwardRef((t,s)=>{const{__scopeRadioGroup:n,...d}=t,u=Be(n);return e.jsx(Ge,{...u,...d,ref:s})});De.displayName=Ut;var Qe=ze,Je=Ue,Dt=De;function ue({className:t,...s}){return e.jsx(Qe,{className:Ie("grid gap-2",t),...s})}ue.displayName=Qe.displayName;function me({className:t,...s}){return e.jsx(Je,{className:Ie("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...s,children:e.jsx(Dt,{className:"flex items-center justify-center",children:e.jsx(St,{className:"h-2.5 w-2.5 fill-current text-current"})})})}me.displayName=Je.displayName;ue.__docgenInfo={description:"",methods:[]};me.__docgenInfo={description:"",methods:[]};function He({data:t,field:s}){const{t:n}=q(),[d,u]=a.useState(t||[]),[r,f]=a.useState(null),{appId:l}=pe();a.useEffect(()=>{const c=j.getActiveQuery(l).content.find(g=>g.content.field===s.key);if(c){const g=c.content.value;g.length>=1&&f(g[0])}else f(null);u(t||[])},[t]);const x=a.useCallback(c=>{c.key!==r&&c.key!==void 0&&(f(c.key||null),j.updateActiveQueryField(l,{field:s.key,value:[...c.key],merge_strategy:L.OVERRIDE_VALUES}))},[r]),k=a.useCallback(c=>r===c.key,[r]),p=a.useCallback(()=>{f(null)},[r]);return e.jsxs("div",{className:"p-2 w-full max-w-md",children:[e.jsx(ue,{children:d.map(c=>e.jsx("div",{className:"space-y-3 pt-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(me,{value:c.key||"",id:c.key,checked:k(c),onClick:()=>{x(c)}}),e.jsx(le,{htmlFor:c.key,children:c.key})]}),e.jsx("span",{className:"bg-accent px-2 py-1 rounded-md font-mono text-xs",children:c.count})]})},c.key))}),r!==null&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"my-4 border-border"}),e.jsx("div",{className:"flex align-right justify-end items-center space-x-2",children:e.jsx(C,{onClick:p,size:"xs",children:n("common.filters.buttons.clear")})})]})]})}He.__docgenInfo={description:"",methods:[],displayName:"ToggleFilter",props:{data:{required:!1,tsType:{name:"Array",elements:[{name:"Aggregation"}],raw:"Aggregation[]"},description:""},field:{required:!0,tsType:{name:"AggregationConfig"},description:""}}};function Y({field:t,children:s}){const{t:n}=q(),d=n(`common.filters.labels.${t.translation_key}`,{defaultValue:t.key}),u=`common.filters.labels.${t.translation_key}_tooltip`,r=n(u)===u?null:n(u);function f(){return e.jsx("div",{className:"flex items-center justify-between w-full text-xs",children:e.jsx("span",{children:d})})}return e.jsx(nt,{size:"sm",children:e.jsxs(Ze,{value:t.key,className:"border-none",children:[e.jsx(rt,{size:"sm",children:e.jsx(et,{children:r?e.jsxs(ot,{children:[e.jsx(at,{asChild:!0,children:e.jsx("span",{children:f()})}),e.jsx(lt,{children:e.jsx("span",{children:r})})]}):f()})}),e.jsx(tt,{className:"pb-0",children:s})]},t.key)})}function We({field:t,isOpen:s}){const{t:n}=q(),d=t.type;if(d==="divider")return e.jsx("h4",{className:"px-2 h-8 text-sidebar-foreground/70 text-xs font-medium line-height-xs text-ellipsis overflow-hidden flex justify-between items-center",children:n(`common.filters.${t.key}`)});let u;switch(d){case"multiple":u=e.jsx(Y,{field:t,isOpen:s,children:e.jsx(Ae,{field:t})});break;case"numerical":u=e.jsx(Y,{field:t,isOpen:s,children:e.jsx(Fe,{field:t})});break;case"boolean":u=e.jsx(Y,{field:t,isOpen:s,children:e.jsx(He,{field:t})});break;default:u=e.jsx("div",{children:n("common.filters.unsupported_type",{type:t.type})})}return u}Y.__docgenInfo={description:"",methods:[],displayName:"AccordionContainer",props:{field:{required:!0,tsType:{name:"AggregationConfig"},description:""},isOpen:{required:!0,tsType:{name:"boolean"},description:""},searchHandler:{required:!1,tsType:{name:"signature",type:"function",raw:"(_e: React.MouseEvent<SVGElement, MouseEvent>) => void",signature:{arguments:[{type:{name:"ReactMouseEvent",raw:"React.MouseEvent<SVGElement, MouseEvent>",elements:[{name:"SVGElement"},{name:"MouseEvent"}]},name:"_e"}],return:{name:"void"}}},description:""},children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};We.__docgenInfo={description:"To be use when the filter needs to be inside an Accordion component",methods:[],displayName:"FilterContainer",props:{field:{required:!0,tsType:{name:"AggregationConfig"},description:""},isOpen:{required:!0,tsType:{name:"boolean"},description:""},searchHandler:{required:!1,tsType:{name:"signature",type:"function",raw:"(_e: React.MouseEvent<SVGElement, MouseEvent>) => void",signature:{arguments:[{type:{name:"ReactMouseEvent",raw:"React.MouseEvent<SVGElement, MouseEvent>",elements:[{name:"SVGElement"},{name:"MouseEvent"}]},name:"_e"}],return:{name:"void"}}},description:""}}};const Ye=a.createContext({appId:ie.variant_entity,aggregations:{},clearUnappliedFilters:()=>{}}),pe=()=>{const t=a.useContext(Ye);if(!t)throw new Error("useFilterConfig must be used within a FilterConfigProvider");return t};function Ke(t){return`temp-filters-${t}`}function Qt({groupKey:t,appId:s,aggregations:n}){var h;const{t:d}=q(),[u,r]=a.useState(!1),[f,l]=a.useState([]),[x,k]=a.useState(t),p=Ke(s),c=()=>{sessionStorage.removeItem(p)},g=t?((h=n[t])==null?void 0:h.items)||[]:Object.values(n).flatMap(y=>y.items);return a.useEffect(()=>{r(!1),l([])},[t]),a.useEffect(()=>{(x&&x!==null&&t===null||x&&x!==null&&t&&t!==null&&x!==t)&&c(),k(t)},[t,x]),e.jsx(Ye,{value:{appId:s,aggregations:n,clearUnappliedFilters:c},children:e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(C,{variant:"link",size:"xs",onClick:()=>{const y=!u;r(y),l(y?g.map(m=>m.key):[])},children:d(u?"common.actions.collapse_all":"common.actions.expand_all")})}),e.jsx(st,{className:"flex flex-col gap-1",type:"multiple",value:f,onValueChange:y=>l(y),children:g.map((y,m)=>e.jsx(We,{isOpen:f.includes(y.key),field:y},`${y.key}-${m}`))})]})})}Qt.__docgenInfo={description:"",methods:[],displayName:"FilterList",props:{groupKey:{required:!1,tsType:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},description:""},aggregations:{required:!0,tsType:{name:"signature",type:"object",raw:`{
  [key: string]: AggregationGroup;
}`,signature:{properties:[{key:{name:"string"},value:{name:"AggregationGroup",required:!0}}]}},description:""},appId:{required:!0,tsType:{name:"ApplicationId"},description:""}}};export{Qt as F,Ae as M,Fe as N,He as T};
