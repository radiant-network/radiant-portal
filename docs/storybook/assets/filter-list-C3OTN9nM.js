import{j as e}from"./jsx-runtime-D_zvdyIk.js";import{R as _e,r as a}from"./index-CBYaBgW8.js";import{A as et,a as tt,b as st,c as nt}from"./accordion-CtRRXK5y.js";import{B as T}from"./button-BZ3NxlpX.js";import{d as je,e as Se,C as rt,a as ot}from"./card-CV4HB3NY.js";import{T as at,a as lt,b as it}from"./tooltip-BjBxR1Ac.js";import{A as ct}from"./action-button-KkvxmIWD.js";import"./button.variants-Du9eY_ux.js";import{C as dt}from"./checkbox-filter-Dg7BtyeC.js";import{I as W}from"./input-Dm5winle.js";import{L as ie}from"./label-C8KZOh3h.js";import{S as ut}from"./separator-B36Ht569.js";import{S as K}from"./skeleton-Shk8p_SP.js";import{S as mt}from"./switch-SfbwGtii.js";import{u as q}from"./i18n-Bp37lLhy.js";import{q as S,D as Ne}from"./query-builder-remote-Cb2u0WYb.js";import{M as P,T as H,R as N}from"./sqon-xFXjybh7.js";import{A as ce}from"./applications-config-3OOAo44D.js";import{u as Re,o as X}from"./api-boGUK73W.js";import{S as pt}from"./search-DKmUqS9g.js";import{E as ft,L as ht,G as xt,a as yt,b as vt,c as gt}from"./less-than-or-equal-operator-icon-BI5aNTvi.js";import{c as kt}from"./index-C66Dxnp2.js";import{C as bt}from"./checkbox-B4fiCiBj.js";import{d as xe,S as ye,a as ve,b as ge,c as ke}from"./select-DMB6Vi4A.js";import{u as _t}from"./chunk-PVWAREVJ-ZXULl1h5.js";import{a as jt,c as Ie,b as le}from"./index-Ba5mf8A5.js";import{P as Z,u as de}from"./index-Dut9wsGU.js";import{i as we,R as St,I as Nt,C as Rt}from"./dropdown-menu-BJyjb2OL.js";import{u as It}from"./index-C6lL4ijz.js";import{u as wt}from"./index-BtWW-1ow.js";import{u as Et}from"./index-SF2qmtPV.js";import{P as At}from"./index-BZEiv_1o.js";import{c as Ee}from"./utils-D-KgF5mV.js";const Ae=_e.createContext({caseId:1,seqId:1}),Ct=t=>{switch(t){case ce.cnv_occurrence:return s=>X.aggregateGermlineCNVOccurrences(s.caseId,s.seqId,s.aggregationBody).then(n=>n.data);default:return s=>X.aggregateGermlineSNVOccurrences(s.caseId,s.seqId,s.aggregationBody,s.withDictionary).then(n=>n.data)}};function Tt(t,s=30,n=!1,d=!1,u){let l;const{caseId:o,seqId:f}=_e.useContext(Ae);n?l={caseId:o,seqId:f,aggregationBody:{field:t,size:s},withDictionary:d}:l=null;const i=S.getResolvedActiveQuery(u);return i&&l&&(l.aggregationBody.sqon={content:i.content,op:i.op}),Re(l,Ct(u),{revalidateOnFocus:!1})}function Ft(t,s){const n=t.toLowerCase().split(/\s+/).filter(Boolean);return s.filter(d=>{const u=d.key.toLowerCase(),l=d.label.toLowerCase();function o(f,i){let b=0;for(const h of i){const c=f.indexOf(h,b);if(c===-1)return!1;b=c+h.length}return!0}return o(u,n)||o(l,n)})}function ae(t,s){return s<t?s:t}function Ot(t,s){return!!(S.getResolvedActiveQuery(t).content.find(d=>d.content.field===s.key)&&s.withDictionary)}function Ce({field:t,maxVisibleItems:s=5}){const{t:n,sanitize:d,lazyTranslate:u}=q(),{appId:l,clearUnappliedFilters:o}=fe(),f=Xe(l),[i,b]=a.useState(Ot(l,t)),{data:h,isLoading:c}=Tt(t.key,void 0,!0,i,l),k=()=>{try{const y=sessionStorage.getItem(f);if(y){const C=JSON.parse(y);if(Object.prototype.hasOwnProperty.call(C,t.key)){const _=C[t.key];return console.error(`[${t.key}] Found in sessionStorage:`,_),_}}}catch(y){console.warn(`Failed to read filter state from sessionStorage for ${t.key}:`,y)}const p=S.getResolvedActiveQuery(l).content.find(y=>y.content.field===t.key);return(p==null?void 0:p.content.value)||[]},[x,v]=a.useState(h||[]),[m,j]=a.useState(k()),[E,I]=a.useState(ae(x.length,s)),[V,A]=a.useState(!1),[F,G]=a.useState(!1),[M,R]=a.useState(()=>{const p=S.getResolvedActiveQuery(l);return JSON.stringify(p)}),[g,te]=a.useState(()=>{try{const p=sessionStorage.getItem(f);if(p){const r=JSON.parse(p);return Object.prototype.hasOwnProperty.call(r,t.key)}}catch(p){console.warn(`Failed to check sessionStorage state for ${t.key}:`,p)}return!1});a.useEffect(()=>{const p=S.getResolvedActiveQuery(l),r=JSON.stringify(p);if(M&&M!==r){o();const y=S.getResolvedActiveQuery(l).content.find(_=>_.content.field===t.key),C=(y==null?void 0:y.content.value)||[];j(C)}R(r)},[l,t.key,o,M]),a.useEffect(()=>{const p=S.getResolvedActiveQuery(l).content.find(_=>_.content.field===t.key),r=(p==null?void 0:p.content.value)||[],y=JSON.stringify([...m].sort())!==JSON.stringify([...r].sort());A(y),m.length===0&&r.length>0&&!F&&!V&&!g&&j(r),g&&te(!1),m.length>0&&F&&G(!1);const C=(()=>{const _=S.getResolvedActiveQuery(l).content.find(B=>B.content.field===t.key);return(_==null?void 0:_.content.value)||[]})();h==null||h.sort((_,B)=>{const he=_.key&&C.includes(_.key),Ze=B.key&&C.includes(B.key);return he===Ze?B.count-_.count:he?-1:1}),h==null||h.forEach(_=>{_.label=n(`common.filters.values.${t.key}.${d(_.key)}`,{defaultValue:u(_.key)})}),v(h||[]),I(ae((h==null?void 0:h.length)||0,s))},[h,l,t.key,s,m]),a.useEffect(()=>{try{const p=sessionStorage.getItem(f)||"{}",r=JSON.parse(p);r[t.key]=m,sessionStorage.setItem(f,JSON.stringify(r))}catch(p){console.warn(`Failed to save filter state to sessionStorage for ${t.key}:`,p)}},[m,f,t.key]),a.useEffect(()=>{const p=()=>{sessionStorage.removeItem(f)};return window.addEventListener("beforeunload",p),()=>{window.removeEventListener("beforeunload",p)}},[f]);const z=a.useCallback(p=>{if(!p.trim()){v(h||[]),I(ae((h==null?void 0:h.length)||0,s));return}const r=Ft(p,h);s>r.length?I(r.length):r.length>s&&I(s),v(r)},[h,s]),L=a.useCallback(()=>{I(x.length)},[E,x]),$=a.useCallback(()=>{I(s)},[E]),U=a.useCallback(()=>{m.length!==x.length&&(A(!0),j(x.map(p=>p.key)))},[x,m]),O=a.useCallback(()=>{A(!0),j([]),G(!0);try{const p=sessionStorage.getItem(f);if(p){const r=JSON.parse(p);delete r[t.key],Object.keys(r).length===0?sessionStorage.removeItem(f):sessionStorage.setItem(f,JSON.stringify(r))}}catch(p){console.warn(`Failed to clear filter state from sessionStorage for ${t.key}:`,p)}},[f,t.key]),se=a.useCallback(()=>{m.length!==0&&O()},[m,O]),ne=a.useCallback(p=>{let r=[];m.some(y=>y===p.key)?r=m.filter(y=>y!==p.key):r=[...m,p.key],A(!0),j(r)},[m]),re=a.useCallback(()=>{O()},[O]),w=a.useCallback(p=>{A(!1),G(!1),S.updateActiveQueryField(l,{field:t.key,value:[...m],merge_strategy:P.OVERRIDE_VALUES,operator:p}),o()},[m,l,t.key,o]),oe=a.useCallback(()=>{w(H.In)},[w]),D=a.useCallback(()=>{w(H.NotIn)},[w]),Q=a.useCallback(()=>{w(H.All)},[w]),J=a.useCallback(()=>{w(H.In)},[w]);return e.jsxs(e.Fragment,{children:[e.jsxs(je,{size:"sm",variant:"outline",children:[e.jsx(W,{startIcon:pt,size:"xs",type:"text",placeholder:n("common.filters.search.placeholder"),className:"w-full text-xs py-1.5 px-3 mb-4 border border-border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",onChange:p=>z(p.target.value),autoFocus:!0}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(T,{size:"xs",onClick:()=>U(),variant:"link",className:"px-0",children:n("common.filters.buttons.all")}),e.jsx(ut,{orientation:"vertical",className:"h-4"}),e.jsx(T,{size:"xs",onClick:()=>se(),variant:"link",className:"px-0",children:n("common.filters.buttons.none")}),t.withDictionary&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex-grow"}),e.jsx(ie,{htmlFor:"with-dictionary-switch",className:"text-xs",children:n("common.filters.with_dictionary")}),e.jsx(mt,{id:"with-dictionary-switch",checked:i,size:"xs",onCheckedChange:()=>b(!i)})]})]}),e.jsxs("div",{className:"max-h-[250px] overflow-auto",children:[c&&Array.from({length:3},(p,r)=>e.jsxs("div",{className:"flex justify-between items-center py-2 space-x-2",children:[e.jsx(K,{className:"w-full h-6 rounded"}),e.jsx(K,{className:"h-6 w-12 rounded-md"})]},`skeleton-${r}`)),!c&&x.length===0&&e.jsx("div",{className:"text-muted-foreground py-4",children:n("common.filters.no_values_found")}),!c&&x.length>0&&Array.from({length:E},(p,r)=>e.jsx("div",{className:"gap-3 py-1.5",children:e.jsx(dt,{size:"xs",label:n(`common.filters.labels.${t.key}_value.${x[r].key}`,{defaultValue:x[r].label}),checked:m.some(y=>y===x[r].key),count:x[r].count,onCheckedChange:()=>ne(x[r])})},x[r].key))]}),!c&&x.length>E&&e.jsx(T,{className:"mt-2 px-0",onClick:L,size:"xs",variant:"link",children:n("common.filters.buttons.show_more",{count:x.length-s})}),!c&&E>s&&e.jsx(T,{className:"mt-2 px-0",onClick:$,size:"xs",variant:"link",children:n("common.filters.buttons.show_less")})]}),e.jsx(Se,{size:"sm",children:e.jsxs("div",{className:"flex align-right justify-end items-center space-x-2",children:[e.jsx(T,{size:"xxs",variant:"ghost",onClick:re,disabled:m.length===0||c,children:n("common.filters.buttons.clear")}),e.jsx("div",{className:"flex space-x-2",children:e.jsx(ct,{size:"xxs",variant:"outline",className:"h-7",color:"primary",actions:[{label:n("common.filters.buttons.some_not_in"),onClick:J},{label:n("common.filters.buttons.all"),onClick:Q},{label:n("common.filters.buttons.not_in"),onClick:D}],onDefaultAction:oe,disabled:c,children:n("common.filters.buttons.apply")})})]})})]})}Ce.__docgenInfo={description:"",methods:[],displayName:"MultiSelectFilter",props:{field:{required:!0,tsType:{name:"AggregationConfig"},description:""},maxVisibleItems:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"5",computed:!1}}}};const qt=kt({slots:{base:"text-muted-foreground"},variants:{size:{xs:{base:"text-xs"},sm:{base:"text-sm"}}},defaultVariants:{size:"sm"}});function Te({className:t,size:s,children:n}){const d=qt({size:s});return e.jsx("p",{className:d.base({className:t}),children:n})}Te.__docgenInfo={description:"",methods:[],displayName:"TextMuted"};const Vt=function(){const{caseId:t}=_t(),s=t?Number(t):void 0;if(s==null)throw new Error("Required parameter case_id was null or undefined.");return s},Fe="integer",Gt=t=>{switch(t){case ce.cnv_occurrence:return s=>X.statisticsGermlineCNVOccurrences(s.caseId,s.seqId,s.statisticsBody).then(n=>n.data);default:return s=>X.statisticsGermlineSNVOccurrences(s.caseId,s.seqId,s.statisticsBody).then(n=>n.data)}};function Mt(t,s,n,d,u=!1){const l={caseId:n,seqId:d,statisticsBody:{field:t}},o=u?Ne:S.getResolvedActiveQuery(s);return o&&(l.statisticsBody.sqon={content:o.content,op:o.op}),Re(l,Gt(s),{revalidateOnFocus:!1})}function be(t,s,n,d){var v;let u=!1,l=N.LessThan,o="0",f="0",i="",b=!1;const h=(d==null?void 0:d.type)===Fe?0:3,c=s.content.find(m=>"content"in m&&"field"in m.content?m.content.field===t:!1),k=s.content.find(m=>"content"in m&&"field"in m.content?m.content.field===`${t}_unit`:!1);if(c){const m=c.content.value;if(console.log("[NumericalFilter] values",m),m.includes("__missing__"))return{hasUnappliedItems:u,selectedRange:l,minValue:o,maxValue:f,numericalValue:i,hasNoData:!0,selectedUnit:void 0};u=!0,m.length===2?(l=N.Between,o=Number(m[0]).toFixed(h),f=Number(m[1]).toFixed(h)):i=m[0],c.op&&(l=c.op)}else console.log("[NumericalFilter else] no filter exists",n),b=!1,(n==null?void 0:n.defaultMin)!==void 0?(o=n.defaultMin.toString(),i=n.defaultMin.toString()):(d==null?void 0:d.min)!==void 0&&(o=Number(d.min.toFixed(h)).toString(),i=Number(d.min.toFixed(h)).toString()),(n==null?void 0:n.defaultMax)!==void 0?f=n.defaultMax.toString():(d==null?void 0:d.max)!==void 0&&(f=Number(d.max.toFixed(h)).toString()),n!=null&&n.defaultOperator&&(l=N[n.defaultOperator]);let x;return k&&k.content.value[0]&&((v=n==null?void 0:n.rangeTypes)!=null&&v.length)&&(x=n.rangeTypes[0].key),{hasUnappliedItems:u,selectedRange:l,minValue:o,maxValue:f,numericalValue:i,hasNoData:b,selectedUnit:x}}function Oe({field:t}){var D,Q,J,p;const{t:s}=q(),{appId:n,aggregations:d}=fe(),{seqId:u}=a.useContext(Ae),l=Vt(),o=t.key,f={[N.GreaterThan]:{display:s("common.filters.operators.greater_than"),dropdown:s("common.filters.operators.greater_than"),icon:gt},[N.LessThan]:{display:s("common.filters.operators.less_than"),dropdown:s("common.filters.operators.less_than"),icon:vt},[N.Between]:{display:s("common.filters.operators.between"),dropdown:s("common.filters.operators.between"),icon:yt},[N.GreaterThanOrEqualTo]:{display:s("common.filters.operators.greater_than_or_equal"),dropdown:s("common.filters.operators.greater_than_or_equal"),icon:xt},[N.LessThanOrEqualTo]:{display:s("common.filters.operators.less_than_or_equal"),dropdown:s("common.filters.operators.less_than_or_equal"),icon:ht},[N.In]:{display:s("common.filters.operators.in"),dropdown:s("common.filters.operators.in"),icon:ft}},{data:i,isLoading:b}=Mt(o,n,l,u,!1),h=(i==null?void 0:i.type)===Fe?0:3,[c,k]=a.useState(N.GreaterThan),[x,v]=a.useState("0"),[m,j]=a.useState("0"),[E,I]=a.useState("0"),[V,A]=a.useState(!1),[F,G]=a.useState(),[M,R]=a.useState(!1),g=(D=Object.values(d).flatMap(r=>r.items).find(r=>r.key===o))==null?void 0:D.defaults,te=t.type==="numerical"&&(g==null?void 0:g.noDataInputOption),z=(g==null?void 0:g.intervalDecimal)!==void 0&&((g==null?void 0:g.max)!==void 0||(g==null?void 0:g.min)!==void 0)||i&&(i.min!==void 0||i.max!==void 0),L=(g==null?void 0:g.min)??(i==null?void 0:i.min)??0,$=(g==null?void 0:g.max)??(i==null?void 0:i.max)??100,U=a.useCallback(()=>{const r=S.getResolvedActiveQuery(n);if(!(r!=null&&r.content))return;const y=be(o,r,g,i);A(y.hasNoData),I(y.minValue),j(y.maxValue),R(y.hasUnappliedItems),k(y.selectedRange??N.GreaterThan),v(y.numericalValue)},[n,o,g,i]);a.useEffect(()=>{U()},[U]);const O=a.useCallback(r=>{k(r),R(!0)},[]),se=a.useCallback(r=>{A(r),R(!0)},[]),ne=a.useCallback(r=>{G(r),R(!0)},[]),re=()=>{R(!1);const r=be(o,Ne,g,i);A(r.hasNoData),I(r.minValue),j(r.maxValue),R(r.hasUnappliedItems),k(r.selectedRange),v(r.numericalValue)},w=a.useCallback(()=>{if(R(!1),V){S.updateActiveQueryField(n,{field:o,value:["__missing__"],merge_strategy:P.OVERRIDE_VALUES});return}let r=[];r=c===N.Between?[parseFloat(E.toString()),parseFloat(m.toString())]:[parseFloat(x.toString())],S.updateActiveQueryField(n,{field:o,value:r,merge_strategy:P.OVERRIDE_VALUES,operator:c}),F&&S.updateActiveQueryField(n,{field:`${o}_unit`,value:[F],merge_strategy:P.OVERRIDE_VALUES})},[n,o,c,x,E,m,V,F]),oe=Object.entries(N).map(([r,y])=>{if(y in f){const C=f[y].icon;return e.jsx(xe,{value:y,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{size:16}),e.jsx("span",{children:f[y].dropdown})]})},y)}return null}).filter(Boolean);return e.jsxs(e.Fragment,{children:[e.jsx(je,{id:`${o}_container`,size:"sm",variant:"outline",children:e.jsxs("div",{className:"pt-2",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("div",{id:`${o}_operator`,children:e.jsxs(ye,{value:c,onValueChange:O,children:[e.jsx(ve,{size:"sm",children:e.jsx(ge,{placeholder:s("common.filters.operators.select_operator"),children:f[c].display})}),e.jsx(ke,{children:oe})]})}),c===N.Between?e.jsxs("div",{className:"flex gap-2 flex-row",children:[e.jsx(W,{size:"xs",className:"w-half",value:E,onChange:r=>{const y=r.target.value;isNaN(Number(y))||(I(y),R(!0))},min:L,max:$,id:`${o}_min`,"data-testid":`${o}_min`}),e.jsx(W,{size:"xs",className:"w-half",value:m,onChange:r=>{const y=r.target.value;isNaN(Number(y))||(j(y),R(!0))},min:L,max:$,id:`${o}_max`,"data-testid":`${o}_max`})]}):e.jsx(W,{size:"xs",className:"w-full",value:x,onChange:r=>{const y=r.target.value;isNaN(Number(y))||(v(y),R(!0))},min:L,max:$,id:`${o}_value`,"data-testid":`${o}_value`}),z&&e.jsx("div",{id:`${o}_interval`,children:e.jsxs(Te,{size:"xs",children:[s("common.filters.labels.actual_interval")," : ",(Q=i==null?void 0:i.min)==null?void 0:Q.toFixed(h)," -"," ",(J=i==null?void 0:i.max)==null?void 0:J.toFixed(h)]})})]}),(g==null?void 0:g.rangeTypes)&&g.rangeTypes.length>0&&e.jsx("div",{id:`${o}_range_type_container`,children:b?e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"h-5 w-16 mb-1",id:`${o}_unit_label_skeleton`}),e.jsx(K,{className:"h-9 w-full",id:`${o}_select_skeleton`})]}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"text-sm",id:`${o}_unit_label`,children:s("common.filters.labels.unit")}),e.jsxs(ye,{defaultValue:F||g.rangeTypes[0].key,onValueChange:ne,children:[e.jsx(ve,{children:e.jsx(ge,{placeholder:s("common.filters.labels.select_unit"),children:((p=g.rangeTypes.find(r=>r.key===F))==null?void 0:p.name)||s("common.filters.labels.select_unit")})}),e.jsx(ke,{children:g.rangeTypes.map(r=>e.jsx(xe,{value:r.key,children:r.name},r.key))})]})]})}),te&&!z&&e.jsxs("label",{className:"flex items-center space-x-2 overflow-hidden",id:`${o}_no_data_label`,children:[e.jsx(bt,{checked:V,onCheckedChange:se,id:`${o}_no_data`}),e.jsx("span",{children:s("common.filters.labels.no_data")})]})]})}),e.jsx(Se,{size:"sm",children:e.jsxs("div",{className:"flex align-right justify-end items-center space-x-2",children:[e.jsx(T,{size:"xxs",variant:"ghost",onClick:re,disabled:!M,id:`${o}_clear`,children:s("common.filters.buttons.clear")}),e.jsx("div",{className:"flex space-x-2",children:e.jsx(T,{size:"xxs",variant:"outline",onClick:w,id:`${o}_apply`,children:s("common.filters.buttons.apply")})})]})})]})}Oe.__docgenInfo={description:"",methods:[],displayName:"NumericalFilter",props:{field:{required:!0,tsType:{name:"AggregationConfig"},description:""}}};var ue="Radio",[Lt,qe]=Ie(ue),[$t,Bt]=Lt(ue),Ve=a.forwardRef((t,s)=>{const{__scopeRadio:n,name:d,checked:u=!1,required:l,disabled:o,value:f="on",onCheck:i,form:b,...h}=t,[c,k]=a.useState(null),x=de(s,j=>k(j)),v=a.useRef(!1),m=c?b||!!c.closest("form"):!0;return e.jsxs($t,{scope:n,checked:u,disabled:o,children:[e.jsx(Z.button,{type:"button",role:"radio","aria-checked":u,"data-state":$e(u),"data-disabled":o?"":void 0,disabled:o,value:f,...h,ref:x,onClick:le(t.onClick,j=>{u||i==null||i(),m&&(v.current=j.isPropagationStopped(),v.current||j.stopPropagation())})}),m&&e.jsx(Le,{control:c,bubbles:!v.current,name:d,value:f,checked:u,required:l,disabled:o,form:b,style:{transform:"translateX(-100%)"}})]})});Ve.displayName=ue;var Ge="RadioIndicator",Me=a.forwardRef((t,s)=>{const{__scopeRadio:n,forceMount:d,...u}=t,l=Bt(Ge,n);return e.jsx(At,{present:d||l.checked,children:e.jsx(Z.span,{"data-state":$e(l.checked),"data-disabled":l.disabled?"":void 0,...u,ref:s})})});Me.displayName=Ge;var Pt="RadioBubbleInput",Le=a.forwardRef(({__scopeRadio:t,control:s,checked:n,bubbles:d=!0,...u},l)=>{const o=a.useRef(null),f=de(o,l),i=Et(n),b=wt(s);return a.useEffect(()=>{const h=o.current;if(!h)return;const c=window.HTMLInputElement.prototype,x=Object.getOwnPropertyDescriptor(c,"checked").set;if(i!==n&&x){const v=new Event("click",{bubbles:d});x.call(h,n),h.dispatchEvent(v)}},[i,n,d]),e.jsx(Z.input,{type:"radio","aria-hidden":!0,defaultChecked:n,...u,tabIndex:-1,ref:f,style:{...u.style,...b,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Le.displayName=Pt;function $e(t){return t?"checked":"unchecked"}var zt=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],ee="RadioGroup",[Ut,Es]=Ie(ee,[we,qe]),Be=we(),Pe=qe(),[Dt,Qt]=Ut(ee),ze=a.forwardRef((t,s)=>{const{__scopeRadioGroup:n,name:d,defaultValue:u,value:l,required:o=!1,disabled:f=!1,orientation:i,dir:b,loop:h=!0,onValueChange:c,...k}=t,x=Be(n),v=It(b),[m,j]=jt({prop:l,defaultProp:u??null,onChange:c,caller:ee});return e.jsx(Dt,{scope:n,name:d,required:o,disabled:f,value:m,onValueChange:j,children:e.jsx(St,{asChild:!0,...x,orientation:i,dir:v,loop:h,children:e.jsx(Z.div,{role:"radiogroup","aria-required":o,"aria-orientation":i,"data-disabled":f?"":void 0,dir:v,...k,ref:s})})})});ze.displayName=ee;var Ue="RadioGroupItem",De=a.forwardRef((t,s)=>{const{__scopeRadioGroup:n,disabled:d,...u}=t,l=Qt(Ue,n),o=l.disabled||d,f=Be(n),i=Pe(n),b=a.useRef(null),h=de(s,b),c=l.value===u.value,k=a.useRef(!1);return a.useEffect(()=>{const x=m=>{zt.includes(m.key)&&(k.current=!0)},v=()=>k.current=!1;return document.addEventListener("keydown",x),document.addEventListener("keyup",v),()=>{document.removeEventListener("keydown",x),document.removeEventListener("keyup",v)}},[]),e.jsx(Nt,{asChild:!0,...f,focusable:!o,active:c,children:e.jsx(Ve,{disabled:o,required:l.required,checked:c,...i,...u,name:l.name,ref:h,onCheck:()=>l.onValueChange(u.value),onKeyDown:le(x=>{x.key==="Enter"&&x.preventDefault()}),onFocus:le(u.onFocus,()=>{var x;k.current&&((x=b.current)==null||x.click())})})})});De.displayName=Ue;var Jt="RadioGroupIndicator",Qe=a.forwardRef((t,s)=>{const{__scopeRadioGroup:n,...d}=t,u=Pe(n);return e.jsx(Me,{...u,...d,ref:s})});Qe.displayName=Jt;var Je=ze,He=De,Ht=Qe;function me({className:t,...s}){return e.jsx(Je,{className:Ee("grid gap-2",t),...s})}me.displayName=Je.displayName;function pe({className:t,...s}){return e.jsx(He,{className:Ee("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...s,children:e.jsx(Ht,{className:"flex items-center justify-center",children:e.jsx(Rt,{className:"h-2.5 w-2.5 fill-current text-current"})})})}pe.displayName=He.displayName;me.__docgenInfo={description:"",methods:[]};pe.__docgenInfo={description:"",methods:[]};function We({data:t,field:s}){const{t:n}=q(),[d,u]=a.useState(t||[]),[l,o]=a.useState(null),{appId:f}=fe();a.useEffect(()=>{const c=S.getActiveQuery(f).content.find(k=>k.content.field===s.key);if(c){const k=c.content.value;k.length>=1&&o(k[0])}else o(null);u(t||[])},[t]);const i=a.useCallback(c=>{c.key!==l&&c.key!==void 0&&(o(c.key||null),S.updateActiveQueryField(f,{field:s.key,value:[...c.key],merge_strategy:P.OVERRIDE_VALUES}))},[l]),b=a.useCallback(c=>l===c.key,[l]),h=a.useCallback(()=>{o(null)},[l]);return e.jsxs("div",{className:"p-2 w-full max-w-md",children:[e.jsx(me,{children:d.map(c=>e.jsx("div",{className:"space-y-3 pt-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(pe,{value:c.key||"",id:c.key,checked:b(c),onClick:()=>{i(c)}}),e.jsx(ie,{htmlFor:c.key,children:c.key})]}),e.jsx("span",{className:"bg-accent px-2 py-1 rounded-md font-mono text-xs",children:c.count})]})},c.key))}),l!==null&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"my-4 border-border"}),e.jsx("div",{className:"flex align-right justify-end items-center space-x-2",children:e.jsx(T,{onClick:h,size:"xs",children:n("common.filters.buttons.clear")})})]})]})}We.__docgenInfo={description:"",methods:[],displayName:"ToggleFilter",props:{data:{required:!1,tsType:{name:"Array",elements:[{name:"Aggregation"}],raw:"Aggregation[]"},description:""},field:{required:!0,tsType:{name:"AggregationConfig"},description:""}}};function Y({field:t,children:s}){const{t:n}=q(),d=n(`common.filters.labels.${t.translation_key}`,{defaultValue:t.key}),u=`common.filters.labels.${t.translation_key}_tooltip`,l=n(u)===u?null:n(u);function o(){return e.jsx("div",{className:"flex items-center justify-between w-full text-xs",children:e.jsx("span",{children:d})})}return e.jsx(rt,{size:"sm",children:e.jsxs(et,{value:t.key,className:"border-none",children:[e.jsx(ot,{size:"sm",children:e.jsx(tt,{children:l?e.jsxs(at,{children:[e.jsx(lt,{asChild:!0,children:e.jsx("span",{children:o()})}),e.jsx(it,{children:e.jsx("span",{children:l})})]}):o()})}),e.jsx(st,{className:"pb-0",children:s})]},t.key)})}function Ye({field:t,isOpen:s}){const{t:n}=q(),d=t.type;if(d==="divider")return e.jsx("h4",{className:"px-2 h-8 text-sidebar-foreground/70 text-xs font-medium line-height-xs text-ellipsis overflow-hidden flex justify-between items-center",children:n(`common.filters.${t.key}`)});let u;switch(d){case"multiple":u=e.jsx(Y,{field:t,isOpen:s,children:e.jsx(Ce,{field:t})});break;case"numerical":u=e.jsx(Y,{field:t,isOpen:s,children:e.jsx(Oe,{field:t})});break;case"boolean":u=e.jsx(Y,{field:t,isOpen:s,children:e.jsx(We,{field:t})});break;default:u=e.jsx("div",{children:n("common.filters.unsupported_type",{type:t.type})})}return u}Y.__docgenInfo={description:"",methods:[],displayName:"AccordionContainer",props:{field:{required:!0,tsType:{name:"AggregationConfig"},description:""},isOpen:{required:!0,tsType:{name:"boolean"},description:""},searchHandler:{required:!1,tsType:{name:"signature",type:"function",raw:"(_e: React.MouseEvent<SVGElement, MouseEvent>) => void",signature:{arguments:[{type:{name:"ReactMouseEvent",raw:"React.MouseEvent<SVGElement, MouseEvent>",elements:[{name:"SVGElement"},{name:"MouseEvent"}]},name:"_e"}],return:{name:"void"}}},description:""},children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};Ye.__docgenInfo={description:"To be use when the filter needs to be inside an Accordion component",methods:[],displayName:"FilterContainer",props:{field:{required:!0,tsType:{name:"AggregationConfig"},description:""},isOpen:{required:!0,tsType:{name:"boolean"},description:""},searchHandler:{required:!1,tsType:{name:"signature",type:"function",raw:"(_e: React.MouseEvent<SVGElement, MouseEvent>) => void",signature:{arguments:[{type:{name:"ReactMouseEvent",raw:"React.MouseEvent<SVGElement, MouseEvent>",elements:[{name:"SVGElement"},{name:"MouseEvent"}]},name:"_e"}],return:{name:"void"}}},description:""}}};const Ke=a.createContext({appId:ce.variant_entity,aggregations:{},clearUnappliedFilters:()=>{}}),fe=()=>{const t=a.useContext(Ke);if(!t)throw new Error("useFilterConfig must be used within a FilterConfigProvider");return t};function Xe(t){return`temp-filters-${t}`}function Wt({groupKey:t,appId:s,aggregations:n}){var x;const{t:d}=q(),[u,l]=a.useState(!1),[o,f]=a.useState([]),[i,b]=a.useState(t),h=Xe(s),c=()=>{sessionStorage.removeItem(h)},k=t?((x=n[t])==null?void 0:x.items)||[]:Object.values(n).flatMap(v=>v.items);return a.useEffect(()=>{l(!1),f([])},[t]),a.useEffect(()=>{(i&&i!==null&&t===null||i&&i!==null&&t&&t!==null&&i!==t)&&c(),b(t)},[t,i]),e.jsx(Ke,{value:{appId:s,aggregations:n,clearUnappliedFilters:c},children:e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(T,{variant:"link",size:"xs",onClick:()=>{const v=!u;l(v),f(v?k.map(m=>m.key):[])},children:d(u?"common.actions.collapse_all":"common.actions.expand_all")})}),e.jsx(nt,{className:"flex flex-col gap-1",type:"multiple",value:o,onValueChange:v=>f(v),children:k.map((v,m)=>e.jsx(Ye,{isOpen:o.includes(v.key),field:v},`${v.key}-${m}`))})]})})}Wt.__docgenInfo={description:"",methods:[],displayName:"FilterList",props:{groupKey:{required:!1,tsType:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},description:""},aggregations:{required:!0,tsType:{name:"signature",type:"object",raw:`{
  [key: string]: AggregationGroup;
}`,signature:{properties:[{key:{name:"string"},value:{name:"AggregationGroup",required:!0}}]}},description:""},appId:{required:!0,tsType:{name:"ApplicationId"},description:""}}};export{Wt as F,Ce as M,Oe as N,We as T,Vt as u};
