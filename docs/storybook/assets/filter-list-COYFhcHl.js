import{j as e}from"./jsx-runtime-D_zvdyIk.js";import{R as ge,r as o}from"./index-CGj_12n1.js";import{A as Ke,a as Xe,b as Ze,c as et}from"./accordion-DPra3b9Q.js";import{B as T}from"./button-DSoXSpfX.js";import{d as _e,e as be,C as tt,a as st}from"./card-CVaWHAcA.js";import{T as nt,a as rt,b as ot}from"./tooltip-anNhU4TT.js";import{A as at}from"./action-button-DglMD9AQ.js";import"./button.variants-Du9eY_ux.js";import{C as lt}from"./checkbox-filter-CLNLTy1D.js";import{I as P}from"./input-Dm5winle.js";import{L as oe}from"./label-ymyzYynk.js";import{S as it}from"./separator-IJKoE26K.js";import{S as J}from"./skeleton-Shk8p_SP.js";import{S as ct}from"./switch-Eyi4i66A.js";import{u as O}from"./i18n-BkE9nHHN.js";import{q as R,D as ke}from"./query-builder-remote-BtE0apCE.js";import{M as L,T as D,R as N}from"./sqon-roF4SsTV.js";import{A as ae}from"./applications-config-DwuB3Ut-.js";import{u as je,o as H}from"./api-Cqt9YNyl.js";import{S as dt}from"./search-DqA1hdnz.js";import{E as ut,L as mt,G as pt,a as ft,b as ht,c as xt}from"./less-than-or-equal-operator-icon-BI5aNTvi.js";import{c as yt}from"./index-C66Dxnp2.js";import{C as vt}from"./checkbox-CuLJw5hI.js";import{d as pe,S as fe,a as he,b as xe,c as ye}from"./select-WOQZTtP8.js";import{a as gt,c as Se,b as re}from"./index-CcLUv2_A.js";import{P as W,u as le}from"./index-B7CJuYpG.js";import{i as Ne,R as _t,I as bt,C as kt}from"./dropdown-menu-CxUCUeqn.js";import{u as jt}from"./index-C8qycyLa.js";import{u as St}from"./index-A6VgBoaw.js";import{u as Nt}from"./index-qxuqJ0RB.js";import{P as Rt}from"./index-CRLeYu_h.js";import{c as Re}from"./utils-D-KgF5mV.js";const Ie=ge.createContext({caseId:"1",seqId:"1"}),It=t=>{switch(t){case ae.cnv_occurrence:return s=>H.aggregateGermlineCNVOccurrences(s.caseId,s.seqId,s.aggregationBody).then(n=>n.data);default:return s=>H.aggregateGermlineSNVOccurrences(s.caseId,s.seqId,s.aggregationBody,s.withDictionary).then(n=>n.data)}};function Et(t,s=30,n=!1,d=!1,u){let r;const{caseId:p,seqId:a}=ge.useContext(Ie);n?r={caseId:p,seqId:a,aggregationBody:{field:t,size:s},withDictionary:d}:r=null;const y=R.getResolvedActiveQuery(u);return y&&r&&(r.aggregationBody.sqon={content:y.content,op:y.op}),je(r,It(u),{revalidateOnFocus:!1})}function wt(t,s){const n=t.toLowerCase().split(/\s+/).filter(Boolean);return s.filter(d=>{const u=d.key.toLowerCase(),r=d.label.toLowerCase();function p(a,y){let k=0;for(const m of y){const i=a.indexOf(m,k);if(i===-1)return!1;k=i+m.length}return!0}return p(u,n)||p(r,n)})}function ne(t,s){return s<t?s:t}function At(t,s){return!!(R.getResolvedActiveQuery(t).content.find(d=>d.content.field===s.key)&&s.withDictionary)}function Ee({field:t,maxVisibleItems:s=5}){const{t:n,sanitize:d,lazyTranslate:u}=O(),{appId:r,clearUnappliedFilters:p}=ue(),a=We(r),[y,k]=o.useState(At(r,t)),{data:m,isLoading:i}=Et(t.key,void 0,!0,y,r),b=()=>{try{const l=sessionStorage.getItem(a);if(l){const A=JSON.parse(l)[t.key];if(A)return A}}catch{}const h=R.getResolvedActiveQuery(r).content.find(l=>l.content.field===t.key);return(h==null?void 0:h.content.value)||[]},[f,g]=o.useState(m||[]),[c,j]=o.useState(b()),[C,E]=o.useState(ne(f.length,s)),[q,I]=o.useState(!1),[B,V]=o.useState(!1),[S,_]=o.useState("");o.useEffect(()=>{const h=R.getResolvedActiveQuery(r),x=JSON.stringify(h);if(S&&S!==x){p();const l=R.getResolvedActiveQuery(r).content.find(A=>A.content.field===t.key),v=(l==null?void 0:l.content.value)||[];j(v)}_(x)},[r,t.key,p,S]),o.useEffect(()=>{const h=R.getResolvedActiveQuery(r).content.find(v=>v.content.field===t.key),x=(h==null?void 0:h.content.value)||[],l=JSON.stringify([...c].sort())!==JSON.stringify([...x].sort());I(l),c.length===0&&x.length>0&&!B&&j(x),c.length>0&&B&&V(!1),m==null||m.sort((v,A)=>{const me=v.key&&c.includes(v.key),Ye=A.key&&c.includes(A.key);return me===Ye?A.count-v.count:me?-1:1}),m==null||m.forEach(v=>{v.label=n(`common.filters.values.${t.key}.${d(v.key)}`,{defaultValue:u(v.key)})}),g(m||[]),E(ne((m==null?void 0:m.length)||0,s))},[m,r,t.key,s,c]),o.useEffect(()=>{if(c.length>0)try{const h=sessionStorage.getItem(a)||"{}",x=JSON.parse(h);x[t.key]=c,sessionStorage.setItem(a,JSON.stringify(x))}catch{}else try{const h=sessionStorage.getItem(a);if(h){const x=JSON.parse(h);delete x[t.key],Object.keys(x).length===0?sessionStorage.removeItem(a):sessionStorage.setItem(a,JSON.stringify(x))}}catch{}},[c,a,t.key]),o.useEffect(()=>{const h=()=>{sessionStorage.removeItem(a)};return window.addEventListener("beforeunload",h),()=>{window.removeEventListener("beforeunload",h)}},[a]);const K=o.useCallback(h=>{if(!h.trim()){g(m||[]),E(ne((m==null?void 0:m.length)||0,s));return}const x=wt(h,m);s>x.length?E(x.length):x.length>s&&E(s),g(x)},[m,s]),z=o.useCallback(()=>{E(f.length)},[C,f]),G=o.useCallback(()=>{E(s)},[C]),M=o.useCallback(()=>{c.length!==f.length&&(I(!0),j(f.map(h=>h.key)))},[f,c]),F=o.useCallback(()=>{I(!0),j([]),V(!0);try{const h=sessionStorage.getItem(a);if(h){const x=JSON.parse(h);delete x[t.key],Object.keys(x).length===0?sessionStorage.removeItem(a):sessionStorage.setItem(a,JSON.stringify(x))}}catch{}},[a,t.key]),X=o.useCallback(()=>{c.length!==0&&F()},[c,F]),Z=o.useCallback(h=>{let x=[];c.some(l=>l===h.key)?x=c.filter(l=>l!==h.key):x=[...c,h.key],I(!0),j(x)},[c]),ee=o.useCallback(()=>{F()},[F]),w=o.useCallback(h=>{I(!1),V(!1),R.updateActiveQueryField(r,{field:t.key,value:[...c],merge_strategy:L.OVERRIDE_VALUES,operator:h}),p()},[c,r,t.key,p]),te=o.useCallback(()=>{w(D.In)},[w]),se=o.useCallback(()=>{w(D.NotIn)},[w]),$=o.useCallback(()=>{w(D.All)},[w]),U=o.useCallback(()=>{w(D.In)},[w]);return e.jsxs(e.Fragment,{children:[e.jsxs(_e,{size:"sm",variant:"outline",children:[e.jsx(P,{startIcon:dt,size:"xs",type:"text",placeholder:n("common.filters.search.placeholder"),className:"w-full text-xs py-1.5 px-3 mb-4 border border-border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",onChange:h=>K(h.target.value),autoFocus:!0}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(T,{size:"xs",onClick:()=>M(),variant:"link",className:"px-0",children:n("common.filters.buttons.all")}),e.jsx(it,{orientation:"vertical",className:"h-4"}),e.jsx(T,{size:"xs",onClick:()=>X(),variant:"link",className:"px-0",children:n("common.filters.buttons.none")}),t.withDictionary&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex-grow"}),e.jsx(oe,{htmlFor:"with-dictionary-switch",className:"text-xs",children:n("common.filters.with_dictionary")}),e.jsx(ct,{id:"with-dictionary-switch",checked:y,size:"xs",onCheckedChange:()=>k(!y)})]})]}),e.jsxs("div",{className:"max-h-[250px] overflow-auto",children:[i&&Array.from({length:3},(h,x)=>e.jsxs("div",{className:"flex justify-between items-center py-2 space-x-2",children:[e.jsx(J,{className:"w-full h-6 rounded"}),e.jsx(J,{className:"h-6 w-12 rounded-md"})]},`skeleton-${x}`)),!i&&f.length===0&&e.jsx("div",{className:"text-muted-foreground py-4",children:n("common.filters.no_values_found")}),!i&&f.length>0&&Array.from({length:C},(h,x)=>e.jsx("div",{className:"gap-3 py-1.5",children:e.jsx(lt,{size:"xs",label:n(`common.filters.labels.${t.key}_value.${f[x].key}`,{defaultValue:f[x].label}),checked:c.some(l=>l===f[x].key),count:f[x].count,onCheckedChange:()=>Z(f[x])})},f[x].key))]}),!i&&f.length>C&&e.jsx(T,{className:"mt-2 px-0",onClick:z,size:"xs",variant:"link",children:n("common.filters.buttons.show_more",{count:f.length-s})}),!i&&C>s&&e.jsx(T,{className:"mt-2 px-0",onClick:G,size:"xs",variant:"link",children:n("common.filters.buttons.show_less")})]}),e.jsx(be,{size:"sm",children:e.jsxs("div",{className:"flex align-right justify-end items-center space-x-2",children:[e.jsx(T,{size:"xxs",variant:"ghost",onClick:ee,disabled:c.length===0||i,children:n("common.filters.buttons.clear")}),e.jsx("div",{className:"flex space-x-2",children:e.jsx(at,{size:"xxs",variant:"outline",className:"h-7",color:"primary",actions:[{label:n("common.filters.buttons.some_not_in"),onClick:U},{label:n("common.filters.buttons.all"),onClick:$},{label:n("common.filters.buttons.not_in"),onClick:se}],onDefaultAction:te,disabled:!q||i,children:n("common.filters.buttons.apply")})})]})})]})}Ee.__docgenInfo={description:"",methods:[],displayName:"MultiSelectFilter",props:{field:{required:!0,tsType:{name:"AggregationConfig"},description:""},maxVisibleItems:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"5",computed:!1}}}};const Ct=yt({slots:{base:"text-muted-foreground"},variants:{size:{xs:{base:"text-xs"},sm:{base:"text-sm"}}},defaultVariants:{size:"sm"}});function we({className:t,size:s,children:n}){const d=Ct({size:s});return e.jsx("p",{className:d.base({className:t}),children:n})}we.__docgenInfo={description:"",methods:[],displayName:"TextMuted"};const Ae="integer",Tt=t=>{switch(t){case ae.cnv_occurrence:return s=>H.statisticsGermlineCNVOccurrences(s.seqId,s.statisticsBody).then(n=>n.data);default:return s=>H.statisticsGermlineSNVOccurrences(s.seqId,s.statisticsBody).then(n=>n.data)}};function Ft(t,s,n,d=!1){const u={seqId:n,statisticsBody:{field:t}},r=d?ke:R.getResolvedActiveQuery(s);return r&&(u.statisticsBody.sqon={content:r.content,op:r.op}),je(u,Tt(s),{revalidateOnFocus:!1})}function ve(t,s,n,d){var g;let u=!1,r=N.LessThan,p="0",a="0",y="",k=!1;const m=(d==null?void 0:d.type)===Ae?0:3,i=s.content.find(c=>"content"in c&&"field"in c.content?c.content.field===t:!1),b=s.content.find(c=>"content"in c&&"field"in c.content?c.content.field===`${t}_unit`:!1);if(i){const c=i.content.value;if(console.log("[NumericalFilter] values",c),c.includes("__missing__"))return{hasUnappliedItems:u,selectedRange:r,minValue:p,maxValue:a,numericalValue:y,hasNoData:!0,selectedUnit:void 0};u=!0,c.length===2?(r=N.Between,p=Number(c[0]).toFixed(m),a=Number(c[1]).toFixed(m)):y=c[0],i.op&&(r=i.op)}else console.log("[NumericalFilter else] no filter exists",n),k=!1,(n==null?void 0:n.defaultMin)!==void 0?(p=n.defaultMin.toString(),y=n.defaultMin.toString()):(d==null?void 0:d.min)!==void 0&&(p=Number(d.min.toFixed(m)).toString(),y=Number(d.min.toFixed(m)).toString()),(n==null?void 0:n.defaultMax)!==void 0?a=n.defaultMax.toString():(d==null?void 0:d.max)!==void 0&&(a=Number(d.max.toFixed(m)).toString()),n!=null&&n.defaultOperator&&(r=N[n.defaultOperator]);let f;return b&&b.content.value[0]&&((g=n==null?void 0:n.rangeTypes)!=null&&g.length)&&(f=n.rangeTypes[0].key),{hasUnappliedItems:u,selectedRange:r,minValue:p,maxValue:a,numericalValue:y,hasNoData:k,selectedUnit:f}}function Ce({field:t}){var $,U,h,x;const{t:s}=O(),{appId:n,aggregations:d}=ue(),{seqId:u}=o.useContext(Ie),r=t.key,p={[N.GreaterThan]:{display:s("common.filters.operators.greater_than"),dropdown:s("common.filters.operators.greater_than"),icon:xt},[N.LessThan]:{display:s("common.filters.operators.less_than"),dropdown:s("common.filters.operators.less_than"),icon:ht},[N.Between]:{display:s("common.filters.operators.between"),dropdown:s("common.filters.operators.between"),icon:ft},[N.GreaterThanOrEqualTo]:{display:s("common.filters.operators.greater_than_or_equal"),dropdown:s("common.filters.operators.greater_than_or_equal"),icon:pt},[N.LessThanOrEqualTo]:{display:s("common.filters.operators.less_than_or_equal"),dropdown:s("common.filters.operators.less_than_or_equal"),icon:mt},[N.In]:{display:s("common.filters.operators.in"),dropdown:s("common.filters.operators.in"),icon:ut}},{data:a,isLoading:y}=Ft(r,n,u,!1),k=(a==null?void 0:a.type)===Ae?0:3,[m,i]=o.useState(N.GreaterThan),[b,f]=o.useState("0"),[g,c]=o.useState("0"),[j,C]=o.useState("0"),[E,q]=o.useState(!1),[I,B]=o.useState(),[V,S]=o.useState(!1),_=($=Object.values(d).flatMap(l=>l.items).find(l=>l.key===r))==null?void 0:$.defaults,K=t.type==="numerical"&&(_==null?void 0:_.noDataInputOption),z=(_==null?void 0:_.intervalDecimal)!==void 0&&((_==null?void 0:_.max)!==void 0||(_==null?void 0:_.min)!==void 0)||a&&(a.min!==void 0||a.max!==void 0),G=(_==null?void 0:_.min)??(a==null?void 0:a.min)??0,M=(_==null?void 0:_.max)??(a==null?void 0:a.max)??100,F=o.useCallback(()=>{const l=R.getResolvedActiveQuery(n);if(!(l!=null&&l.content))return;const v=ve(r,l,_,a);q(v.hasNoData),C(v.minValue),c(v.maxValue),S(v.hasUnappliedItems),i(v.selectedRange??N.GreaterThan),f(v.numericalValue)},[n,r,_,a]);o.useEffect(()=>{F()},[F]);const X=o.useCallback(l=>{i(l),S(!0)},[]),Z=o.useCallback(l=>{q(l),S(!0)},[]),ee=o.useCallback(l=>{B(l),S(!0)},[]),w=()=>{S(!1);const l=ve(r,ke,_,a);q(l.hasNoData),C(l.minValue),c(l.maxValue),S(l.hasUnappliedItems),i(l.selectedRange),f(l.numericalValue)},te=o.useCallback(()=>{if(S(!1),E){R.updateActiveQueryField(n,{field:r,value:["__missing__"],merge_strategy:L.OVERRIDE_VALUES});return}let l=[];l=m===N.Between?[parseFloat(j.toString()),parseFloat(g.toString())]:[parseFloat(b.toString())],R.updateActiveQueryField(n,{field:r,value:l,merge_strategy:L.OVERRIDE_VALUES,operator:m}),I&&R.updateActiveQueryField(n,{field:`${r}_unit`,value:[I],merge_strategy:L.OVERRIDE_VALUES})},[n,r,m,b,j,g,E,I]),se=Object.entries(N).map(([l,v])=>{if(v in p){const A=p[v].icon;return e.jsx(pe,{value:v,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{size:16}),e.jsx("span",{children:p[v].dropdown})]})},v)}return null}).filter(Boolean);return e.jsxs(e.Fragment,{children:[e.jsx(_e,{id:`${r}_container`,size:"sm",variant:"outline",children:e.jsxs("div",{className:"pt-2",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("div",{id:`${r}_operator`,children:e.jsxs(fe,{value:m,onValueChange:X,children:[e.jsx(he,{size:"sm",children:e.jsx(xe,{placeholder:s("common.filters.operators.select_operator"),children:p[m].display})}),e.jsx(ye,{children:se})]})}),m===N.Between?e.jsxs("div",{className:"flex gap-2 flex-row",children:[e.jsx(P,{size:"xs",className:"w-half",value:j,onChange:l=>{const v=l.target.value;isNaN(Number(v))||(C(v),S(!0))},min:G,max:M,id:`${r}_min`,"data-testid":`${r}_min`}),e.jsx(P,{size:"xs",className:"w-half",value:g,onChange:l=>{const v=l.target.value;isNaN(Number(v))||(c(v),S(!0))},min:G,max:M,id:`${r}_max`,"data-testid":`${r}_max`})]}):e.jsx(P,{size:"xs",className:"w-full",value:b,onChange:l=>{const v=l.target.value;isNaN(Number(v))||(f(v),S(!0))},min:G,max:M,id:`${r}_value`,"data-testid":`${r}_value`}),z&&e.jsx("div",{id:`${r}_interval`,children:e.jsxs(we,{size:"xs",children:[s("common.filters.labels.actual_interval")," : ",(U=a==null?void 0:a.min)==null?void 0:U.toFixed(k)," -"," ",(h=a==null?void 0:a.max)==null?void 0:h.toFixed(k)]})})]}),(_==null?void 0:_.rangeTypes)&&_.rangeTypes.length>0&&e.jsx("div",{id:`${r}_range_type_container`,children:y?e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"h-5 w-16 mb-1",id:`${r}_unit_label_skeleton`}),e.jsx(J,{className:"h-9 w-full",id:`${r}_select_skeleton`})]}):e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"text-sm",id:`${r}_unit_label`,children:s("common.filters.labels.unit")}),e.jsxs(fe,{defaultValue:I||_.rangeTypes[0].key,onValueChange:ee,children:[e.jsx(he,{children:e.jsx(xe,{placeholder:s("common.filters.labels.select_unit"),children:((x=_.rangeTypes.find(l=>l.key===I))==null?void 0:x.name)||s("common.filters.labels.select_unit")})}),e.jsx(ye,{children:_.rangeTypes.map(l=>e.jsx(pe,{value:l.key,children:l.name},l.key))})]})]})}),K&&!z&&e.jsxs("label",{className:"flex items-center space-x-2 overflow-hidden",id:`${r}_no_data_label`,children:[e.jsx(vt,{checked:E,onCheckedChange:Z,id:`${r}_no_data`}),e.jsx("span",{children:s("common.filters.labels.no_data")})]})]})}),e.jsx(be,{size:"sm",children:e.jsxs("div",{className:"flex align-right justify-end items-center space-x-2",children:[e.jsx(T,{size:"xxs",variant:"ghost",onClick:w,disabled:!V,id:`${r}_clear`,children:s("common.filters.buttons.clear")}),e.jsx("div",{className:"flex space-x-2",children:e.jsx(T,{size:"xxs",variant:"outline",onClick:te,id:`${r}_apply`,children:s("common.filters.buttons.apply")})})]})})]})}Ce.__docgenInfo={description:"",methods:[],displayName:"NumericalFilter",props:{field:{required:!0,tsType:{name:"AggregationConfig"},description:""}}};var ie="Radio",[Ot,Te]=Se(ie),[qt,Vt]=Ot(ie),Fe=o.forwardRef((t,s)=>{const{__scopeRadio:n,name:d,checked:u=!1,required:r,disabled:p,value:a="on",onCheck:y,form:k,...m}=t,[i,b]=o.useState(null),f=le(s,j=>b(j)),g=o.useRef(!1),c=i?k||!!i.closest("form"):!0;return e.jsxs(qt,{scope:n,checked:u,disabled:p,children:[e.jsx(W.button,{type:"button",role:"radio","aria-checked":u,"data-state":Ge(u),"data-disabled":p?"":void 0,disabled:p,value:a,...m,ref:f,onClick:re(t.onClick,j=>{u||y==null||y(),c&&(g.current=j.isPropagationStopped(),g.current||j.stopPropagation())})}),c&&e.jsx(Ve,{control:i,bubbles:!g.current,name:d,value:a,checked:u,required:r,disabled:p,form:k,style:{transform:"translateX(-100%)"}})]})});Fe.displayName=ie;var Oe="RadioIndicator",qe=o.forwardRef((t,s)=>{const{__scopeRadio:n,forceMount:d,...u}=t,r=Vt(Oe,n);return e.jsx(Rt,{present:d||r.checked,children:e.jsx(W.span,{"data-state":Ge(r.checked),"data-disabled":r.disabled?"":void 0,...u,ref:s})})});qe.displayName=Oe;var Gt="RadioBubbleInput",Ve=o.forwardRef(({__scopeRadio:t,control:s,checked:n,bubbles:d=!0,...u},r)=>{const p=o.useRef(null),a=le(p,r),y=Nt(n),k=St(s);return o.useEffect(()=>{const m=p.current;if(!m)return;const i=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(i,"checked").set;if(y!==n&&f){const g=new Event("click",{bubbles:d});f.call(m,n),m.dispatchEvent(g)}},[y,n,d]),e.jsx(W.input,{type:"radio","aria-hidden":!0,defaultChecked:n,...u,tabIndex:-1,ref:a,style:{...u.style,...k,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Ve.displayName=Gt;function Ge(t){return t?"checked":"unchecked"}var Mt=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Y="RadioGroup",[Lt,js]=Se(Y,[Ne,Te]),Me=Ne(),Le=Te(),[Bt,zt]=Lt(Y),Be=o.forwardRef((t,s)=>{const{__scopeRadioGroup:n,name:d,defaultValue:u,value:r,required:p=!1,disabled:a=!1,orientation:y,dir:k,loop:m=!0,onValueChange:i,...b}=t,f=Me(n),g=jt(k),[c,j]=gt({prop:r,defaultProp:u??null,onChange:i,caller:Y});return e.jsx(Bt,{scope:n,name:d,required:p,disabled:a,value:c,onValueChange:j,children:e.jsx(_t,{asChild:!0,...f,orientation:y,dir:g,loop:m,children:e.jsx(W.div,{role:"radiogroup","aria-required":p,"aria-orientation":y,"data-disabled":a?"":void 0,dir:g,...b,ref:s})})})});Be.displayName=Y;var ze="RadioGroupItem",$e=o.forwardRef((t,s)=>{const{__scopeRadioGroup:n,disabled:d,...u}=t,r=zt(ze,n),p=r.disabled||d,a=Me(n),y=Le(n),k=o.useRef(null),m=le(s,k),i=r.value===u.value,b=o.useRef(!1);return o.useEffect(()=>{const f=c=>{Mt.includes(c.key)&&(b.current=!0)},g=()=>b.current=!1;return document.addEventListener("keydown",f),document.addEventListener("keyup",g),()=>{document.removeEventListener("keydown",f),document.removeEventListener("keyup",g)}},[]),e.jsx(bt,{asChild:!0,...a,focusable:!p,active:i,children:e.jsx(Fe,{disabled:p,required:r.required,checked:i,...y,...u,name:r.name,ref:m,onCheck:()=>r.onValueChange(u.value),onKeyDown:re(f=>{f.key==="Enter"&&f.preventDefault()}),onFocus:re(u.onFocus,()=>{var f;b.current&&((f=k.current)==null||f.click())})})})});$e.displayName=ze;var $t="RadioGroupIndicator",Ue=o.forwardRef((t,s)=>{const{__scopeRadioGroup:n,...d}=t,u=Le(n);return e.jsx(qe,{...u,...d,ref:s})});Ue.displayName=$t;var De=Be,Pe=$e,Ut=Ue;function ce({className:t,...s}){return e.jsx(De,{className:Re("grid gap-2",t),...s})}ce.displayName=De.displayName;function de({className:t,...s}){return e.jsx(Pe,{className:Re("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...s,children:e.jsx(Ut,{className:"flex items-center justify-center",children:e.jsx(kt,{className:"h-2.5 w-2.5 fill-current text-current"})})})}de.displayName=Pe.displayName;ce.__docgenInfo={description:"",methods:[]};de.__docgenInfo={description:"",methods:[]};function Qe({data:t,field:s}){const{t:n}=O(),[d,u]=o.useState(t||[]),[r,p]=o.useState(null),{appId:a}=ue();o.useEffect(()=>{const i=R.getActiveQuery(a).content.find(b=>b.content.field===s.key);if(i){const b=i.content.value;b.length>=1&&p(b[0])}else p(null);u(t||[])},[t]);const y=o.useCallback(i=>{i.key!==r&&i.key!==void 0&&(p(i.key||null),R.updateActiveQueryField(a,{field:s.key,value:[...i.key],merge_strategy:L.OVERRIDE_VALUES}))},[r]),k=o.useCallback(i=>r===i.key,[r]),m=o.useCallback(()=>{p(null)},[r]);return e.jsxs("div",{className:"p-2 w-full max-w-md",children:[e.jsx(ce,{children:d.map(i=>e.jsx("div",{className:"space-y-3 pt-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(de,{value:i.key||"",id:i.key,checked:k(i),onClick:()=>{y(i)}}),e.jsx(oe,{htmlFor:i.key,children:i.key})]}),e.jsx("span",{className:"bg-accent px-2 py-1 rounded-md font-mono text-xs",children:i.count})]})},i.key))}),r!==null&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"my-4 border-border"}),e.jsx("div",{className:"flex align-right justify-end items-center space-x-2",children:e.jsx(T,{onClick:m,size:"xs",children:n("common.filters.buttons.clear")})})]})]})}Qe.__docgenInfo={description:"",methods:[],displayName:"ToggleFilter",props:{data:{required:!1,tsType:{name:"Array",elements:[{name:"Aggregation"}],raw:"Aggregation[]"},description:""},field:{required:!0,tsType:{name:"AggregationConfig"},description:""}}};function Q({field:t,children:s}){const{t:n}=O(),d=n(`common.filters.labels.${t.translation_key}`,{defaultValue:t.key}),u=`common.filters.labels.${t.translation_key}_tooltip`,r=n(u)===u?null:n(u);function p(){return e.jsx("div",{className:"flex items-center justify-between w-full text-xs",children:e.jsx("span",{children:d})})}return e.jsx(tt,{size:"sm",children:e.jsxs(Ke,{value:t.key,className:"border-none",children:[e.jsx(st,{size:"sm",children:e.jsx(Xe,{children:r?e.jsxs(nt,{children:[e.jsx(rt,{asChild:!0,children:e.jsx("span",{children:p()})}),e.jsx(ot,{children:e.jsx("span",{children:r})})]}):p()})}),e.jsx(Ze,{className:"pb-0",children:s})]},t.key)})}function Je({field:t,isOpen:s}){const{t:n}=O(),d=t.type;if(d==="divider")return e.jsx("h4",{className:"mx-1 my-3 mt-5 text-sidebar-foreground text-xs font-medium line-height-xs text-ellipsis overflow-hidden",children:n(`common.filters.${t.key}`)});let u;switch(d){case"multiple":u=e.jsx(Q,{field:t,isOpen:s,children:e.jsx(Ee,{field:t})});break;case"numerical":u=e.jsx(Q,{field:t,isOpen:s,children:e.jsx(Ce,{field:t})});break;case"boolean":u=e.jsx(Q,{field:t,isOpen:s,children:e.jsx(Qe,{field:t})});break;default:u=e.jsx("div",{children:n("common.filters.unsupported_type",{type:t.type})})}return u}Q.__docgenInfo={description:"",methods:[],displayName:"AccordionContainer",props:{field:{required:!0,tsType:{name:"AggregationConfig"},description:""},isOpen:{required:!0,tsType:{name:"boolean"},description:""},searchHandler:{required:!1,tsType:{name:"signature",type:"function",raw:"(_e: React.MouseEvent<SVGElement, MouseEvent>) => void",signature:{arguments:[{type:{name:"ReactMouseEvent",raw:"React.MouseEvent<SVGElement, MouseEvent>",elements:[{name:"SVGElement"},{name:"MouseEvent"}]},name:"_e"}],return:{name:"void"}}},description:""},children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};Je.__docgenInfo={description:"To be use when the filter needs to be inside an Accordion component",methods:[],displayName:"FilterContainer",props:{field:{required:!0,tsType:{name:"AggregationConfig"},description:""},isOpen:{required:!0,tsType:{name:"boolean"},description:""},searchHandler:{required:!1,tsType:{name:"signature",type:"function",raw:"(_e: React.MouseEvent<SVGElement, MouseEvent>) => void",signature:{arguments:[{type:{name:"ReactMouseEvent",raw:"React.MouseEvent<SVGElement, MouseEvent>",elements:[{name:"SVGElement"},{name:"MouseEvent"}]},name:"_e"}],return:{name:"void"}}},description:""}}};const He=o.createContext({appId:ae.variant_entity,aggregations:{},clearUnappliedFilters:()=>{}}),ue=()=>{const t=o.useContext(He);if(!t)throw new Error("useFilterConfig must be used within a FilterConfigProvider");return t};function We(t){return`temp-filters-${t}`}function Dt({groupKey:t,appId:s,aggregations:n}){var f;const{t:d}=O(),[u,r]=o.useState(!1),[p,a]=o.useState([]),[y,k]=o.useState(t),m=We(s),i=()=>{sessionStorage.removeItem(m)},b=t?((f=n[t])==null?void 0:f.items)||[]:Object.values(n).flatMap(g=>g.items);return o.useEffect(()=>{r(!1),a([])},[t]),o.useEffect(()=>{(y&&y!==null&&t===null||y&&y!==null&&t&&t!==null&&y!==t)&&i(),k(t)},[t,y]),e.jsx(He,{value:{appId:s,aggregations:n,clearUnappliedFilters:i},children:e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(T,{variant:"link",size:"xs",onClick:()=>{const g=!u;r(g),a(g?b.map(c=>c.key):[])},children:d(u?"common.actions.collapse_all":"common.actions.expand_all")})}),e.jsx(et,{className:"flex flex-col gap-1",type:"multiple",value:p,onValueChange:g=>a(g),children:b.map((g,c)=>e.jsx(Je,{isOpen:p.includes(g.key),field:g},`${g.key}-${c}`))})]})})}Dt.__docgenInfo={description:"",methods:[],displayName:"FilterList",props:{groupKey:{required:!1,tsType:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},description:""},aggregations:{required:!0,tsType:{name:"signature",type:"object",raw:`{
  [key: string]: AggregationGroup;
}`,signature:{properties:[{key:{name:"string"},value:{name:"AggregationGroup",required:!0}}]}},description:""},appId:{required:!0,tsType:{name:"ApplicationId"},description:""}}};export{Dt as F,Ee as M,Ce as N,Qe as T};
