import{j as e}from"./jsx-runtime-D_zvdyIk.js";import{R as ye,r as o}from"./index-CGj_12n1.js";import{A as Ke,a as We,b as Ye,c as Xe}from"./accordion-DPra3b9Q.js";import{B as A}from"./button-DyacC5UV.js";import{d as ve,e as _e,C as Je,a as Ze}from"./card-CVaWHAcA.js";import{T as et,a as tt,b as st}from"./tooltip-anNhU4TT.js";import{A as nt}from"./action-button-DglMD9AQ.js";import"./button.variants-Du9eY_ux.js";import{C as rt}from"./checkbox-filter-CLNLTy1D.js";import{I as D}from"./input-Dm5winle.js";import{L as te}from"./label-ymyzYynk.js";import{S as ot}from"./separator-IJKoE26K.js";import{S as P}from"./skeleton-Shk8p_SP.js";import{S as at}from"./switch-Eyi4i66A.js";import{u as F}from"./i18n-CEw0qcYN.js";import{q as w,D as je}from"./query-builder-remote-C0kWggeK.js";import{M as q,T as $,R as N}from"./sqon-CW3OBTBo.js";import{A as se}from"./applications-config-DwuB3Ut-.js";import{u as be,o as U}from"./api-9Y-6a0RU.js";import{S as lt}from"./search-DqA1hdnz.js";import{E as it,L as ct,G as dt,a as ut,b as mt,c as pt}from"./less-than-or-equal-operator-icon-BI5aNTvi.js";import{c as ft}from"./index-C66Dxnp2.js";import{C as ht}from"./checkbox-CuLJw5hI.js";import{d as ue,S as me,a as pe,b as fe,c as he}from"./select-WOQZTtP8.js";import{a as xt,c as ke,b as ee}from"./index-CcLUv2_A.js";import{P as Q,u as ne}from"./index-B7CJuYpG.js";import{i as ge,R as yt,I as vt,C as _t}from"./dropdown-menu-CxUCUeqn.js";import{u as jt}from"./index-C8qycyLa.js";import{u as bt}from"./index-A6VgBoaw.js";import{u as kt}from"./index-qxuqJ0RB.js";import{P as gt}from"./index-CRLeYu_h.js";import{c as Ne}from"./utils-D-KgF5mV.js";const Re=ye.createContext({caseId:"1",seqId:"1"}),Nt=r=>{switch(r){case se.cnv_occurrence:return t=>U.aggregateGermlineCNVOccurrences(t.caseId,t.seqId,t.aggregationBody).then(s=>s.data);default:return t=>U.aggregateGermlineSNVOccurrences(t.caseId,t.seqId,t.aggregationBody,t.withDictionary).then(s=>s.data)}};function Rt(r,t=30,s=!1,i=!1,c){let n;const{caseId:m,seqId:l}=ye.useContext(Re);s?n={caseId:m,seqId:l,aggregationBody:{field:r,size:t},withDictionary:i}:n=null;const d=w.getResolvedActiveQuery(c);return d&&n&&(n.aggregationBody.sqon={content:d.content,op:d.op}),be(n,Nt(c),{revalidateOnFocus:!1})}function St(r,t){const s=r.toLowerCase().split(/\s+/).filter(Boolean);return t.filter(i=>{const c=i.key.toLowerCase(),n=i.label.toLowerCase();function m(l,d){let x=0;for(const a of d){const u=l.indexOf(a,x);if(u===-1)return!1;x=u+a.length}return!0}return m(c,s)||m(n,s)})}function Z(r,t){return t<r?t:r}function It(r,t){return!!(w.getResolvedActiveQuery(r).content.find(i=>i.content.field===t.key)&&t.withDictionary)}function Se({field:r,maxVisibleItems:t=5}){const{t:s,sanitize:i,lazyTranslate:c}=F(),{appId:n}=le(),[m,l]=o.useState(It(n,r)),{data:d,isLoading:x}=Rt(r.key,void 0,!0,m,n),[a,u]=o.useState(d||[]),[j,_]=o.useState([]),[f,h]=o.useState([]),[g,E]=o.useState(Z(a.length,t)),[V,C]=o.useState(!1);o.useEffect(()=>{const k=w.getResolvedActiveQuery(n).content.find(v=>v.content.field===r.key);k?(h(k.content.value),C(!0)):h([]),d==null||d.sort((v,I)=>{const L=v.key&&f.includes(v.key),z=I.key&&f.includes(I.key);return L===z?I.count-v.count:L?-1:1}),d==null||d.forEach(v=>{v.label=s(`common.filters.values.${r.key}.${i(v.key)}`,{defaultValue:c(v.key)})}),u(d||[]),E(Z((d==null?void 0:d.length)||0,t))},[d,n,r.key,t]);const T=o.useCallback(k=>{if(!k.trim()){u(d||[]),E(Z((d==null?void 0:d.length)||0,t));return}const v=St(k,d);t>v.length?E(v.length):v.length>t&&E(t),u(v)},[d,t]),K=o.useCallback(()=>{E(a.length)},[g,a]),W=o.useCallback(()=>{E(t)},[g]),R=o.useCallback(()=>{f.length!==a.length&&(C(!0),h(a.map(k=>k.key)))},[a,f]),y=o.useCallback(()=>{f.length!==0&&(C(!0),h([]))},[f]),Y=o.useCallback(k=>{let v=[];f.some(I=>I===k.key)?v=f.filter(I=>I!==k.key):v=[...f,k.key],C(!0),h(v)},[f]),G=o.useCallback(()=>{C(!1),h([...j])},[j]),S=o.useCallback(k=>{C(!1),_(f),w.updateActiveQueryField(n,{field:r.key,value:[...f],merge_strategy:q.OVERRIDE_VALUES,operator:k})},[f,n,r.key]),O=o.useCallback(()=>{S($.In)},[S]),M=o.useCallback(()=>{S($.NotIn)},[S]),X=o.useCallback(()=>{S($.All)},[S]),J=o.useCallback(()=>{S($.In)},[S]);return e.jsxs(e.Fragment,{children:[e.jsxs(ve,{size:"sm",variant:"outline",children:[e.jsx(D,{startIcon:lt,size:"xs",type:"text",placeholder:s("common.filters.search.placeholder"),className:"w-full text-xs py-1.5 px-3 mb-4 border border-border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",onChange:k=>T(k.target.value),autoFocus:!0}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(A,{size:"xs",onClick:()=>R(),variant:"link",className:"px-0",children:s("common.filters.buttons.all")}),e.jsx(ot,{orientation:"vertical",className:"h-4"}),e.jsx(A,{size:"xs",onClick:()=>y(),variant:"link",className:"px-0",children:s("common.filters.buttons.none")}),r.withDictionary&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex-grow"}),e.jsx(te,{htmlFor:"with-dictionary-switch",className:"text-xs",children:s("common.filters.with_dictionary")}),e.jsx(at,{id:"with-dictionary-switch",checked:m,size:"xs",onCheckedChange:()=>l(!m)})]})]}),e.jsxs("div",{className:"max-h-[250px] overflow-auto",children:[x&&Array.from({length:3},(k,v)=>e.jsxs("div",{className:"flex justify-between items-center py-2 space-x-2",children:[e.jsx(P,{className:"w-full h-6 rounded"}),e.jsx(P,{className:"h-6 w-12 rounded-md"})]},`skeleton-${v}`)),!x&&a.length===0&&e.jsx("div",{className:"text-muted-foreground py-4",children:s("common.filters.no_values_found")}),!x&&a.length>0&&Array.from({length:g},(k,v)=>e.jsx("div",{className:"gap-3 py-1.5",children:e.jsx(rt,{size:"xs",label:s(`common.filters.labels.${r.key}_value.${a[v].key}`,{defaultValue:a[v].label}),checked:f.some(I=>I===a[v].key),count:a[v].count,onCheckedChange:()=>Y(a[v])})},a[v].key))]}),!x&&a.length>g&&e.jsx(A,{className:"mt-2 px-0",onClick:K,size:"xs",variant:"link",children:s("common.filters.buttons.show_more",{count:a.length-t})}),!x&&g>t&&e.jsx(A,{className:"mt-2 px-0",onClick:W,size:"xs",variant:"link",children:s("common.filters.buttons.show_less")})]}),e.jsx(_e,{size:"sm",children:e.jsxs("div",{className:"flex align-right justify-end items-center space-x-2",children:[e.jsx(A,{size:"xxs",variant:"ghost",onClick:G,disabled:!V||x,children:s("common.filters.buttons.clear")}),e.jsx("div",{className:"flex space-x-2",children:e.jsx(nt,{size:"xxs",variant:"outline",className:"h-7",color:"primary",actions:[{label:s("common.filters.buttons.some_not_in"),onClick:J},{label:s("common.filters.buttons.all"),onClick:X},{label:s("common.filters.buttons.not_in"),onClick:M}],onDefaultAction:O,disabled:x,children:s("common.filters.buttons.apply")})})]})})]})}Se.__docgenInfo={description:"",methods:[],displayName:"MultiSelectFilter",props:{field:{required:!0,tsType:{name:"AggregationConfig"},description:""},maxVisibleItems:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"5",computed:!1}}}};const wt=ft({slots:{base:"text-muted-foreground"},variants:{size:{xs:{base:"text-xs"},sm:{base:"text-sm"}}},defaultVariants:{size:"sm"}});function Ie({className:r,size:t,children:s}){const i=wt({size:t});return e.jsx("p",{className:i.base({className:r}),children:s})}Ie.__docgenInfo={description:"",methods:[],displayName:"TextMuted"};const we="integer",Et=r=>{switch(r){case se.cnv_occurrence:return t=>U.statisticsGermlineCNVOccurrences(t.seqId,t.statisticsBody).then(s=>s.data);default:return t=>U.statisticsGermlineSNVOccurrences(t.seqId,t.statisticsBody).then(s=>s.data)}};function Ct(r,t,s,i=!1){const c={seqId:s,statisticsBody:{field:r}},n=i?je:w.getResolvedActiveQuery(t);return n&&(c.statisticsBody.sqon={content:n.content,op:n.op}),be(c,Et(t),{revalidateOnFocus:!1})}function xe(r,t,s,i){var f;let c=!1,n=N.LessThan,m="0",l="0",d="",x=!1;const a=(i==null?void 0:i.type)===we?0:3,u=t.content.find(h=>"content"in h&&"field"in h.content?h.content.field===r:!1),j=t.content.find(h=>"content"in h&&"field"in h.content?h.content.field===`${r}_unit`:!1);if(u){const h=u.content.value;if(console.log("[NumericalFilter] values",h),h.includes("__missing__"))return{hasUnappliedItems:c,selectedRange:n,minValue:m,maxValue:l,numericalValue:d,hasNoData:!0,selectedUnit:void 0};c=!0,h.length===2?(n=N.Between,m=Number(h[0]).toFixed(a),l=Number(h[1]).toFixed(a)):d=h[0],u.op&&(n=u.op)}else console.log("[NumericalFilter else] no filter exists",s),x=!1,(s==null?void 0:s.defaultMin)!==void 0?(m=s.defaultMin.toString(),d=s.defaultMin.toString()):(i==null?void 0:i.min)!==void 0&&(m=Number(i.min.toFixed(a)).toString(),d=Number(i.min.toFixed(a)).toString()),(s==null?void 0:s.defaultMax)!==void 0?l=s.defaultMax.toString():(i==null?void 0:i.max)!==void 0&&(l=Number(i.max.toFixed(a)).toString()),s!=null&&s.defaultOperator&&(n=N[s.defaultOperator]);let _;return j&&j.content.value[0]&&((f=s==null?void 0:s.rangeTypes)!=null&&f.length)&&(_=s.rangeTypes[0].key),{hasUnappliedItems:c,selectedRange:n,minValue:m,maxValue:l,numericalValue:d,hasNoData:x,selectedUnit:_}}function Ee({field:r}){var z,ie,ce,de;const{t}=F(),{appId:s,aggregations:i}=le(),{seqId:c}=o.useContext(Re),n=r.key,m={[N.GreaterThan]:{display:t("common.filters.operators.greater_than"),dropdown:t("common.filters.operators.greater_than"),icon:pt},[N.LessThan]:{display:t("common.filters.operators.less_than"),dropdown:t("common.filters.operators.less_than"),icon:mt},[N.Between]:{display:t("common.filters.operators.between"),dropdown:t("common.filters.operators.between"),icon:ut},[N.GreaterThanOrEqualTo]:{display:t("common.filters.operators.greater_than_or_equal"),dropdown:t("common.filters.operators.greater_than_or_equal"),icon:dt},[N.LessThanOrEqualTo]:{display:t("common.filters.operators.less_than_or_equal"),dropdown:t("common.filters.operators.less_than_or_equal"),icon:ct},[N.In]:{display:t("common.filters.operators.in"),dropdown:t("common.filters.operators.in"),icon:it}},{data:l,isLoading:d}=Ct(n,s,c,!1),x=(l==null?void 0:l.type)===we?0:3,[a,u]=o.useState(N.GreaterThan),[j,_]=o.useState("0"),[f,h]=o.useState("0"),[g,E]=o.useState("0"),[V,C]=o.useState(!1),[T,K]=o.useState(),[W,R]=o.useState(!1),y=(z=Object.values(i).flatMap(p=>p.items).find(p=>p.key===n))==null?void 0:z.defaults,Y=r.type==="numerical"&&(y==null?void 0:y.noDataInputOption),G=(y==null?void 0:y.intervalDecimal)!==void 0&&((y==null?void 0:y.max)!==void 0||(y==null?void 0:y.min)!==void 0)||l&&(l.min!==void 0||l.max!==void 0),S=(y==null?void 0:y.min)??(l==null?void 0:l.min)??0,O=(y==null?void 0:y.max)??(l==null?void 0:l.max)??100,M=o.useCallback(()=>{const p=w.getResolvedActiveQuery(s);if(!(p!=null&&p.content))return;const b=xe(n,p,y,l);C(b.hasNoData),E(b.minValue),h(b.maxValue),R(b.hasUnappliedItems),u(b.selectedRange??N.GreaterThan),_(b.numericalValue)},[s,n,y,l]);o.useEffect(()=>{M()},[M]);const X=o.useCallback(p=>{u(p),R(!0)},[]),J=o.useCallback(p=>{C(p),R(!0)},[]),k=o.useCallback(p=>{K(p),R(!0)},[]),v=()=>{R(!1);const p=xe(n,je,y,l);C(p.hasNoData),E(p.minValue),h(p.maxValue),R(p.hasUnappliedItems),u(p.selectedRange),_(p.numericalValue)},I=o.useCallback(()=>{if(R(!1),V){w.updateActiveQueryField(s,{field:n,value:["__missing__"],merge_strategy:q.OVERRIDE_VALUES});return}let p=[];p=a===N.Between?[parseFloat(g.toString()),parseFloat(f.toString())]:[parseFloat(j.toString())],w.updateActiveQueryField(s,{field:n,value:p,merge_strategy:q.OVERRIDE_VALUES,operator:a}),T&&w.updateActiveQueryField(s,{field:`${n}_unit`,value:[T],merge_strategy:q.OVERRIDE_VALUES})},[s,n,a,j,g,f,V,T]),L=Object.entries(N).map(([p,b])=>{if(b in m){const He=m[b].icon;return e.jsx(ue,{value:b,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(He,{size:16}),e.jsx("span",{children:m[b].dropdown})]})},b)}return null}).filter(Boolean);return e.jsxs(e.Fragment,{children:[e.jsx(ve,{id:`${n}_container`,size:"sm",variant:"outline",children:e.jsxs("div",{className:"pt-2",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("div",{id:`${n}_operator`,children:e.jsxs(me,{value:a,onValueChange:X,children:[e.jsx(pe,{size:"sm",children:e.jsx(fe,{placeholder:t("common.filters.operators.select_operator"),children:m[a].display})}),e.jsx(he,{children:L})]})}),a===N.Between?e.jsxs("div",{className:"flex gap-2 flex-row",children:[e.jsx(D,{size:"xs",className:"w-half",value:g,onChange:p=>{const b=p.target.value;isNaN(Number(b))||(E(b),R(!0))},min:S,max:O,id:`${n}_min`,"data-testid":`${n}_min`}),e.jsx(D,{size:"xs",className:"w-half",value:f,onChange:p=>{const b=p.target.value;isNaN(Number(b))||(h(b),R(!0))},min:S,max:O,id:`${n}_max`,"data-testid":`${n}_max`})]}):e.jsx(D,{size:"xs",className:"w-full",value:j,onChange:p=>{const b=p.target.value;isNaN(Number(b))||(_(b),R(!0))},min:S,max:O,id:`${n}_value`,"data-testid":`${n}_value`}),G&&e.jsx("div",{id:`${n}_interval`,children:e.jsxs(Ie,{size:"xs",children:[t("common.filters.labels.actual_interval")," : ",(ie=l==null?void 0:l.min)==null?void 0:ie.toFixed(x)," -"," ",(ce=l==null?void 0:l.max)==null?void 0:ce.toFixed(x)]})})]}),(y==null?void 0:y.rangeTypes)&&y.rangeTypes.length>0&&e.jsx("div",{id:`${n}_range_type_container`,children:d?e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"h-5 w-16 mb-1",id:`${n}_unit_label_skeleton`}),e.jsx(P,{className:"h-9 w-full",id:`${n}_select_skeleton`})]}):e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"text-sm",id:`${n}_unit_label`,children:t("common.filters.labels.unit")}),e.jsxs(me,{defaultValue:T||y.rangeTypes[0].key,onValueChange:k,children:[e.jsx(pe,{children:e.jsx(fe,{placeholder:t("common.filters.labels.select_unit"),children:((de=y.rangeTypes.find(p=>p.key===T))==null?void 0:de.name)||t("common.filters.labels.select_unit")})}),e.jsx(he,{children:y.rangeTypes.map(p=>e.jsx(ue,{value:p.key,children:p.name},p.key))})]})]})}),Y&&!G&&e.jsxs("label",{className:"flex items-center space-x-2 overflow-hidden",id:`${n}_no_data_label`,children:[e.jsx(ht,{checked:V,onCheckedChange:J,id:`${n}_no_data`}),e.jsx("span",{children:t("common.filters.labels.no_data")})]})]})}),e.jsx(_e,{size:"sm",children:e.jsxs("div",{className:"flex align-right justify-end items-center space-x-2",children:[e.jsx(A,{size:"xxs",variant:"ghost",onClick:v,disabled:!W,id:`${n}_clear`,children:t("common.filters.buttons.clear")}),e.jsx("div",{className:"flex space-x-2",children:e.jsx(A,{size:"xxs",variant:"outline",onClick:I,id:`${n}_apply`,children:t("common.filters.buttons.apply")})})]})})]})}Ee.__docgenInfo={description:"",methods:[],displayName:"NumericalFilter",props:{field:{required:!0,tsType:{name:"AggregationConfig"},description:""}}};var re="Radio",[At,Ce]=ke(re),[Tt,Ft]=At(re),Ae=o.forwardRef((r,t)=>{const{__scopeRadio:s,name:i,checked:c=!1,required:n,disabled:m,value:l="on",onCheck:d,form:x,...a}=r,[u,j]=o.useState(null),_=ne(t,g=>j(g)),f=o.useRef(!1),h=u?x||!!u.closest("form"):!0;return e.jsxs(Tt,{scope:s,checked:c,disabled:m,children:[e.jsx(Q.button,{type:"button",role:"radio","aria-checked":c,"data-state":Oe(c),"data-disabled":m?"":void 0,disabled:m,value:l,...a,ref:_,onClick:ee(r.onClick,g=>{c||d==null||d(),h&&(f.current=g.isPropagationStopped(),f.current||g.stopPropagation())})}),h&&e.jsx(Ve,{control:u,bubbles:!f.current,name:i,value:l,checked:c,required:n,disabled:m,form:x,style:{transform:"translateX(-100%)"}})]})});Ae.displayName=re;var Te="RadioIndicator",Fe=o.forwardRef((r,t)=>{const{__scopeRadio:s,forceMount:i,...c}=r,n=Ft(Te,s);return e.jsx(gt,{present:i||n.checked,children:e.jsx(Q.span,{"data-state":Oe(n.checked),"data-disabled":n.disabled?"":void 0,...c,ref:t})})});Fe.displayName=Te;var Vt="RadioBubbleInput",Ve=o.forwardRef(({__scopeRadio:r,control:t,checked:s,bubbles:i=!0,...c},n)=>{const m=o.useRef(null),l=ne(m,n),d=kt(s),x=bt(t);return o.useEffect(()=>{const a=m.current;if(!a)return;const u=window.HTMLInputElement.prototype,_=Object.getOwnPropertyDescriptor(u,"checked").set;if(d!==s&&_){const f=new Event("click",{bubbles:i});_.call(a,s),a.dispatchEvent(f)}},[d,s,i]),e.jsx(Q.input,{type:"radio","aria-hidden":!0,defaultChecked:s,...c,tabIndex:-1,ref:l,style:{...c.style,...x,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Ve.displayName=Vt;function Oe(r){return r?"checked":"unchecked"}var Ot=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],H="RadioGroup",[qt,js]=ke(H,[ge,Ce]),qe=ge(),Ge=Ce(),[Gt,Mt]=qt(H),Me=o.forwardRef((r,t)=>{const{__scopeRadioGroup:s,name:i,defaultValue:c,value:n,required:m=!1,disabled:l=!1,orientation:d,dir:x,loop:a=!0,onValueChange:u,...j}=r,_=qe(s),f=jt(x),[h,g]=xt({prop:n,defaultProp:c??null,onChange:u,caller:H});return e.jsx(Gt,{scope:s,name:i,required:m,disabled:l,value:h,onValueChange:g,children:e.jsx(yt,{asChild:!0,..._,orientation:d,dir:f,loop:a,children:e.jsx(Q.div,{role:"radiogroup","aria-required":m,"aria-orientation":d,"data-disabled":l?"":void 0,dir:f,...j,ref:t})})})});Me.displayName=H;var Le="RadioGroupItem",ze=o.forwardRef((r,t)=>{const{__scopeRadioGroup:s,disabled:i,...c}=r,n=Mt(Le,s),m=n.disabled||i,l=qe(s),d=Ge(s),x=o.useRef(null),a=ne(t,x),u=n.value===c.value,j=o.useRef(!1);return o.useEffect(()=>{const _=h=>{Ot.includes(h.key)&&(j.current=!0)},f=()=>j.current=!1;return document.addEventListener("keydown",_),document.addEventListener("keyup",f),()=>{document.removeEventListener("keydown",_),document.removeEventListener("keyup",f)}},[]),e.jsx(vt,{asChild:!0,...l,focusable:!m,active:u,children:e.jsx(Ae,{disabled:m,required:n.required,checked:u,...d,...c,name:n.name,ref:a,onCheck:()=>n.onValueChange(c.value),onKeyDown:ee(_=>{_.key==="Enter"&&_.preventDefault()}),onFocus:ee(c.onFocus,()=>{var _;j.current&&((_=x.current)==null||_.click())})})})});ze.displayName=Le;var Lt="RadioGroupIndicator",$e=o.forwardRef((r,t)=>{const{__scopeRadioGroup:s,...i}=r,c=Ge(s);return e.jsx(Fe,{...c,...i,ref:t})});$e.displayName=Lt;var De=Me,Be=ze,zt=$e;function oe({className:r,...t}){return e.jsx(De,{className:Ne("grid gap-2",r),...t})}oe.displayName=De.displayName;function ae({className:r,...t}){return e.jsx(Be,{className:Ne("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),...t,children:e.jsx(zt,{className:"flex items-center justify-center",children:e.jsx(_t,{className:"h-2.5 w-2.5 fill-current text-current"})})})}ae.displayName=Be.displayName;oe.__docgenInfo={description:"",methods:[]};ae.__docgenInfo={description:"",methods:[]};function Pe({data:r,field:t}){const{t:s}=F(),[i,c]=o.useState(r||[]),[n,m]=o.useState(null),{appId:l}=le();o.useEffect(()=>{const u=w.getActiveQuery(l).content.find(j=>j.content.field===t.key);if(u){const j=u.content.value;j.length>=1&&m(j[0])}else m(null);c(r||[])},[r]);const d=o.useCallback(u=>{u.key!==n&&u.key!==void 0&&(m(u.key||null),w.updateActiveQueryField(l,{field:t.key,value:[...u.key],merge_strategy:q.OVERRIDE_VALUES}))},[n]),x=o.useCallback(u=>n===u.key,[n]),a=o.useCallback(()=>{m(null)},[n]);return e.jsxs("div",{className:"p-2 w-full max-w-md",children:[e.jsx(oe,{children:i.map(u=>e.jsx("div",{className:"space-y-3 pt-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{value:u.key||"",id:u.key,checked:x(u),onClick:()=>{d(u)}}),e.jsx(te,{htmlFor:u.key,children:u.key})]}),e.jsx("span",{className:"bg-accent px-2 py-1 rounded-md font-mono text-xs",children:u.count})]})},u.key))}),n!==null&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"my-4 border-border"}),e.jsx("div",{className:"flex align-right justify-end items-center space-x-2",children:e.jsx(A,{onClick:a,size:"xs",children:s("common.filters.buttons.clear")})})]})]})}Pe.__docgenInfo={description:"",methods:[],displayName:"ToggleFilter",props:{data:{required:!1,tsType:{name:"Array",elements:[{name:"Aggregation"}],raw:"Aggregation[]"},description:""},field:{required:!0,tsType:{name:"AggregationConfig"},description:""}}};function B({field:r,children:t}){const{t:s}=F(),i=s(`common.filters.labels.${r.translation_key}`,{defaultValue:r.key}),c=`common.filters.labels.${r.translation_key}_tooltip`,n=s(c)===c?null:s(c);function m(){return e.jsx("div",{className:"flex items-center justify-between w-full text-xs",children:e.jsx("span",{children:i})})}return e.jsx(Je,{size:"sm",children:e.jsxs(Ke,{value:r.key,children:[e.jsx(Ze,{size:"sm",children:e.jsx(We,{children:n?e.jsxs(et,{children:[e.jsx(tt,{asChild:!0,children:e.jsx("span",{children:m()})}),e.jsx(st,{children:e.jsx("span",{children:n})})]}):m()})}),e.jsx(Ye,{className:"pb-0",children:t})]},r.key)})}function Ue({field:r,isOpen:t}){const{t:s}=F(),i=r.type;if(i==="divider")return e.jsx("h4",{className:"mx-1 my-3 mt-5 text-muted-foreground",children:s(`common.filters.${r.key}`)});let c;switch(i){case"multiple":c=e.jsx(B,{field:r,isOpen:t,children:e.jsx(Se,{field:r})});break;case"numerical":c=e.jsx(B,{field:r,isOpen:t,children:e.jsx(Ee,{field:r})});break;case"boolean":c=e.jsx(B,{field:r,isOpen:t,children:e.jsx(Pe,{field:r})});break;default:c=e.jsx("div",{children:s("common.filters.unsupported_type",{type:r.type})})}return c}B.__docgenInfo={description:"",methods:[],displayName:"AccordionContainer",props:{field:{required:!0,tsType:{name:"AggregationConfig"},description:""},isOpen:{required:!0,tsType:{name:"boolean"},description:""},searchHandler:{required:!1,tsType:{name:"signature",type:"function",raw:"(_e: React.MouseEvent<SVGElement, MouseEvent>) => void",signature:{arguments:[{type:{name:"ReactMouseEvent",raw:"React.MouseEvent<SVGElement, MouseEvent>",elements:[{name:"SVGElement"},{name:"MouseEvent"}]},name:"_e"}],return:{name:"void"}}},description:""},children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};Ue.__docgenInfo={description:"To be use when the filter needs to be inside an Accordion component",methods:[],displayName:"FilterContainer",props:{field:{required:!0,tsType:{name:"AggregationConfig"},description:""},isOpen:{required:!0,tsType:{name:"boolean"},description:""},searchHandler:{required:!1,tsType:{name:"signature",type:"function",raw:"(_e: React.MouseEvent<SVGElement, MouseEvent>) => void",signature:{arguments:[{type:{name:"ReactMouseEvent",raw:"React.MouseEvent<SVGElement, MouseEvent>",elements:[{name:"SVGElement"},{name:"MouseEvent"}]},name:"_e"}],return:{name:"void"}}},description:""}}};const Qe=o.createContext({appId:se.variant_entity,aggregations:{}}),le=()=>{const r=o.useContext(Qe);if(!r)throw new Error("useFilterConfig must be used within a FilterConfigProvider");return r};function $t({groupKey:r,appId:t,aggregations:s}){var x;const{t:i}=F(),[c,n]=o.useState(!1),[m,l]=o.useState([]),d=r?((x=s[r])==null?void 0:x.items)||[]:Object.values(s).flatMap(a=>a.items);return o.useEffect(()=>{n(!1),l([])},[r]),e.jsx(Qe,{value:{appId:t,aggregations:s},children:e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(A,{variant:"link",onClick:()=>{const a=!c;n(a),l(a?d.map(u=>u.key):[])},children:i(c?"common.actions.collapse_all":"common.actions.expand_all")})}),e.jsx(Xe,{className:"flex flex-col gap-1",type:"multiple",value:m,onValueChange:a=>l(a),children:d.map((a,u)=>e.jsx(Ue,{isOpen:m.includes(a.key),field:a},`${a.key}-${u}`))})]})})}$t.__docgenInfo={description:"",methods:[],displayName:"FilterList",props:{groupKey:{required:!1,tsType:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},description:""},aggregations:{required:!0,tsType:{name:"signature",type:"object",raw:`{
  [key: string]: AggregationGroup;
}`,signature:{properties:[{key:{name:"string"},value:{name:"AggregationGroup",required:!0}}]}},description:""},appId:{required:!0,tsType:{name:"ApplicationId"},description:""}}};export{$t as F,Se as M,Ee as N,Pe as T};
