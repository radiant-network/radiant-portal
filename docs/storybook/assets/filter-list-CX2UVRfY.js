import{j as e}from"./jsx-runtime-D_zvdyIk.js";import{R as he,r as a}from"./index-CBYaBgW8.js";import{A as Fe}from"./action-button-9r-08jXC.js";import{B as O}from"./button-C6dOawx6.js";import"./button.variants-Du9eY_ux.js";import{C as Oe}from"./checkbox-filter-CgMxmOlu.js";import{d as ye,e as xe,C as Re,a as Ce}from"./card-Cyh3E19J.js";import{I as W}from"./input-Bj-MPxry.js";import{L as oe}from"./label-BI8zg36L.js";import{S as qe}from"./separator-ChZWIdMg.js";import{S as Z}from"./skeleton-_T1otFf0.js";import{S as Ve}from"./switch-Jy17y5RA.js";import{q as _,D as ve}from"./query-builder-remote-DUEaADiT.js";import{M as G,T as H,R as N}from"./sqon-BCleCeFq.js";import{u as V}from"./i18n-C-41056h.js";import{A as $e,a as Me,b as ze,c as Be}from"./accordion-DSXieqtP.js";import{A as ae}from"./applications-config-3OOAo44D.js";import{u as ke,o as K}from"./api-0qOZ7ovq.js";import{S as Le}from"./search-DKmUqS9g.js";import{E as Ge,L as De,G as Ue,a as Qe,b as Je,c as Pe}from"./less-than-or-equal-operator-icon-BI5aNTvi.js";import{C as He}from"./checkbox-BUFo-vqr.js";import{d as ce,S as ue,a as de,b as me,c as pe}from"./select-Dcd4mvCY.js";import{c as We}from"./index-C66Dxnp2.js";import{u as Ye}from"./chunk-WWGJGFF6-0IpzJ_3T.js";import{R as Ze,a as Ke}from"./radio-group-DekDLgvf.js";import{T as Xe,a as et,b as tt}from"./tooltip-0vX-MTK3.js";const ge=he.createContext({caseId:1,seqId:1}),st=t=>{switch(t){case ae.cnv_occurrence:return s=>K.aggregateGermlineCNVOccurrences(s.caseId,s.seqId,s.aggregationBody).then(n=>n.data);default:return s=>K.aggregateGermlineSNVOccurrences(s.caseId,s.seqId,s.aggregationBody,s.withDictionary).then(n=>n.data)}};function Se(t,s=30,n=!1,u=!1,f){let d;const{caseId:r,seqId:y}=he.useContext(ge);n?d={caseId:r,seqId:y,aggregationBody:{field:t,size:s},withDictionary:u}:d=null;const i=_.getResolvedActiveQuery(f);return i&&d&&(d.aggregationBody.sqon={content:i.content,op:i.op}),ke(d,st(f),{revalidateOnFocus:!1})}function nt(t,s){const n=t.toLowerCase().split(/\s+/).filter(Boolean);return s.filter(u=>{const f=u.key.toLowerCase(),d=u.label.toLowerCase();function r(y,i){let b=0;for(const p of i){const g=y.indexOf(p,b);if(g===-1)return!1;b=g+p.length}return!0}return r(f,n)||r(d,n)})}function re(t,s){return s<t?s:t}function rt(t,s){try{const n=sessionStorage.getItem(s);if(n){const u=JSON.parse(n),f=`${t.key}_withDictionary`;if(Object.prototype.hasOwnProperty.call(u,f))return u[f]}}catch(n){console.warn(`Failed to read dictionary toggle state from sessionStorage for ${t.key}:`,n)}return!1}function je({field:t,maxVisibleItems:s=5}){const{t:n,sanitize:u,lazyTranslate:f}=V(),{appId:d}=le(),r=Te(d),y=()=>{sessionStorage.removeItem(r)},[i,b]=a.useState(rt(t,r)),{data:p,isLoading:g}=Se(t.key,void 0,!0,i,d),k=()=>{try{const o=sessionStorage.getItem(r);if(o){const h=JSON.parse(o);if(Object.prototype.hasOwnProperty.call(h,t.key)){const S=h[t.key];return console.error(`[${t.key}] Found in sessionStorage:`,S),S}}}catch(o){console.warn(`Failed to read filter state from sessionStorage for ${t.key}:`,o)}const l=_.getResolvedActiveQuery(d).content.find(o=>o.content.field===t.key);return(l==null?void 0:l.content.value)||[]},[x,j]=a.useState(p||[]),[m,T]=a.useState(k()),[A,I]=a.useState(re(x.length,s)),[$,F]=a.useState(!1),[R,M]=a.useState(!1),[z,w]=a.useState(()=>{const l=_.getResolvedActiveQuery(d);return JSON.stringify(l)}),[v,X]=a.useState(()=>{try{const l=sessionStorage.getItem(r);if(l){const c=JSON.parse(l);return Object.prototype.hasOwnProperty.call(c,t.key)}}catch(l){console.warn(`Failed to check sessionStorage state for ${t.key}:`,l)}return!1});a.useEffect(()=>{const l=_.getResolvedActiveQuery(d),c=JSON.stringify(l);if(z&&z!==c){y();const o=_.getResolvedActiveQuery(d).content.find(S=>S.content.field===t.key),h=(o==null?void 0:o.content.value)||[];T(h)}w(c)},[d,t.key,y,z]),a.useEffect(()=>{const l=_.getResolvedActiveQuery(d).content.find(S=>S.content.field===t.key),c=(l==null?void 0:l.content.value)||[],o=JSON.stringify([...m].sort())!==JSON.stringify([...c].sort());F(o),m.length===0&&c.length>0&&!R&&!$&&!v&&T(c),v&&X(!1),m.length>0&&R&&M(!1);const h=(()=>{const S=_.getResolvedActiveQuery(d).content.find(C=>C.content.field===t.key);return(S==null?void 0:S.content.value)||[]})();p==null||p.sort((S,C)=>{const ie=S.key&&h.includes(S.key),Ae=C.key&&h.includes(C.key);return ie===Ae?C.count-S.count:ie?-1:1}),p==null||p.forEach(S=>{S.label=n(`common.filters.values.${t.key}.${u(S.key)}`,{defaultValue:f(S.key)})}),j(p||[]),I(re((p==null?void 0:p.length)||0,s))},[p,d,t.key,s,m]),a.useEffect(()=>{try{const l=sessionStorage.getItem(r)||"{}",c=JSON.parse(l);c[t.key]=m,sessionStorage.setItem(r,JSON.stringify(c))}catch(l){console.warn(`Failed to save filter state to sessionStorage for ${t.key}:`,l)}},[m,r,t.key]),a.useEffect(()=>{if(t.withDictionary)try{const l=sessionStorage.getItem(r)||"{}",c=JSON.parse(l),o=`${t.key}_withDictionary`;c[o]=i,sessionStorage.setItem(r,JSON.stringify(c))}catch(l){console.warn(`Failed to save dictionary toggle state to sessionStorage for ${t.key}:`,l)}},[i,r,t.key,t.withDictionary]),a.useEffect(()=>{if(!t.withDictionary||!p)return;const l=_.getResolvedActiveQuery(d).content.find(h=>h.content.field===t.key),c=(l==null?void 0:l.content.value)||[];if(c.length===0)return;c.some(h=>{const S=p.find(C=>C.key===h);return S&&S.count===0})&&!i&&b(!0)},[p,d,t.key,t.withDictionary,i]),a.useEffect(()=>{const l=()=>{sessionStorage.removeItem(r)};return window.addEventListener("beforeunload",l),()=>{window.removeEventListener("beforeunload",l)}},[r]);const D=a.useCallback(l=>{if(!l.trim()){j(p||[]),I(re((p==null?void 0:p.length)||0,s));return}const c=nt(l,p);s>c.length?I(c.length):c.length>s&&I(s),j(c)},[p,s]),B=a.useCallback(()=>{I(x.length)},[A,x]),L=a.useCallback(()=>{I(s)},[A]),U=a.useCallback(()=>{m.length!==x.length&&(F(!0),T(x.map(l=>l.key)))},[x,m]),q=a.useCallback(()=>{F(!0),T([]),M(!0);try{const l=sessionStorage.getItem(r);if(l){const c=JSON.parse(l);delete c[t.key],Object.keys(c).length===0?sessionStorage.removeItem(r):sessionStorage.setItem(r,JSON.stringify(c))}}catch(l){console.warn(`Failed to clear filter state from sessionStorage for ${t.key}:`,l)}},[r,t.key]),ee=a.useCallback(()=>{m.length!==0&&q()},[m,q]),te=a.useCallback(l=>{let c=[];m.some(o=>o===l.key)?c=m.filter(o=>o!==l.key):c=[...m,l.key],F(!0),T(c)},[m]),se=a.useCallback(()=>{q()},[q]),E=a.useCallback(l=>{F(!1),M(!1),_.updateActiveQueryField(d,{field:t.key,value:[...m],merge_strategy:G.OVERRIDE_VALUES,operator:l}),y()},[m,d,t.key,y]),ne=a.useCallback(()=>{E(H.In)},[E]),Q=a.useCallback(()=>{E(H.NotIn)},[E]),J=a.useCallback(()=>{E(H.All)},[E]),P=a.useCallback(()=>{E(H.In)},[E]);return e.jsxs(e.Fragment,{children:[e.jsxs(ye,{size:"sm",variant:"outline",children:[e.jsx(W,{startIcon:Le,size:"xs",type:"text",placeholder:n("common.filters.search.placeholder"),className:"w-full text-xs py-1.5 px-3 mb-4 border border-border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",onChange:l=>D(l.target.value),autoFocus:!0}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(O,{size:"xs",onClick:()=>U(),variant:"link",className:"px-0",children:n("common.filters.buttons.all")}),e.jsx(qe,{orientation:"vertical",className:"h-4"}),e.jsx(O,{size:"xs",onClick:()=>ee(),variant:"link",className:"px-0",children:n("common.filters.buttons.none")}),t.withDictionary&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex-grow"}),e.jsx(oe,{htmlFor:"with-dictionary-switch",className:"text-xs",children:n("common.filters.with_dictionary")}),e.jsx(Ve,{id:"with-dictionary-switch",checked:i,size:"xs",onCheckedChange:()=>b(!i)})]})]}),e.jsxs("div",{className:"max-h-[250px] overflow-auto",children:[g&&Array.from({length:3},(l,c)=>e.jsxs("div",{className:"flex justify-between items-center py-2 space-x-2",children:[e.jsx(Z,{className:"w-full h-6 rounded"}),e.jsx(Z,{className:"h-6 w-12 rounded-md"})]},`skeleton-${c}`)),!g&&x.length===0&&e.jsx("div",{className:"text-muted-foreground py-4",children:n("common.filters.no_values_found")}),!g&&x.length>0&&Array.from({length:A},(l,c)=>e.jsx("div",{className:"gap-3 py-1.5",children:e.jsx(Oe,{size:"xs",label:n(`common.filters.labels.${t.key}_value.${x[c].key}`,{defaultValue:x[c].label}),checked:m.some(o=>o===x[c].key),count:x[c].count,onCheckedChange:()=>te(x[c])})},x[c].key))]}),!g&&x.length>A&&e.jsx(O,{className:"mt-2 px-0",onClick:B,size:"xs",variant:"link",children:n("common.filters.buttons.show_more",{count:x.length-s})}),!g&&A>s&&e.jsx(O,{className:"mt-2 px-0",onClick:L,size:"xs",variant:"link",children:n("common.filters.buttons.show_less")})]}),e.jsx(xe,{size:"sm",children:e.jsxs("div",{className:"flex align-right justify-end items-center space-x-2",children:[e.jsx(O,{size:"xxs",variant:"ghost",onClick:se,disabled:m.length===0||g,children:n("common.filters.buttons.clear")}),e.jsx("div",{className:"flex space-x-2",children:e.jsx(Fe,{size:"xxs",variant:"outline",className:"h-7",color:"primary",actions:[{label:n("common.filters.buttons.some_not_in"),onClick:P},{label:n("common.filters.buttons.all"),onClick:J},{label:n("common.filters.buttons.not_in"),onClick:Q}],onDefaultAction:ne,disabled:g,children:n("common.filters.buttons.apply")})})]})})]})}je.__docgenInfo={description:"",methods:[],displayName:"MultiSelectFilter",props:{field:{required:!0,tsType:{name:"AggregationConfig"},description:""},maxVisibleItems:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"5",computed:!1}}}};const ot=We({slots:{base:"text-muted-foreground"},variants:{size:{xs:{base:"text-xs"},sm:{base:"text-sm"}}},defaultVariants:{size:"sm"}});function _e({className:t,size:s,children:n}){const u=ot({size:s});return e.jsx("p",{className:u.base({className:t}),children:n})}_e.__docgenInfo={description:"",methods:[],displayName:"TextMuted"};const at=function(){const{caseId:t}=Ye(),s=t?Number(t):void 0;if(s==null)throw new Error("Required parameter case_id was null or undefined.");return s},be="integer",lt=t=>{switch(t){case ae.cnv_occurrence:return s=>K.statisticsGermlineCNVOccurrences(s.caseId,s.seqId,s.statisticsBody).then(n=>n.data);default:return s=>K.statisticsGermlineSNVOccurrences(s.caseId,s.seqId,s.statisticsBody).then(n=>n.data)}};function it(t,s,n,u,f=!1){const d={caseId:n,seqId:u,statisticsBody:{field:t}},r=f?ve:_.getResolvedActiveQuery(s);return r&&(d.statisticsBody.sqon={content:r.content,op:r.op}),ke(d,lt(s),{revalidateOnFocus:!1})}function fe(t,s,n,u){var j;let f=!1,d=(n==null?void 0:n.defaultOperator)??N.LessThan,r="0",y="0",i="",b=!1;const p=(u==null?void 0:u.type)===be?0:3,g=s.content.find(m=>"content"in m&&"field"in m.content?m.content.field===t:!1),k=s.content.find(m=>"content"in m&&"field"in m.content?m.content.field===`${t}_unit`:!1);if(g){const m=g.content.value;if(console.log("[NumericalFilter] values",m),m.includes("__missing__"))return{hasUnappliedItems:f,selectedRange:d,minValue:r,maxValue:y,numericalValue:i,hasNoData:!0,selectedUnit:void 0};f=!0,m.length===2?(d=N.Between,r=Number(m[0]).toFixed(p),y=Number(m[1]).toFixed(p)):i=m[0],g.op&&(d=g.op)}else console.log("[NumericalFilter else] no filter exists",n),b=!1,(n==null?void 0:n.defaultMin)!==void 0?(r=n.defaultMin.toString(),i=n.defaultMin.toString()):(u==null?void 0:u.min)!==void 0&&(r=Number(u.min.toFixed(p)).toString(),i=Number(u.min.toFixed(p)).toString()),(n==null?void 0:n.defaultMax)!==void 0?y=n.defaultMax.toString():(u==null?void 0:u.max)!==void 0&&(y=Number(u.max.toFixed(p)).toString()),n!=null&&n.defaultOperator&&(d=N[n.defaultOperator]);let x;return k&&k.content.value[0]&&((j=n==null?void 0:n.rangeTypes)!=null&&j.length)&&(x=n.rangeTypes[0].key),{hasUnappliedItems:f,selectedRange:d,minValue:r,maxValue:y,numericalValue:i,hasNoData:b,selectedUnit:x}}function Ne({field:t}){var Q,J,P,l,c;const{t:s}=V(),{appId:n,aggregations:u}=le(),{seqId:f}=a.useContext(ge),d=at(),r=t.key,y={[N.GreaterThan]:{display:s("common.filters.operators.greater_than"),dropdown:s("common.filters.operators.greater_than"),icon:Pe},[N.LessThan]:{display:s("common.filters.operators.less_than"),dropdown:s("common.filters.operators.less_than"),icon:Je},[N.Between]:{display:s("common.filters.operators.between"),dropdown:s("common.filters.operators.between"),icon:Qe},[N.GreaterThanOrEqualTo]:{display:s("common.filters.operators.greater_than_or_equal"),dropdown:s("common.filters.operators.greater_than_or_equal"),icon:Ue},[N.LessThanOrEqualTo]:{display:s("common.filters.operators.less_than_or_equal"),dropdown:s("common.filters.operators.less_than_or_equal"),icon:De},[N.In]:{display:s("common.filters.operators.in"),dropdown:s("common.filters.operators.in"),icon:Ge}},{data:i,isLoading:b}=it(r,n,d,f,!1),p=(i==null?void 0:i.type)===be?0:3,[g,k]=a.useState(N.GreaterThan),[x,j]=a.useState("0"),[m,T]=a.useState("0"),[A,I]=a.useState("0"),[$,F]=a.useState(!1),[R,M]=a.useState(),[z,w]=a.useState(!1),v=(Q=Object.values(u).flatMap(o=>o.items).find(o=>o.key===r))==null?void 0:Q.defaults,X=t.type==="numerical"&&(v==null?void 0:v.noDataInputOption),D=(v==null?void 0:v.intervalDecimal)!==void 0&&((v==null?void 0:v.max)!==void 0||(v==null?void 0:v.min)!==void 0)||i&&(i.min!==void 0||i.max!==void 0),B=(v==null?void 0:v.min)??(i==null?void 0:i.min)??0,L=(v==null?void 0:v.max)??(i==null?void 0:i.max)??100,U=a.useCallback(()=>{const o=_.getResolvedActiveQuery(n);if(!(o!=null&&o.content))return;const h=fe(r,o,v,i);F(h.hasNoData),I(h.minValue),T(h.maxValue),w(h.hasUnappliedItems),k(h.selectedRange??N.GreaterThan),j(h.numericalValue)},[n,r,v,i]);a.useEffect(()=>{U()},[U]);const q=a.useCallback(o=>{k(o),w(!0)},[]),ee=a.useCallback(o=>{F(o),w(!0)},[]),te=a.useCallback(o=>{M(o),w(!0)},[]),se=()=>{w(!1);const o=fe(r,ve,v,i);F(o.hasNoData),I(o.minValue),T(o.maxValue),w(o.hasUnappliedItems),k(o.selectedRange),j(o.numericalValue)},E=a.useCallback(()=>{if(w(!1),$){_.updateActiveQueryField(n,{field:r,value:["__missing__"],merge_strategy:G.OVERRIDE_VALUES});return}let o=[];o=g===N.Between?[parseFloat(A.toString()),parseFloat(m.toString())]:[parseFloat(x.toString())],_.updateActiveQueryField(n,{field:r,value:o,merge_strategy:G.OVERRIDE_VALUES,operator:g}),R&&_.updateActiveQueryField(n,{field:`${r}_unit`,value:[R],merge_strategy:G.OVERRIDE_VALUES})},[n,r,g,x,A,m,$,R]),ne=Object.entries(N).map(([o,h])=>{if(h in y){const S=y[h].icon;return e.jsx(ce,{value:h,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{size:16}),e.jsx("span",{children:y[h].dropdown})]})},h)}return null}).filter(Boolean);return e.jsxs(e.Fragment,{children:[e.jsx(ye,{id:`${r}_container`,size:"sm",variant:"outline",children:e.jsxs("div",{className:"pt-2",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("div",{id:`${r}_operator`,children:e.jsxs(ue,{value:g,onValueChange:q,children:[e.jsx(de,{size:"sm",children:e.jsx(me,{placeholder:s("common.filters.operators.select_operator"),children:((J=y[g])==null?void 0:J.display)||s("common.filters.operators.unknown")})}),e.jsx(pe,{children:ne})]})}),g===N.Between?e.jsxs("div",{className:"flex gap-2 flex-row",children:[e.jsx(W,{size:"xs",className:"w-half",value:A,onChange:o=>{const h=o.target.value;isNaN(Number(h))||(I(h),w(!0))},min:B,max:L,id:`${r}_min`,"data-testid":`${r}_min`}),e.jsx(W,{size:"xs",className:"w-half",value:m,onChange:o=>{const h=o.target.value;isNaN(Number(h))||(T(h),w(!0))},min:B,max:L,id:`${r}_max`,"data-testid":`${r}_max`})]}):e.jsx(W,{size:"xs",className:"w-full",value:x,onChange:o=>{const h=o.target.value;isNaN(Number(h))||(j(h),w(!0))},min:B,max:L,id:`${r}_value`,"data-testid":`${r}_value`}),D&&e.jsx("div",{id:`${r}_interval`,children:e.jsxs(_e,{size:"xs",children:[s("common.filters.labels.actual_interval")," : ",(P=i==null?void 0:i.min)==null?void 0:P.toFixed(p)," -"," ",(l=i==null?void 0:i.max)==null?void 0:l.toFixed(p)]})})]}),(v==null?void 0:v.rangeTypes)&&v.rangeTypes.length>0&&e.jsx("div",{id:`${r}_range_type_container`,className:"mt-3",children:b?e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"h-5 w-16 mb-1",id:`${r}_unit_label_skeleton`}),e.jsx(Z,{className:"h-9 w-full",id:`${r}_select_skeleton`})]}):e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"text-sm",id:`${r}_unit_label`,children:s("common.filters.labels.unit")}),e.jsxs(ue,{defaultValue:R||v.rangeTypes[0].key,onValueChange:te,children:[e.jsx(de,{children:e.jsx(me,{placeholder:s("common.filters.labels.select_unit"),children:((c=v.rangeTypes.find(o=>o.key===R))==null?void 0:c.name)||s("common.filters.labels.select_unit")})}),e.jsx(pe,{children:v.rangeTypes.map(o=>e.jsx(ce,{value:o.key,children:o.name},o.key))})]})]})}),X&&!D&&e.jsxs("label",{className:"flex items-center space-x-2 overflow-hidden mt-3",id:`${r}_no_data_label`,children:[e.jsx(He,{checked:$,onCheckedChange:ee,id:`${r}_no_data`}),e.jsx("span",{children:s("common.filters.labels.no_data")})]})]})}),e.jsx(xe,{size:"sm",children:e.jsxs("div",{className:"flex align-right justify-end items-center space-x-2",children:[e.jsx(O,{size:"xxs",variant:"ghost",onClick:se,disabled:!z,id:`${r}_clear`,children:s("common.filters.buttons.clear")}),e.jsx("div",{className:"flex space-x-2",children:e.jsx(O,{size:"xxs",variant:"outline",onClick:E,id:`${r}_apply`,children:s("common.filters.buttons.apply")})})]})})]})}Ne.__docgenInfo={description:"",methods:[],displayName:"NumericalFilter",props:{field:{required:!0,tsType:{name:"AggregationConfig"},description:""}}};function we({data:t,field:s}){const{t:n}=V(),{appId:u}=le(),{data:f}=Se(s.key,void 0,!0,!1,u),[d,r]=a.useState(t||f||[]),[y,i]=a.useState(null);a.useEffect(()=>{r(t||f||[])},[t,f]),a.useEffect(()=>{const k=_.getActiveQuery(u).content.find(x=>x.content.field===s.key);if(k){const x=k.content.value;x.length>=1&&i(x[0])}else i(null)},[u,s.key]);const b=a.useCallback(k=>{k.key!==y&&k.key!==void 0&&(i(k.key||null),_.updateActiveQueryField(u,{field:s.key,value:[...k.key],merge_strategy:G.OVERRIDE_VALUES}))},[y]),p=a.useCallback(k=>y===k.key,[y]),g=a.useCallback(()=>{i(null)},[y]);return e.jsxs("div",{className:"p-2 w-full max-w-md",children:[e.jsx(Ze,{children:d.map(k=>e.jsx("div",{className:"space-y-3 pt-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ke,{value:k.key||"",id:k.key,checked:p(k),onClick:()=>{b(k)}}),e.jsx(oe,{htmlFor:k.key,children:k.key})]}),e.jsx("span",{className:"bg-accent px-2 py-1 rounded-md font-mono text-xs",children:k.count})]})},k.key))}),y!==null&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"my-4 border-border"}),e.jsx("div",{className:"flex align-right justify-end items-center space-x-2",children:e.jsx(O,{onClick:g,size:"xs",children:n("common.filters.buttons.clear")})})]})]})}we.__docgenInfo={description:"",methods:[],displayName:"ToggleFilter",props:{data:{required:!1,tsType:{name:"Array",elements:[{name:"Aggregation"}],raw:"Aggregation[]"},description:""},field:{required:!0,tsType:{name:"AggregationConfig"},description:""}}};function Y({field:t,children:s}){const{t:n}=V(),u=n(`common.filters.labels.${t.translation_key}`,{defaultValue:t.key}),f=`common.filters.labels.${t.translation_key}_tooltip`,d=n(f)===f?null:n(f);function r(){return e.jsx("div",{className:"flex items-center justify-between w-full text-xs",children:e.jsx("span",{children:u})})}return e.jsx(Re,{size:"sm",children:e.jsxs($e,{value:t.key,className:"border-none",children:[e.jsx(Ce,{size:"sm",children:e.jsx(Me,{children:d?e.jsxs(Xe,{children:[e.jsx(et,{asChild:!0,children:e.jsx("span",{children:r()})}),e.jsx(tt,{children:e.jsx("span",{children:d})})]}):r()})}),e.jsx(ze,{className:"pb-0",children:s})]},t.key)})}function Ie({field:t,isOpen:s}){const{t:n}=V(),u=t.type;if(u==="divider")return e.jsx("h4",{className:"px-2 h-8 text-sidebar-foreground/70 text-xs font-medium line-height-xs text-ellipsis overflow-hidden flex justify-between items-center",children:n(`common.filters.${t.key}`)});let f;switch(u){case"multiple":f=e.jsx(Y,{field:t,isOpen:s,children:e.jsx(je,{field:t})});break;case"numerical":f=e.jsx(Y,{field:t,isOpen:s,children:e.jsx(Ne,{field:t})});break;case"boolean":f=e.jsx(Y,{field:t,isOpen:s,children:e.jsx(we,{field:t})});break;default:f=e.jsx("div",{children:n("common.filters.unsupported_type",{type:t.type})})}return f}Y.__docgenInfo={description:"",methods:[],displayName:"AccordionContainer",props:{field:{required:!0,tsType:{name:"AggregationConfig"},description:""},isOpen:{required:!0,tsType:{name:"boolean"},description:""},searchHandler:{required:!1,tsType:{name:"signature",type:"function",raw:"(_e: React.MouseEvent<SVGElement, MouseEvent>) => void",signature:{arguments:[{type:{name:"ReactMouseEvent",raw:"React.MouseEvent<SVGElement, MouseEvent>",elements:[{name:"SVGElement"},{name:"MouseEvent"}]},name:"_e"}],return:{name:"void"}}},description:""},children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};Ie.__docgenInfo={description:"To be use when the filter needs to be inside an Accordion component",methods:[],displayName:"FilterContainer",props:{field:{required:!0,tsType:{name:"AggregationConfig"},description:""},isOpen:{required:!0,tsType:{name:"boolean"},description:""},searchHandler:{required:!1,tsType:{name:"signature",type:"function",raw:"(_e: React.MouseEvent<SVGElement, MouseEvent>) => void",signature:{arguments:[{type:{name:"ReactMouseEvent",raw:"React.MouseEvent<SVGElement, MouseEvent>",elements:[{name:"SVGElement"},{name:"MouseEvent"}]},name:"_e"}],return:{name:"void"}}},description:""}}};const Ee=a.createContext({appId:ae.variant_entity,aggregations:{}}),le=()=>{const t=a.useContext(Ee);if(!t)throw new Error("useFilterConfig must be used within a FilterConfigProvider");return t};function Te(t){return`temp-filters-${t}`}function ct({groupKey:t,appId:s,aggregations:n}){var x;const{t:u}=V(),[f,d]=a.useState(!1),[r,y]=a.useState([]),[i,b]=a.useState(t),p=Te(s),g=()=>{sessionStorage.removeItem(p)},k=t?((x=n[t])==null?void 0:x.items)||[]:Object.values(n).flatMap(j=>j.items);return a.useEffect(()=>{d(!1),y([])},[t]),a.useEffect(()=>{(i&&i!==null&&t===null||i&&i!==null&&t&&t!==null&&i!==t)&&g(),b(t)},[t,i]),e.jsx(Ee,{value:{appId:s,aggregations:n},children:e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(O,{variant:"link",size:"xs",onClick:()=>{const j=!f;d(j),y(j?k.map(m=>m.key):[])},children:u(f?"common.actions.collapse_all":"common.actions.expand_all")})}),e.jsx(Be,{className:"flex flex-col gap-1",type:"multiple",value:r,onValueChange:j=>y(j),children:k.map((j,m)=>e.jsx(Ie,{isOpen:r.includes(j.key),field:j},`${j.key}-${m}`))})]})})}ct.__docgenInfo={description:"",methods:[],displayName:"FilterList",props:{groupKey:{required:!1,tsType:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},description:""},aggregations:{required:!0,tsType:{name:"signature",type:"object",raw:`{
  [key: string]: AggregationGroup;
}`,signature:{properties:[{key:{name:"string"},value:{name:"AggregationGroup",required:!0}}]}},description:""},appId:{required:!0,tsType:{name:"ApplicationId"},description:""}}};export{ge as A,ct as F,Ee as a,at as u};
